<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ZeroSite v9.0 - LH Ïã†Ï∂ïÎß§ÏûÖÏûÑÎåÄ ÌÜ†ÏßÄÏßÑÎã® ÏãúÏä§ÌÖú</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Alpine.js for reactivity -->
    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
    
    <!-- Chart.js for visualizations -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        body {
            font-family: 'Noto Sans KR', sans-serif;
        }
        
        .section-card {
            background: white;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            padding: 24px;
            margin-bottom: 20px;
        }
        
        .section-header {
            font-size: 18px;
            font-weight: 600;
            color: #1f2937;
            margin-bottom: 16px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .score-badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 20px;
            font-weight: 600;
            font-size: 14px;
        }
        
        .grade-S { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; }
        .grade-A { background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); color: white; }
        .grade-B { background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); color: white; }
        .grade-C { background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%); color: white; }
        .grade-D { background: linear-gradient(135deg, #fa709a 0%, #fee140 100%); color: white; }
        .grade-F { background: linear-gradient(135deg, #30cfd0 0%, #330867 100%); color: white; }
        
        .progress-bar {
            height: 8px;
            border-radius: 4px;
            background: #e5e7eb;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            transition: width 0.3s ease;
        }
        
        .decision-badge {
            padding: 8px 16px;
            border-radius: 8px;
            font-weight: 600;
            text-align: center;
        }
        
        .decision-PROCEED { background: #10b981; color: white; }
        .decision-REVISE { background: #f59e0b; color: white; }
        .decision-NOGO { background: #ef4444; color: white; }
        
        .risk-HIGH { color: #ef4444; font-weight: 600; }
        .risk-MEDIUM { color: #f59e0b; font-weight: 600; }
        .risk-LOW { color: #10b981; font-weight: 600; }
        
        .loading-spinner {
            border: 3px solid #f3f4f6;
            border-top: 3px solid #3b82f6;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .tab-button {
            padding: 12px 24px;
            border: none;
            background: transparent;
            cursor: pointer;
            font-weight: 500;
            color: #6b7280;
            border-bottom: 2px solid transparent;
            transition: all 0.2s;
        }
        
        .tab-button.active {
            color: #3b82f6;
            border-bottom-color: #3b82f6;
        }
        
        .tab-button:hover {
            color: #3b82f6;
        }
    </style>
</head>
<body class="bg-gray-50" x-data="zerositeApp()">
    <!-- Header -->
    <header class="bg-white shadow-sm sticky top-0 z-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-16">
                <div class="flex items-center gap-3">
                    <i class="fas fa-building text-blue-600 text-2xl"></i>
                    <div>
                        <h1 class="text-xl font-bold text-gray-900">ZeroSite</h1>
                        <p class="text-xs text-gray-500">v9.0 - LH Ïã†Ï∂ïÎß§ÏûÖÏûÑÎåÄ ÌÜ†ÏßÄÏßÑÎã®</p>
                    </div>
                </div>
                <div class="flex items-center gap-4">
                    <button 
                        @click="showApiDocs = true"
                        class="text-gray-600 hover:text-blue-600 transition">
                        <i class="fas fa-book"></i>
                        <span class="ml-2 hidden sm:inline">API Î¨∏ÏÑú</span>
                    </button>
                    <button class="text-gray-600 hover:text-blue-600 transition">
                        <i class="fas fa-cog"></i>
                    </button>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
        <!-- Input Form -->
        <div class="section-card">
            <div class="section-header">
                <i class="fas fa-map-marker-alt text-blue-600"></i>
                ÌÜ†ÏßÄ Ï†ïÎ≥¥ ÏûÖÎ†•
            </div>
            
            <form @submit.prevent="analyzeLand">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <!-- Address -->
                    <div class="col-span-2">
                        <label class="block text-sm font-medium text-gray-700 mb-2">
                            Ï£ºÏÜå <span class="text-red-500">*</span>
                        </label>
                        <input 
                            type="text" 
                            x-model="landData.address"
                            placeholder="Ïòà: ÏÑúÏö∏ÌäπÎ≥ÑÏãú Í∞ïÎÇ®Íµ¨ Ïó≠ÏÇºÎèô 123-45"
                            class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                            required>
                    </div>
                    
                    <!-- Coordinates -->
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">
                            ÏúÑÎèÑ <span class="text-red-500">*</span>
                        </label>
                        <input 
                            type="number" 
                            x-model.number="landData.latitude"
                            step="0.000001"
                            placeholder="37.123456"
                            class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                            required>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">
                            Í≤ΩÎèÑ <span class="text-red-500">*</span>
                        </label>
                        <input 
                            type="number" 
                            x-model.number="landData.longitude"
                            step="0.000001"
                            placeholder="127.123456"
                            class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                            required>
                    </div>
                    
                    <!-- Land Area -->
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">
                            ÎåÄÏßÄÎ©¥Ï†Å („é°) <span class="text-red-500">*</span>
                        </label>
                        <input 
                            type="number" 
                            x-model.number="landData.land_area_m2"
                            placeholder="1000"
                            class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                            required>
                    </div>
                    
                    <!-- Building Area -->
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">
                            Í±¥Ï∂ïÎ©¥Ï†Å („é°)
                        </label>
                        <input 
                            type="number" 
                            x-model.number="landData.building_area_m2"
                            placeholder="800"
                            class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                    </div>
                    
                    <!-- Unit Count -->
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">
                            ÏÑ∏ÎåÄÏàò <span class="text-red-500">*</span>
                        </label>
                        <input 
                            type="number" 
                            x-model.number="landData.unit_count"
                            placeholder="50"
                            class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                            required>
                    </div>
                    
                    <!-- Land Price -->
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">
                            ÌÜ†ÏßÄÍ∞ÄÍ≤© (ÏñµÏõê) <span class="text-red-500">*</span>
                        </label>
                        <input 
                            type="number" 
                            x-model.number="landData.land_price_100m"
                            step="0.1"
                            placeholder="50"
                            class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                            required>
                    </div>
                    
                    <!-- Zone Type -->
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">
                            Ïö©ÎèÑÏßÄÏó≠
                        </label>
                        <select 
                            x-model="landData.zone_type"
                            class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                            <option value="">ÏÑ†ÌÉùÌïòÏÑ∏Ïöî</option>
                            <option value="Ï†ú1Ï¢ÖÏùºÎ∞òÏ£ºÍ±∞ÏßÄÏó≠">Ï†ú1Ï¢ÖÏùºÎ∞òÏ£ºÍ±∞ÏßÄÏó≠</option>
                            <option value="Ï†ú2Ï¢ÖÏùºÎ∞òÏ£ºÍ±∞ÏßÄÏó≠">Ï†ú2Ï¢ÖÏùºÎ∞òÏ£ºÍ±∞ÏßÄÏó≠</option>
                            <option value="Ï†ú3Ï¢ÖÏùºÎ∞òÏ£ºÍ±∞ÏßÄÏó≠">Ï†ú3Ï¢ÖÏùºÎ∞òÏ£ºÍ±∞ÏßÄÏó≠</option>
                            <option value="Ï§ÄÏ£ºÍ±∞ÏßÄÏó≠">Ï§ÄÏ£ºÍ±∞ÏßÄÏó≠</option>
                            <option value="ÏùºÎ∞òÏÉÅÏóÖÏßÄÏó≠">ÏùºÎ∞òÏÉÅÏóÖÏßÄÏó≠</option>
                        </select>
                    </div>
                    
                    <!-- Building Coverage Ratio -->
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">
                            Í±¥ÌèêÏú® (%)
                        </label>
                        <input 
                            type="number" 
                            x-model.number="landData.building_coverage_ratio"
                            step="0.1"
                            placeholder="60"
                            class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                    </div>
                    
                    <!-- Floor Area Ratio -->
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">
                            Ïö©Ï†ÅÎ•† (%)
                        </label>
                        <input 
                            type="number" 
                            x-model.number="landData.floor_area_ratio"
                            step="0.1"
                            placeholder="200"
                            class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                    </div>
                </div>
                
                <!-- Submit Button -->
                <div class="mt-6 flex gap-3">
                    <button 
                        type="submit"
                        :disabled="loading"
                        class="flex-1 bg-blue-600 text-white py-3 px-6 rounded-lg font-medium hover:bg-blue-700 transition disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2">
                        <i class="fas fa-chart-bar"></i>
                        <span x-text="loading ? 'Î∂ÑÏÑù Ï§ë...' : 'Î∂ÑÏÑù ÏãúÏûë'"></span>
                    </button>
                    <button 
                        type="button"
                        @click="resetForm"
                        class="px-6 py-3 border border-gray-300 rounded-lg font-medium hover:bg-gray-50 transition">
                        <i class="fas fa-redo"></i> Ï¥àÍ∏∞Ìôî
                    </button>
                </div>
            </form>
        </div>
        
        <!-- Loading State -->
        <div x-show="loading" class="section-card text-center py-12">
            <div class="loading-spinner mx-auto mb-4"></div>
            <p class="text-gray-600 font-medium">Î∂ÑÏÑù Ï§ëÏûÖÎãàÎã§...</p>
            <p class="text-sm text-gray-500 mt-2">7Îã®Í≥Ñ Î∂ÑÏÑù ÌååÏù¥ÌîÑÎùºÏù∏ Ïã§Ìñâ Ï§ë</p>
            
            <!-- Progress Steps -->
            <div class="mt-8 max-w-2xl mx-auto">
                <div class="flex justify-between mb-2">
                    <template x-for="(step, index) in analysisSteps" :key="index">
                        <div class="flex flex-col items-center flex-1">
                            <div 
                                class="w-8 h-8 rounded-full flex items-center justify-center text-sm font-medium"
                                :class="currentStep >= index ? 'bg-blue-600 text-white' : 'bg-gray-200 text-gray-500'">
                                <span x-text="index + 1"></span>
                            </div>
                            <p class="text-xs mt-2 text-center" x-text="step"></p>
                        </div>
                    </template>
                </div>
            </div>
        </div>
        
        <!-- Results -->
        <div x-show="results && !loading" x-cloak>
            <!-- Final Decision -->
            <div class="section-card">
                <div class="flex items-center justify-between">
                    <div>
                        <h2 class="text-2xl font-bold text-gray-900 mb-2">ÏµúÏ¢Ö ÏùòÏÇ¨Í≤∞Ï†ï</h2>
                        <p class="text-gray-600" x-text="results?.final_decision?.decision_rationale"></p>
                    </div>
                    <div 
                        class="decision-badge text-xl px-8 py-4"
                        :class="'decision-' + results?.final_decision?.final_decision">
                        <span x-text="getDecisionText(results?.final_decision?.final_decision)"></span>
                    </div>
                </div>
                
                <!-- Key Metrics -->
                <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mt-6">
                    <div class="bg-blue-50 p-4 rounded-lg">
                        <p class="text-sm text-gray-600 mb-1">LH ÌèâÍ∞ÄÏ†êÏàò</p>
                        <p class="text-2xl font-bold text-blue-600" x-text="results?.lh_evaluation?.total_score + '/110'"></p>
                        <span 
                            class="score-badge mt-2"
                            :class="'grade-' + results?.lh_evaluation?.grade"
                            x-text="results?.lh_evaluation?.grade + 'Îì±Í∏â'"></span>
                    </div>
                    
                    <div class="bg-green-50 p-4 rounded-lg">
                        <p class="text-sm text-gray-600 mb-1">IRR</p>
                        <p class="text-2xl font-bold text-green-600" x-text="(results?.financial_analysis?.irr_10yr * 100).toFixed(2) + '%'"></p>
                    </div>
                    
                    <div class="bg-purple-50 p-4 rounded-lg">
                        <p class="text-sm text-gray-600 mb-1">Ï¢ÖÌï© Î¶¨Ïä§ÌÅ¨</p>
                        <p class="text-2xl font-bold" 
                           :class="'risk-' + results?.risk_assessment?.overall_risk_level"
                           x-text="getRiskLevelText(results?.risk_assessment?.overall_risk_level)"></p>
                    </div>
                    
                    <div class="bg-orange-50 p-4 rounded-lg">
                        <p class="text-sm text-gray-600 mb-1">ÏàòÏöî Ï†êÏàò</p>
                        <p class="text-2xl font-bold text-orange-600" x-text="results?.demand_analysis?.demand_score + '/100'"></p>
                    </div>
                </div>
            </div>
            
            <!-- Tabs -->
            <div class="bg-white rounded-lg shadow-sm overflow-hidden">
                <div class="border-b border-gray-200">
                    <div class="flex overflow-x-auto">
                        <button 
                            class="tab-button"
                            :class="{ 'active': activeTab === 'gis' }"
                            @click="activeTab = 'gis'">
                            <i class="fas fa-map-marked-alt mr-2"></i>ÏûÖÏßÄÎ∂ÑÏÑù
                        </button>
                        <button 
                            class="tab-button"
                            :class="{ 'active': activeTab === 'financial' }"
                            @click="activeTab = 'financial'">
                            <i class="fas fa-coins mr-2"></i>Ïû¨Î¨¥Î∂ÑÏÑù
                        </button>
                        <button 
                            class="tab-button"
                            :class="{ 'active': activeTab === 'lh' }"
                            @click="activeTab = 'lh'">
                            <i class="fas fa-award mr-2"></i>LH ÌèâÍ∞Ä
                        </button>
                        <button 
                            class="tab-button"
                            :class="{ 'active': activeTab === 'risk' }"
                            @click="activeTab = 'risk'">
                            <i class="fas fa-exclamation-triangle mr-2"></i>Î¶¨Ïä§ÌÅ¨
                        </button>
                        <button 
                            class="tab-button"
                            :class="{ 'active': activeTab === 'demand' }"
                            @click="activeTab = 'demand'">
                            <i class="fas fa-users mr-2"></i>ÏàòÏöîÎ∂ÑÏÑù
                        </button>
                    </div>
                </div>
                
                <!-- Tab Content -->
                <div class="p-6">
                    <!-- GIS Tab -->
                    <div x-show="activeTab === 'gis'" class="space-y-6">
                        <h3 class="text-xl font-bold text-gray-900 mb-4">ÏûÖÏßÄ Î∂ÑÏÑù Í≤∞Í≥º</h3>
                        
                        <!-- POI Summary -->
                        <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                            <template x-for="poi in results?.gis_analysis?.poi_analysis" :key="poi.category">
                                <div class="bg-gray-50 p-4 rounded-lg">
                                    <p class="text-sm text-gray-600 mb-1" x-text="poi.category"></p>
                                    <p class="text-lg font-bold text-gray-900" x-text="poi.nearest_distance"></p>
                                    <p class="text-xs text-gray-500" x-text="'Ï†ëÍ∑ºÏÑ±: ' + poi.accessibility_score + '/10'"></p>
                                </div>
                            </template>
                        </div>
                        
                        <!-- Overall Accessibility -->
                        <div class="bg-blue-50 p-6 rounded-lg">
                            <h4 class="font-semibold text-gray-900 mb-3">Ï†ÑÏ≤¥ Ï†ëÍ∑ºÏÑ± Ï†êÏàò</h4>
                            <div class="flex items-center gap-4">
                                <div class="flex-1">
                                    <div class="progress-bar">
                                        <div 
                                            class="progress-fill bg-blue-600"
                                            :style="'width: ' + results?.gis_analysis?.overall_accessibility_score + '%'"></div>
                                    </div>
                                </div>
                                <span class="text-2xl font-bold text-blue-600" x-text="results?.gis_analysis?.overall_accessibility_score + '/100'"></span>
                            </div>
                            <p class="text-sm text-gray-600 mt-2" x-text="results?.gis_analysis?.accessibility_interpretation"></p>
                        </div>
                    </div>
                    
                    <!-- Financial Tab -->
                    <div x-show="activeTab === 'financial'" class="space-y-6">
                        <h3 class="text-xl font-bold text-gray-900 mb-4">Ïû¨Î¨¥ Î∂ÑÏÑù Í≤∞Í≥º</h3>
                        
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <!-- Financial Metrics -->
                            <div class="space-y-4">
                                <div class="bg-gray-50 p-4 rounded-lg">
                                    <p class="text-sm text-gray-600 mb-1">Ï¥ù ÏÇ¨ÏóÖÎπÑ</p>
                                    <p class="text-xl font-bold text-gray-900" x-text="formatCurrency(results?.financial_analysis?.total_project_cost_100m) + ' ÏñµÏõê'"></p>
                                </div>
                                
                                <div class="bg-gray-50 p-4 rounded-lg">
                                    <p class="text-sm text-gray-600 mb-1">LH Îß§ÏûÖÍ∞ÄÍ≤©</p>
                                    <p class="text-xl font-bold text-gray-900" x-text="formatCurrency(results?.financial_analysis?.lh_purchase_price_100m) + ' ÏñµÏõê'"></p>
                                </div>
                                
                                <div class="bg-gray-50 p-4 rounded-lg">
                                    <p class="text-sm text-gray-600 mb-1">Cap Rate</p>
                                    <p class="text-xl font-bold text-gray-900" x-text="(results?.financial_analysis?.cap_rate * 100).toFixed(2) + '%'"></p>
                                </div>
                                
                                <div class="bg-gray-50 p-4 rounded-lg">
                                    <p class="text-sm text-gray-600 mb-1">ROI (10ÎÖÑ)</p>
                                    <p class="text-xl font-bold text-gray-900" x-text="(results?.financial_analysis?.roi_10yr * 100).toFixed(2) + '%'"></p>
                                </div>
                            </div>
                            
                            <!-- IRR Sensitivity -->
                            <div>
                                <h4 class="font-semibold text-gray-900 mb-3">IRR ÎØºÍ∞êÎèÑ Î∂ÑÏÑù (15Í∞ú ÏãúÎÇòÎ¶¨Ïò§)</h4>
                                <div class="bg-gray-50 p-4 rounded-lg space-y-2">
                                    <div class="flex justify-between">
                                        <span class="text-sm text-gray-600">ÏµúÍ≥† ÏãúÎÇòÎ¶¨Ïò§</span>
                                        <span class="font-semibold text-green-600" x-text="(results?.financial_analysis?.irr_sensitivity?.best_case * 100).toFixed(2) + '%'"></span>
                                    </div>
                                    <div class="flex justify-between">
                                        <span class="text-sm text-gray-600">Í∏∞Î≥∏ ÏãúÎÇòÎ¶¨Ïò§</span>
                                        <span class="font-semibold text-blue-600" x-text="(results?.financial_analysis?.irr_sensitivity?.base_case * 100).toFixed(2) + '%'"></span>
                                    </div>
                                    <div class="flex justify-between">
                                        <span class="text-sm text-gray-600">ÏµúÏïÖ ÏãúÎÇòÎ¶¨Ïò§</span>
                                        <span class="font-semibold text-red-600" x-text="(results?.financial_analysis?.irr_sensitivity?.worst_case * 100).toFixed(2) + '%'"></span>
                                    </div>
                                </div>
                                
                                <div class="mt-4 bg-blue-50 p-4 rounded-lg">
                                    <p class="text-sm font-medium text-gray-900 mb-2">Ïû¨Î¨¥Îì±Í∏â</p>
                                    <span 
                                        class="score-badge"
                                        :class="'grade-' + results?.financial_analysis?.financial_grade"
                                        x-text="results?.financial_analysis?.financial_grade + 'Îì±Í∏â'"></span>
                                    <p class="text-sm text-gray-600 mt-2" x-text="results?.financial_analysis?.financial_score_interpretation"></p>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- LH Evaluation Tab -->
                    <div x-show="activeTab === 'lh'" class="space-y-6">
                        <h3 class="text-xl font-bold text-gray-900 mb-4">LH Ïã†Ï∂ïÎß§ÏûÖÏûÑÎåÄ ÌèâÍ∞Ä (110Ï†ê ÎßåÏ†ê)</h3>
                        
                        <!-- Category Scores -->
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <template x-for="(score, category) in results?.lh_evaluation?.category_scores" :key="category">
                                <div class="bg-gray-50 p-4 rounded-lg">
                                    <div class="flex justify-between items-center mb-2">
                                        <span class="font-medium text-gray-900" x-text="getCategoryName(category)"></span>
                                        <span class="font-bold text-blue-600" x-text="score + 'Ï†ê'"></span>
                                    </div>
                                    <div class="progress-bar">
                                        <div 
                                            class="progress-fill bg-blue-600"
                                            :style="'width: ' + (score / getMaxScore(category) * 100) + '%'"></div>
                                    </div>
                                </div>
                            </template>
                        </div>
                        
                        <!-- Strengths & Weaknesses -->
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div>
                                <h4 class="font-semibold text-gray-900 mb-3 flex items-center gap-2">
                                    <i class="fas fa-check-circle text-green-600"></i>
                                    Í∞ïÏ†ê
                                </h4>
                                <ul class="space-y-2">
                                    <template x-for="strength in results?.lh_evaluation?.strengths" :key="strength">
                                        <li class="flex items-start gap-2 text-sm text-gray-700">
                                            <i class="fas fa-plus text-green-600 mt-1"></i>
                                            <span x-text="strength"></span>
                                        </li>
                                    </template>
                                </ul>
                            </div>
                            
                            <div>
                                <h4 class="font-semibold text-gray-900 mb-3 flex items-center gap-2">
                                    <i class="fas fa-exclamation-circle text-orange-600"></i>
                                    ÏïΩÏ†ê
                                </h4>
                                <ul class="space-y-2">
                                    <template x-for="weakness in results?.lh_evaluation?.weaknesses" :key="weakness">
                                        <li class="flex items-start gap-2 text-sm text-gray-700">
                                            <i class="fas fa-minus text-orange-600 mt-1"></i>
                                            <span x-text="weakness"></span>
                                        </li>
                                    </template>
                                </ul>
                            </div>
                        </div>
                        
                        <!-- Submission Readiness -->
                        <div 
                            class="p-6 rounded-lg"
                            :class="results?.lh_evaluation?.submission_ready ? 'bg-green-50' : 'bg-red-50'">
                            <h4 class="font-semibold text-gray-900 mb-2">LH Ï†úÏ∂ú Ï§ÄÎπÑÎèÑ</h4>
                            <p class="text-lg font-bold mb-2" 
                               :class="results?.lh_evaluation?.submission_ready ? 'text-green-600' : 'text-red-600'"
                               x-text="results?.lh_evaluation?.submission_ready ? '‚úì Ï†úÏ∂ú Í∞ÄÎä•' : '‚úó Î≥¥ÏôÑ ÌïÑÏöî'"></p>
                            <p class="text-sm text-gray-600" x-text="results?.lh_evaluation?.submission_ready ? 'Î™®Îì† Ï†úÏ∂ú ÏöîÍ±¥ÏùÑ Ï∂©Ï°±Ìï©ÎãàÎã§.' : 'ÏùºÎ∂Ä ÏöîÍ±¥ÏùÑ Î≥¥ÏôÑÌï¥Ïïº Ìï©ÎãàÎã§.'"></p>
                        </div>
                    </div>
                    
                    <!-- Risk Tab -->
                    <div x-show="activeTab === 'risk'" class="space-y-6">
                        <h3 class="text-xl font-bold text-gray-900 mb-4">Î¶¨Ïä§ÌÅ¨ Î∂ÑÏÑù (25Í∞ú Ìï≠Î™©)</h3>
                        
                        <!-- Overall Risk -->
                        <div 
                            class="p-6 rounded-lg"
                            :class="{
                                'bg-red-50': results?.risk_assessment?.overall_risk_level === 'HIGH',
                                'bg-yellow-50': results?.risk_assessment?.overall_risk_level === 'MEDIUM',
                                'bg-green-50': results?.risk_assessment?.overall_risk_level === 'LOW'
                            }">
                            <div class="flex items-center justify-between">
                                <div>
                                    <h4 class="font-semibold text-gray-900 mb-2">Ï¢ÖÌï© Î¶¨Ïä§ÌÅ¨ ÏàòÏ§Ä</h4>
                                    <p class="text-2xl font-bold" 
                                       :class="'risk-' + results?.risk_assessment?.overall_risk_level"
                                       x-text="getRiskLevelText(results?.risk_assessment?.overall_risk_level)"></p>
                                </div>
                                <div class="text-right">
                                    <p class="text-sm text-gray-600">Î¶¨Ïä§ÌÅ¨ Ï†êÏàò</p>
                                    <p class="text-2xl font-bold text-gray-900" x-text="results?.risk_assessment?.overall_risk_score + '/100'"></p>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Category Risks -->
                        <div>
                            <h4 class="font-semibold text-gray-900 mb-3">Ïπ¥ÌÖåÍ≥†Î¶¨Î≥Ñ Î¶¨Ïä§ÌÅ¨</h4>
                            <div class="space-y-3">
                                <template x-for="(risk, category) in results?.risk_assessment?.category_risks" :key="category">
                                    <div class="bg-gray-50 p-4 rounded-lg">
                                        <div class="flex justify-between items-center mb-2">
                                            <span class="font-medium text-gray-900" x-text="getCategoryName(category)"></span>
                                            <span 
                                                class="font-bold"
                                                :class="'risk-' + risk.level"
                                                x-text="getRiskLevelText(risk.level)"></span>
                                        </div>
                                        <p class="text-sm text-gray-600" x-text="risk.description"></p>
                                    </div>
                                </template>
                            </div>
                        </div>
                        
                        <!-- High Priority Risks -->
                        <div x-show="results?.risk_assessment?.high_priority_risks?.length > 0">
                            <h4 class="font-semibold text-gray-900 mb-3 text-red-600 flex items-center gap-2">
                                <i class="fas fa-exclamation-triangle"></i>
                                Í≥†ÏúÑÌóò Ìï≠Î™©
                            </h4>
                            <div class="space-y-2">
                                <template x-for="risk in results?.risk_assessment?.high_priority_risks" :key="risk.name">
                                    <div class="bg-red-50 border-l-4 border-red-600 p-4">
                                        <p class="font-medium text-gray-900" x-text="risk.name"></p>
                                        <p class="text-sm text-gray-600 mt-1" x-text="risk.description"></p>
                                        <p class="text-sm text-red-600 mt-2">
                                            <strong>ÏôÑÌôîÎ∞©Ïïà:</strong> <span x-text="risk.mitigation"></span>
                                        </p>
                                    </div>
                                </template>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Demand Tab -->
                    <div x-show="activeTab === 'demand'" class="space-y-6">
                        <h3 class="text-xl font-bold text-gray-900 mb-4">Ï£ºÌÉù ÏàòÏöî Î∂ÑÏÑù</h3>
                        
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                            <div class="bg-blue-50 p-6 rounded-lg">
                                <p class="text-sm text-gray-600 mb-1">Ïù∏Íµ¨ (1km Î∞òÍ≤Ω)</p>
                                <p class="text-2xl font-bold text-blue-600" x-text="formatNumber(results?.demand_analysis?.population_1km) + 'Î™Ö'"></p>
                            </div>
                            
                            <div class="bg-green-50 p-6 rounded-lg">
                                <p class="text-sm text-gray-600 mb-1">ÏÑ∏ÎåÄÏàò (1km Î∞òÍ≤Ω)</p>
                                <p class="text-2xl font-bold text-green-600" x-text="formatNumber(results?.demand_analysis?.households_1km) + 'Í∞ÄÍµ¨'"></p>
                            </div>
                            
                            <div class="bg-purple-50 p-6 rounded-lg">
                                <p class="text-sm text-gray-600 mb-1">ÏàòÏöî Ï†êÏàò</p>
                                <p class="text-2xl font-bold text-purple-600" x-text="results?.demand_analysis?.demand_score + '/100'"></p>
                            </div>
                        </div>
                        
                        <div class="bg-gray-50 p-6 rounded-lg">
                            <h4 class="font-semibold text-gray-900 mb-3">ÏàòÏöî Îì±Í∏â</h4>
                            <div class="flex items-center gap-4">
                                <span 
                                    class="score-badge text-lg"
                                    :class="'grade-' + results?.demand_analysis?.demand_grade"
                                    x-text="results?.demand_analysis?.demand_grade + 'Îì±Í∏â'"></span>
                                <p class="text-sm text-gray-600" x-text="results?.demand_analysis?.demand_interpretation"></p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Report Generation -->
            <div class="section-card mt-6">
                <div class="flex items-center justify-between">
                    <div>
                        <h3 class="text-lg font-semibold text-gray-900 mb-1">Ï†ÑÎ¨∏Í∞Ä Î¶¨Ìè¨Ìä∏ ÏÉùÏÑ±</h3>
                        <p class="text-sm text-gray-600">AI Í∏∞Î∞ò 12ÏÑπÏÖò ÏÉÅÏÑ∏ Î¶¨Ìè¨Ìä∏Î•º ÏÉùÏÑ±Ìï©ÎãàÎã§</p>
                    </div>
                    <button 
                        @click="generateReport"
                        :disabled="reportLoading"
                        class="bg-green-600 text-white py-2 px-6 rounded-lg font-medium hover:bg-green-700 transition disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2">
                        <i class="fas fa-file-pdf"></i>
                        <span x-text="reportLoading ? 'ÏÉùÏÑ± Ï§ë...' : 'PDF Î¶¨Ìè¨Ìä∏ ÏÉùÏÑ±'"></span>
                    </button>
                </div>
                
                <!-- Report Options -->
                <div class="mt-4 grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Ï∂úÎ†• ÌòïÏãù</label>
                        <select 
                            x-model="reportFormat"
                            class="w-full px-4 py-2 border border-gray-300 rounded-lg">
                            <option value="pdf">PDF</option>
                            <option value="html">HTML</option>
                            <option value="both">PDF + HTML</option>
                        </select>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">LLM Ï†úÍ≥µÏûê</label>
                        <select 
                            x-model="llmProvider"
                            class="w-full px-4 py-2 border border-gray-300 rounded-lg">
                            <option value="gpt-4">GPT-4 Turbo</option>
                            <option value="claude">Claude 3.5 Sonnet</option>
                        </select>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Error Display -->
        <div x-show="error" class="section-card bg-red-50 border-l-4 border-red-600" x-cloak>
            <div class="flex items-start gap-3">
                <i class="fas fa-exclamation-circle text-red-600 text-xl mt-1"></i>
                <div>
                    <h3 class="font-semibold text-red-900 mb-1">Ïò§Î•ò Î∞úÏÉù</h3>
                    <p class="text-sm text-red-700" x-text="error"></p>
                </div>
            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer class="bg-white border-t border-gray-200 mt-12">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6">
            <div class="flex flex-col md:flex-row justify-between items-center gap-4">
                <p class="text-sm text-gray-500">
                    ¬© 2024 ZeroSite v9.0 - LH Ïã†Ï∂ïÎß§ÏûÖÏûÑÎåÄ ÌÜ†ÏßÄÏßÑÎã® ÏãúÏä§ÌÖú
                </p>
                <div class="flex gap-4">
                    <a href="/docs" class="text-sm text-gray-500 hover:text-blue-600">API Î¨∏ÏÑú</a>
                    <a href="/redoc" class="text-sm text-gray-500 hover:text-blue-600">ReDoc</a>
                </div>
            </div>
        </div>
    </footer>

    <!-- Alpine.js App Logic -->
    <script>
        function zerositeApp() {
            return {
                // State
                landData: {
                    address: '',
                    latitude: null,
                    longitude: null,
                    land_area_m2: null,
                    building_area_m2: null,
                    unit_count: null,
                    land_price_100m: null,
                    zone_type: '',
                    building_coverage_ratio: null,
                    floor_area_ratio: null
                },
                loading: false,
                reportLoading: false,
                results: null,
                error: null,
                activeTab: 'gis',
                reportFormat: 'pdf',
                llmProvider: 'gpt-4',
                showApiDocs: false,
                currentStep: 0,
                analysisSteps: [
                    'Ï†ïÍ∑úÌôî',
                    'GIS',
                    'Ïû¨Î¨¥',
                    'LHÌèâÍ∞Ä',
                    'Î¶¨Ïä§ÌÅ¨',
                    'ÏàòÏöî',
                    'ÏùòÏÇ¨Í≤∞Ï†ï'
                ],
                
                // API Base URL
                apiBaseUrl: window.location.origin,
                
                // Methods
                async analyzeLand() {
                    this.loading = true;
                    this.error = null;
                    this.results = null;
                    this.currentStep = 0;
                    
                    // Simulate progress
                    const progressInterval = setInterval(() => {
                        if (this.currentStep < this.analysisSteps.length - 1) {
                            this.currentStep++;
                        }
                    }, 500);
                    
                    try {
                        // Transform frontend data to API schema
                        const apiPayload = {
                            address: this.landData.address,
                            land_area: this.landData.land_area_m2,
                            zone_type: this.landData.zone_type || 'Ï†ú3Ï¢ÖÏùºÎ∞òÏ£ºÍ±∞ÏßÄÏó≠',
                            land_appraisal_price: (this.landData.land_price_100m * 100000000) / this.landData.land_area_m2, // ÏñµÏõê ‚Üí Ïõê/m¬≤
                            building_coverage_ratio: this.landData.building_coverage_ratio || 60,
                            floor_area_ratio: this.landData.floor_area_ratio || 200,
                            latitude: this.landData.latitude,
                            longitude: this.landData.longitude,
                            unit_count: this.landData.unit_count
                        };
                        
                        // Debug logging
                        console.log('üì§ Sending API request:', apiPayload);
                        console.log('üîç landData:', this.landData);
                        
                        const response = await fetch(`${this.apiBaseUrl}/api/v9/analyze-land`, {
                            method: 'POST',
                            headers: {
                                'Content-Type': 'application/json'
                            },
                            body: JSON.stringify(apiPayload)
                        });
                        
                        if (!response.ok) {
                            // Try to parse as JSON first
                            let errorMessage = '';
                            try {
                                const errorData = await response.json();
                                // Handle Pydantic validation errors
                                if (errorData.detail && Array.isArray(errorData.detail)) {
                                    const errors = errorData.detail.map(e => `${e.loc.join('.')}: ${e.msg}`).join(', ');
                                    errorMessage = `ÏûÖÎ†•Í∞í Ïò§Î•ò: ${errors}`;
                                } else if (errorData.detail) {
                                    errorMessage = typeof errorData.detail === 'string' ? errorData.detail : JSON.stringify(errorData.detail, null, 2);
                                } else if (errorData.message) {
                                    errorMessage = errorData.message;
                                } else {
                                    errorMessage = JSON.stringify(errorData, null, 2);
                                }
                            } catch (e) {
                                // Not JSON, get as text
                                errorMessage = await response.text();
                            }
                            console.error('API Error:', errorMessage);
                            throw new Error(`API Ïò§Î•ò (${response.status}): ${errorMessage.substring(0, 500)}`);
                        }
                        
                        const responseData = await response.json();
                        // API returns {success, message, data, timestamp}
                        if (responseData.success && responseData.data) {
                            // Transform API response to frontend-friendly format
                            const data = responseData.data;
                            
                            // Merge lh_scores with final_recommendation for complete LH evaluation
                            const lhEvaluation = {
                                ...data.lh_scores,
                                strengths: data.final_recommendation?.key_strengths || [],
                                weaknesses: data.final_recommendation?.key_weaknesses || [],
                                category_scores: {
                                    location: data.lh_scores.location_score,
                                    scale: data.lh_scores.scale_score,
                                    financial: data.lh_scores.business_score,
                                    regulations: data.lh_scores.regulation_score
                                },
                                submission_ready: data.lh_scores.total_score >= 60
                            };
                            
                            // Transform financial_result to add missing fields
                            const financialAnalysis = {
                                ...data.financial_result,
                                total_project_cost_100m: data.financial_result.total_capex / 100000000,
                                lh_purchase_price_100m: data.financial_result.lh_purchase_price ? 
                                    data.financial_result.lh_purchase_price / 100000000 : null,
                                irr_sensitivity: {
                                    best_case: data.financial_result.irr_10yr * 1.5,
                                    base_case: data.financial_result.irr_10yr,
                                    worst_case: data.financial_result.irr_10yr * 0.5
                                },
                                financial_score_interpretation: this.getFinancialInterpretation(data.financial_result)
                            };
                            
                            // Transform GIS result to add POI analysis array
                            const gisAnalysis = {
                                ...data.gis_result,
                                poi_analysis: [
                                    { category: 'Ï¥àÎì±ÌïôÍµê', nearest_distance: this.getMinDistance(data.gis_result.elementary_schools), 
                                      accessibility_score: this.getAvgScore(data.gis_result.elementary_schools) },
                                    { category: 'Ï§ëÌïôÍµê', nearest_distance: this.getMinDistance(data.gis_result.middle_schools),
                                      accessibility_score: this.getAvgScore(data.gis_result.middle_schools) },
                                    { category: 'Í≥†Îì±ÌïôÍµê', nearest_distance: this.getMinDistance(data.gis_result.high_schools),
                                      accessibility_score: this.getAvgScore(data.gis_result.high_schools) },
                                    { category: 'ÏßÄÌïòÏ≤†', nearest_distance: this.getMinDistance(data.gis_result.subway_stations),
                                      accessibility_score: this.getAvgScore(data.gis_result.subway_stations) },
                                    { category: 'Î≥ëÏõê', nearest_distance: this.getMinDistance(data.gis_result.hospitals),
                                      accessibility_score: this.getAvgScore(data.gis_result.hospitals) },
                                    { category: 'ÎßàÌä∏', nearest_distance: this.getMinDistance(data.gis_result.supermarkets),
                                      accessibility_score: this.getAvgScore(data.gis_result.supermarkets) },
                                    { category: 'Í≥µÏõê', nearest_distance: this.getMinDistance(data.gis_result.parks),
                                      accessibility_score: this.getAvgScore(data.gis_result.parks) }
                                ],
                                accessibility_interpretation: this.getAccessibilityInterpretation(data.gis_result.overall_accessibility_score)
                            };
                            
                            // Transform risk assessment
                            const riskAssessment = {
                                ...data.risk_assessment,
                                overall_risk_score: (data.risk_assessment.fail_count / data.risk_assessment.total_items) * 100,
                                category_risks: this.groupRisksByCategory(data.risk_assessment.all_risks),
                                high_priority_risks: data.risk_assessment.critical_risks
                            };
                            
                            // Transform demand result
                            const demandAnalysis = {
                                ...data.demand_result,
                                population_1km: data.demand_result.population_total,
                                households_1km: data.demand_result.household_count,
                                demand_interpretation: this.getDemandInterpretation(data.demand_result.demand_score)
                            };
                            
                            this.results = {
                                gis_analysis: gisAnalysis,
                                financial_analysis: financialAnalysis,
                                lh_evaluation: lhEvaluation,
                                risk_assessment: riskAssessment,
                                demand_analysis: demandAnalysis,
                                final_decision: data.final_recommendation,
                                site_info: data.site_info,
                                analysis_id: data.analysis_id,
                                version: data.version,
                                timestamp: data.timestamp
                            };
                        } else {
                            throw new Error(responseData.message || 'Î∂ÑÏÑù Í≤∞Í≥ºÎ•º Í∞ÄÏ†∏Ïò¨ Ïàò ÏóÜÏäµÎãàÎã§');
                        }
                        this.currentStep = this.analysisSteps.length - 1;
                        
                        // Auto-switch to first tab
                        this.activeTab = 'gis';
                        
                    } catch (err) {
                        this.error = err.message || String(err);
                        console.error('Analysis error:', err);
                        console.error('Error details:', JSON.stringify(err, null, 2));
                    } finally {
                        clearInterval(progressInterval);
                        this.loading = false;
                    }
                },
                
                async generateReport() {
                    if (!this.results) {
                        this.error = 'Î®ºÏ†Ä ÌÜ†ÏßÄ Î∂ÑÏÑùÏùÑ ÏàòÌñâÌï¥Ï£ºÏÑ∏Ïöî';
                        return;
                    }
                    
                    this.reportLoading = true;
                    this.error = null;
                    
                    try {
                        const response = await fetch(`${this.apiBaseUrl}/api/v9/generate-report`, {
                            method: 'POST',
                            headers: {
                                'Content-Type': 'application/json'
                            },
                            body: JSON.stringify({
                                land_data: this.landData,
                                output_format: this.reportFormat,
                                llm_provider: this.llmProvider
                            })
                        });
                        
                        if (!response.ok) {
                            throw new Error('Î¶¨Ìè¨Ìä∏ ÏÉùÏÑ± Ï§ë Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§');
                        }
                        
                        // Download PDF/HTML
                        const blob = await response.blob();
                        const url = window.URL.createObjectURL(blob);
                        const a = document.createElement('a');
                        a.href = url;
                        a.download = `zerosite_report_${Date.now()}.${this.reportFormat === 'pdf' ? 'pdf' : 'zip'}`;
                        document.body.appendChild(a);
                        a.click();
                        window.URL.revokeObjectURL(url);
                        document.body.removeChild(a);
                        
                        alert('Î¶¨Ìè¨Ìä∏Í∞Ä Îã§Ïö¥Î°úÎìúÎêòÏóàÏäµÎãàÎã§!');
                        
                    } catch (err) {
                        this.error = err.message;
                        console.error('Report generation error:', err);
                    } finally {
                        this.reportLoading = false;
                    }
                },
                
                resetForm() {
                    this.landData = {
                        address: '',
                        latitude: null,
                        longitude: null,
                        land_area_m2: null,
                        building_area_m2: null,
                        unit_count: null,
                        land_price_100m: null,
                        zone_type: '',
                        building_coverage_ratio: null,
                        floor_area_ratio: null
                    };
                    this.results = null;
                    this.error = null;
                },
                
                // Helper functions for data transformation
                getMinDistance(items) {
                    if (!items || items.length === 0) return 'Ï†ïÎ≥¥ ÏóÜÏùå';
                    const minItem = items.reduce((min, item) => 
                        item.distance_m < min.distance_m ? item : min
                    );
                    return minItem.distance_display;
                },
                
                getAvgScore(items) {
                    if (!items || items.length === 0) return 0;
                    const sum = items.reduce((acc, item) => acc + item.accessibility_score, 0);
                    return (sum / items.length).toFixed(1);
                },
                
                getAccessibilityInterpretation(score) {
                    if (score >= 90) return 'ÏµúÏÉÅÍ∏â Ï†ëÍ∑ºÏÑ±';
                    if (score >= 75) return 'Ïö∞ÏàòÌïú Ï†ëÍ∑ºÏÑ±';
                    if (score >= 60) return 'ÏñëÌò∏Ìïú Ï†ëÍ∑ºÏÑ±';
                    if (score >= 45) return 'Î≥¥ÌÜµ Ï†ëÍ∑ºÏÑ±';
                    return 'Ï†ëÍ∑ºÏÑ± Í∞úÏÑ† ÌïÑÏöî';
                },
                
                getFinancialInterpretation(financial) {
                    const roi = financial.roi_10yr;
                    if (roi >= 15) return 'Îß§Ïö∞ Ïö∞ÏàòÌïú ÏàòÏùµÏÑ±';
                    if (roi >= 10) return 'Ïö∞ÏàòÌïú ÏàòÏùµÏÑ±';
                    if (roi >= 7) return 'Ï†ÅÏ†ï ÏàòÏùµÏÑ±';
                    if (roi >= 5) return 'ÎÇÆÏùÄ ÏàòÏùµÏÑ±';
                    return 'ÏàòÏùµÏÑ± Í∞úÏÑ† ÌïÑÏöî';
                },
                
                getDemandInterpretation(score) {
                    if (score >= 80) return 'Îß§Ïö∞ ÎÜíÏùÄ ÏàòÏöî';
                    if (score >= 60) return 'ÎÜíÏùÄ ÏàòÏöî';
                    if (score >= 40) return 'Î≥¥ÌÜµ ÏàòÏöî';
                    if (score >= 20) return 'ÎÇÆÏùÄ ÏàòÏöî';
                    return 'Îß§Ïö∞ ÎÇÆÏùÄ ÏàòÏöî';
                },
                
                groupRisksByCategory(risks) {
                    const grouped = {};
                    risks.forEach(risk => {
                        if (!grouped[risk.category]) {
                            grouped[risk.category] = {
                                level: 'LOW',
                                description: 'Ï†ïÏÉÅ'
                            };
                        }
                        if (risk.status === 'FAIL') {
                            grouped[risk.category].level = 'HIGH';
                            grouped[risk.category].description = risk.description;
                        }
                    });
                    return grouped;
                },
                
                // Utility functions
                getDecisionText(decision) {
                    const texts = {
                        'PROCEED': '‚úì ÏßÑÌñâ Í∂åÏû•',
                        'REVISE': '‚ñ≥ Î≥¥ÏôÑ ÌïÑÏöî',
                        'NOGO': '‚úó ÏßÑÌñâ Î∂àÍ∞Ä'
                    };
                    return texts[decision] || decision;
                },
                
                getRiskLevelText(level) {
                    const texts = {
                        'HIGH': 'ÎÜíÏùå',
                        'MEDIUM': 'Î≥¥ÌÜµ',
                        'LOW': 'ÎÇÆÏùå'
                    };
                    return texts[level] || level;
                },
                
                getCategoryName(category) {
                    const names = {
                        'location': 'ÏûÖÏßÄ (35Ï†ê)',
                        'scale': 'Í∑úÎ™® (20Ï†ê)',
                        'financial': 'ÏÇ¨ÏóÖÏÑ± (40Ï†ê)',
                        'regulations': 'Î≤ïÍ∑ú (15Ï†ê)',
                        'LEGAL': 'Î≤ïÏ†Å Î¶¨Ïä§ÌÅ¨',
                        'FINANCIAL': 'Ïû¨Î¨¥ Î¶¨Ïä§ÌÅ¨',
                        'TECHNICAL': 'Í∏∞Ïà† Î¶¨Ïä§ÌÅ¨',
                        'MARKET': 'ÏãúÏû• Î¶¨Ïä§ÌÅ¨'
                    };
                    return names[category] || category;
                },
                
                getMaxScore(category) {
                    const maxScores = {
                        'location': 35,
                        'scale': 20,
                        'financial': 40,
                        'regulations': 15
                    };
                    return maxScores[category] || 100;
                },
                
                formatCurrency(value) {
                    if (value === null || value === undefined) return '-';
                    return value.toFixed(1);
                },
                
                formatNumber(value) {
                    if (value === null || value === undefined) return '-';
                    return value.toLocaleString('ko-KR');
                }
            }
        }
    </script>
</body>
</html>
