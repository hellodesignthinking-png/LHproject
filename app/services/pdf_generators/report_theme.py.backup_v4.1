"""
ZeroSite Report Theme - Unified Design System
==============================================

Purpose: Provide consistent typography, colors, and layout
for all M2-M6 PDF reports.

Design Philosophy:
- Public Institution √ó Professional Consulting
- Clean, modern, data-driven aesthetics
- Emphasis on key decision points (cards, badges, gauges)

Author: ZeroSite AI Development Team
Date: 2025-12-19
"""

from reportlab.lib import colors
from reportlab.lib.units import mm
from dataclasses import dataclass
from typing import Dict, Any


@dataclass
class ZeroSiteColors:
    """ZeroSite Brand Color Palette - Consulting Grade Design System"""
    # üé® Primary Navy (Ïª®ÏÑ§ÌåÖ Î≥¥Í≥†ÏÑú ÌëúÏ§Ä)
    primary = colors.HexColor('#0A1E3C')  # Primary Navy
    primary_light = colors.HexColor('#2F6BFF')  # Accent Blue
    primary_dark = colors.HexColor('#071526')
    
    # üîµ Accent Blue (ÌïµÏã¨ ÏàòÏπò/Í≤∞Î°†)
    accent = colors.HexColor('#2F6BFF')  # Accent Blue
    accent_light = colors.HexColor('#5B8FFF')
    
    # Status Colors (ÌåêÎã® ÏÉÅÌÉú)
    positive_green = colors.HexColor('#15803D')  # Positive Green (GO)
    risk_red = colors.HexColor('#C2410C')  # Risk Red (Ï°∞Í±¥Î∂Ä)
    warning = colors.HexColor('#F59E0B')  # Warning Orange
    danger = colors.HexColor('#DC2626')  # Danger Red
    success = positive_green  # Alias for backward compatibility
    
    # Neutral Colors (ÏÑ§Î™Ö ÌÖçÏä§Ìä∏)
    text_primary = colors.HexColor('#0A1E3C')  # Primary Navy (Ï†úÎ™©Ïö©)
    text_secondary = colors.HexColor('#6B7280')  # Neutral Gray (ÏÑ§Î™Ö)
    text_light = colors.HexColor('#9CA3AF')  # Light gray
    
    border = colors.HexColor('#E2E8F0')  # Light border
    background = colors.HexColor('#F8FAFC')  # Very light background
    
    # Legacy (for backward compatibility)
    color_primary = primary
    color_secondary_gray = text_secondary
    color_accent = background


@dataclass
class ZeroSiteTypography:
    """ZeroSite Typography System"""
    # Font Family (NanumBarunGothic for Korean support)
    font_regular = 'NanumBarunGothic'
    font_bold = 'NanumBarunGothicBold'
    font_light = 'NanumBarunGothicLight'
    
    # Font Sizes (pt)
    size_h1 = 22  # Main title
    size_h2 = 16  # Section heading
    size_h3 = 14  # Sub-section
    size_body = 10.5  # Body text
    size_caption = 9  # Footer, notes
    size_small = 8.5  # Fine print
    
    # Line Heights (multiplier)
    leading_h1 = 1.3
    leading_h2 = 1.4
    leading_body = 1.6
    leading_caption = 1.5


@dataclass
class ZeroSiteLayout:
    """ZeroSite Page Layout System"""
    # Page Margins (from user requirements)
    margin_top = 25 * mm
    margin_bottom = 25 * mm  # or 20*mm per variation
    margin_left = 22 * mm
    margin_right = 22 * mm
    
    # Spacing
    space_section = 0.4  # inches between sections
    space_paragraph = 0.3  # inches between paragraphs
    space_item = 0.2  # inches between items
    
    # Card/Component Padding
    card_padding = 10  # points
    card_radius = 5  # points (for visual reference)


class ZeroSiteTheme:
    """
    Complete ZeroSite theme for PDF generation
    
    Usage:
        theme = ZeroSiteTheme()
        title_style = theme.get_title_style()
        primary_color = theme.colors.primary
    """
    
    def __init__(self):
        self.colors = ZeroSiteColors()
        self.typography = ZeroSiteTypography()
        self.layout = ZeroSiteLayout()
    
    def get_title_style(self, styles_base):
        """Get H1 title style"""
        from reportlab.lib.styles import ParagraphStyle
        from reportlab.lib.enums import TA_CENTER
        
        return ParagraphStyle(
            'ZeroSiteTitle',
            parent=styles_base['Heading1'],
            fontName=self.typography.font_bold,
            fontSize=self.typography.size_h1,
            leading=self.typography.size_h1 * self.typography.leading_h1,
            textColor=self.colors.primary,
            alignment=TA_CENTER,
            spaceAfter=20,
        )
    
    def get_heading_style(self, styles_base):
        """Get H2 section heading style"""
        from reportlab.lib.styles import ParagraphStyle
        from reportlab.lib.enums import TA_LEFT
        
        return ParagraphStyle(
            'ZeroSiteHeading',
            parent=styles_base['Heading2'],
            fontName=self.typography.font_bold,
            fontSize=self.typography.size_h2,
            leading=self.typography.size_h2 * self.typography.leading_h2,
            textColor=self.colors.primary,
            alignment=TA_LEFT,
            spaceAfter=10,
            spaceBefore=15,
        )
    
    def get_body_style(self, styles_base):
        """Get body text style"""
        from reportlab.lib.styles import ParagraphStyle
        from reportlab.lib.enums import TA_LEFT
        
        return ParagraphStyle(
            'ZeroSiteBody',
            parent=styles_base['Normal'],
            fontName=self.typography.font_regular,
            fontSize=self.typography.size_body,
            leading=self.typography.size_body * self.typography.leading_body,
            textColor=self.colors.text_primary,
            alignment=TA_LEFT,
        )
    
    def get_caption_style(self, styles_base):
        """Get caption/footer style"""
        from reportlab.lib.styles import ParagraphStyle
        from reportlab.lib.enums import TA_CENTER
        
        return ParagraphStyle(
            'ZeroSiteCaption',
            parent=styles_base['Normal'],
            fontName=self.typography.font_light,
            fontSize=self.typography.size_caption,
            leading=self.typography.size_caption * self.typography.leading_caption,
            textColor=self.colors.text_secondary,
            alignment=TA_CENTER,
        )
    
    def get_table_style(self, header_color=None):
        """
        Get standard table style
        
        Args:
            header_color: Optional color for header row (defaults to primary)
        """
        from reportlab.platypus import TableStyle
        
        if header_color is None:
            header_color = self.colors.primary
        
        return TableStyle([
            # Header row
            ('BACKGROUND', (0, 0), (-1, 0), header_color),
            ('TEXTCOLOR', (0, 0), (-1, 0), colors.white),
            ('FONTNAME', (0, 0), (-1, 0), self.typography.font_bold),
            ('FONTSIZE', (0, 0), (-1, 0), self.typography.size_body),
            ('ALIGN', (0, 0), (-1, 0), 'CENTER'),
            ('VALIGN', (0, 0), (-1, 0), 'MIDDLE'),
            ('BOTTOMPADDING', (0, 0), (-1, 0), 12),
            ('TOPPADDING', (0, 0), (-1, 0), 12),
            
            # Body rows
            ('BACKGROUND', (0, 1), (-1, -1), colors.white),
            ('TEXTCOLOR', (0, 1), (-1, -1), self.colors.text_primary),
            ('FONTNAME', (0, 1), (-1, -1), self.typography.font_regular),
            ('FONTSIZE', (0, 1), (-1, -1), self.typography.size_body),
            ('ALIGN', (0, 1), (-1, -1), 'LEFT'),
            ('VALIGN', (0, 1), (-1, -1), 'MIDDLE'),
            ('TOPPADDING', (0, 1), (-1, -1), 8),
            ('BOTTOMPADDING', (0, 1), (-1, -1), 8),
            
            # Grid
            ('GRID', (0, 0), (-1, -1), 0.5, self.colors.border),
            
            # Alternating rows
            ('ROWBACKGROUNDS', (0, 1), (-1, -1), [colors.white, self.colors.background]),
        ])
    
    def create_kpi_card_html(self, title: str, value: str, subtitle: str = "", color: str = "primary") -> str:
        """
        Create HTML for KPI card (for use in Paragraph)
        
        Args:
            title: Card title (e.g., "M5 ÏÇ¨ÏóÖÏÑ± Ï†êÏàò")
            value: Main value (e.g., "85Ï†ê")
            subtitle: Optional subtitle (e.g., "/ 100Ï†ê")
            color: Color scheme ("primary", "success", "warning", "danger")
        
        Returns:
            HTML string for ReportLab Paragraph
        """
        color_map = {
            "primary": str(self.colors.primary)[1:],  # Remove # from HexColor
            "success": str(self.colors.success)[1:],
            "warning": str(self.colors.warning)[1:],
            "danger": str(self.colors.danger)[1:],
        }
        
        hex_color = color_map.get(color, color_map["primary"])
        
        return f"""
<para alignment="center" spaceAfter="10">
    <font name="{self.typography.font_regular}" size="{self.typography.size_caption}" color="{self.colors.text_secondary}">
        {title}
    </font><br/>
    <font name="{self.typography.font_bold}" size="{self.typography.size_h1}" color="#{hex_color}">
        {value}
    </font>
    <font name="{self.typography.font_regular}" size="{self.typography.size_body}" color="{self.colors.text_light}">
        {subtitle}
    </font>
</para>
"""
    
    def create_badge_html(self, text: str, badge_type: str = "success") -> str:
        """
        Create HTML for status badge
        
        Args:
            text: Badge text (e.g., "GO", "CONDITIONAL", "HIGH RISK")
            badge_type: Badge type ("success", "warning", "danger", "info")
        
        Returns:
            HTML string for inline badge
        """
        badge_colors = {
            "success": (self.colors.success, colors.white),
            "warning": (self.colors.warning, colors.white),
            "danger": (self.colors.danger, colors.white),
            "info": (self.colors.primary, colors.white),
        }
        
        bg_color, text_color = badge_colors.get(badge_type, badge_colors["info"])
        
        return f"""<font name="{self.typography.font_bold}" size="{self.typography.size_body}" \
color="{text_color}" backColor="{bg_color}"> {text} </font>"""
    
    def create_executive_insight_box(self, insight_text: str, title: str = "Executive Insight") -> Any:
        """
        Executive Insight Box (\ucee8\uc124\ud305\uae09 \ud575\uc2ec \uba54\uc2dc\uc9c0 \ubc15\uc2a4)
        
        \ubaa9\ud45c: \ud55c \ud398\uc774\uc9c0\ub97c \ub118\uae30\uc790\ub9c8\uc790 '\uc544, \uc774\uac74 \ucef4\uc124\ud305 \ubcf4\uace0\uc11c\ub2e4'\ub77c\uace0 \ub290\uaef4\uac8c \ub9cc\ub4dc\ub294 \uad6c\uc870
        
        Args:
            insight_text: \ud575\uc2ec \ud310\ub2e8 \ubb38\uc7a5 (2-3\uc904 \uad8c\uc7a5)
            title: \ubc15\uc2a4 \uc81c\ubaa9 (\uae30\ubcf8: Executive Insight)
        
        Returns:
            ReportLab Table object
        """
        from reportlab.platypus import Table, Paragraph
        from reportlab.lib.styles import ParagraphStyle
        from reportlab.lib.enums import TA_LEFT
        
        # \ud575\uc2ec \uba54\uc2dc\uc9c0 \uc2a4\ud0c0\uc77c
        insight_style = ParagraphStyle(
            'ExecutiveInsight',
            fontName=self.typography.font_regular,
            fontSize=11.5,  # \uc57d\uac04 \ud06c\uac8c
            leading=18,
            textColor=self.colors.text_primary,
            alignment=TA_LEFT,
            leftIndent=15,
            rightIndent=15,
        )
        
        title_style = ParagraphStyle(
            'InsightTitle',
            fontName=self.typography.font_bold,
            fontSize=13,
            textColor=self.colors.primary,
            alignment=TA_LEFT,
            leftIndent=15,
            spaceAfter=8,
        )
        
        # \ud14d\uc2a4\ud2b8 \uad6c\uc131
        title_para = Paragraph(f"\ud83d\udca1 {title}", title_style)
        insight_para = Paragraph(insight_text, insight_style)
        
        # \ubc15\uc2a4 \ud14c\uc774\ube14
        from reportlab.platypus import TableStyle
        box_table = Table([[title_para], [insight_para]], colWidths=[16*cm])
        box_table.setStyle(TableStyle([
            ('BACKGROUND', (0, 0), (-1, -1), self.colors.background),
            ('BOX', (0, 0), (-1, -1), 2, self.colors.accent),
            ('TOPPADDING', (0, 0), (-1, -1), 12),
            ('BOTTOMPADDING', (0, 0), (-1, -1), 12),
            ('LEFTPADDING', (0, 0), (-1, -1), 0),
            ('RIGHTPADDING', (0, 0), (-1, -1), 0),
        ]))
        
        return box_table
    
    def create_flow_diagram(self, steps: list, title: str = "Process Flow") -> Any:
        """
        Flow Diagram (\ud504\ub85c\uc138\uc2a4 \ud750\ub984\ub3c4)
        
        \ubaa9\ud45c: \ub2e8\uc21c \ud14d\uc2a4\ud2b8 \ub098\uc5f4 \u2192 Flow Diagram \ud615\ud0dc\ub85c \uc2dc\uac01\ud654
        
        Args:
            steps: \ub2e8\uacc4 \ub9ac\uc2a4\ud2b8 [\"\uc785\uc9c0 \ud76c\uc18c\uc131\", \"\uac70\ub798 \uad6c\uc870\", \"\uc815\ucc45 \ud65c\uc6a9 \uac00\uce58\", \"\ud604\uc7ac \ud1a0\uc9c0\uac00\uce58 \ubc94\uc704\"]
            title: \ub2e4\uc774\uc5b4\uadf8\ub7a8 \uc81c\ubaa9
        
        Returns:
            ReportLab Table object
        """
        from reportlab.platypus import Table, Paragraph
        from reportlab.lib.styles import ParagraphStyle
        from reportlab.lib.enums import TA_CENTER
        from reportlab.lib.units import cm
        
        step_style = ParagraphStyle(
            'FlowStep',
            fontName=self.typography.font_regular,
            fontSize=10,
            leading=14,
            textColor=colors.white,
            alignment=TA_CENTER,
        )
        
        arrow_style = ParagraphStyle(
            'FlowArrow',
            fontName=self.typography.font_bold,
            fontSize=16,
            textColor=self.colors.accent,
            alignment=TA_CENTER,
        )
        
        # \ub2e8\uacc4 \ubc15\uc2a4 \uc0dd\uc131
        flow_data = []
        for i, step in enumerate(steps):
            step_para = Paragraph(step, step_style)
            flow_data.append([step_para])
            
            # ÎßàÏßÄÎßâ Îã®Í≥ÑÍ∞Ä ÏïÑÎãàÎ©¥ ÌôîÏÇ¥Ìëú Ï∂îÍ∞Ä
            if i < len(steps) - 1:
                arrow_para = Paragraph("‚Üì", arrow_style)
                flow_data.append([arrow_para])
        
        # \ud14c\uc774\ube14 \uc0dd\uc131
        from reportlab.platypus import TableStyle
        flow_table = Table(flow_data, colWidths=[12*cm])
        
        # \uc2a4\ud0c0\uc77c \uc801\uc6a9
        table_style = TableStyle([
            ('ALIGN', (0, 0), (-1, -1), 'CENTER'),
            ('VALIGN', (0, 0), (-1, -1), 'MIDDLE'),
        ])
        
        # \ub2e8\uacc4 \ubc15\uc2a4\uc5d0\ub9cc \ubc30\uacbd\uc0c9 \uc801\uc6a9
        for i in range(0, len(flow_data), 2):  # 0, 2, 4, ... (\ub2e8\uacc4 \uc778\ub371\uc2a4)
            table_style.add('BACKGROUND', (0, i), (-1, i), self.colors.primary)
            table_style.add('TOPPADDING', (0, i), (-1, i), 10)
            table_style.add('BOTTOMPADDING', (0, i), (-1, i), 10)
        
        flow_table.setStyle(table_style)
        
        return flow_table
    
    def create_horizontal_range_bar(self, low_value: float, mid_value: float, high_value: float,
                                    lh_min: float, lh_max: float, 
                                    unit: str = "\uc5b5\uc6d0", title: str = "\ud1a0\uc9c0\uac00\uce58 \ubc94\uc704") -> Any:
        """
        Horizontal Range Bar (\uac00\uaca9 \ubc94\uc704 \ubc14 \ucc28\ud2b8)
        
        \ubaa9\ud45c: \ud558\ud55c/\uae30\uc900/\uc0c1\ud55c \ubc0f LH \ub9e4\uc785 \uac00\ub2a5 \uad6c\uac04 \uc2dc\uac01\ud654
        
        Args:
            low_value: \ud558\ud55c\uac00
            mid_value: \uae30\uc900\uac00
            high_value: \uc0c1\ud55c\uac00
            lh_min: LH \ub9e4\uc785 \ucd5c\uc18c\uac00
            lh_max: LH \ub9e4\uc785 \ucd5c\ub300\uac00
            unit: \ub2e8\uc704 (\uae30\ubcf8: \uc5b5\uc6d0)
            title: \ucc28\ud2b8 \uc81c\ubaa9
        
        Returns:
            matplotlib figure (as BytesIO image)
        """
        import matplotlib.pyplot as plt
        import matplotlib.patches as mpatches
        from io import BytesIO
        
        # \ud55c\uae00 \ud3f0\ud2b8 \uc124\uc815
        plt.rcParams['font.family'] = 'NanumBarunGothic'
        plt.rcParams['axes.unicode_minus'] = False
        
        fig, ax = plt.subplots(figsize=(10, 2.5))
        
        # Y\ucd95 \uc704\uce58
        y_pos = 0.5
        
        # \ubc30\uacbd \ubc14 (\uc804\uccb4 \ubc94\uc704)
        ax.barh(y_pos, high_value - low_value, left=low_value, height=0.4, 
                color='#E5E7EB', alpha=0.5, label='\uc804\uccb4 \ubc94\uc704')
        
        # LH \ub9e4\uc785 \uac00\ub2a5 \uad6c\uac04 (\uac15\uc870)
        ax.barh(y_pos, lh_max - lh_min, left=lh_min, height=0.4, 
                color='#2F6BFF', alpha=0.6, label='LH \ub9e4\uc785 \uac00\ub2a5 \uad6c\uac04')
        
        # \uae30\uc900\uac00 \ud45c\uc2dc (\uc218\uc9c1\uc120)
        ax.axvline(mid_value, color='#0A1E3C', linewidth=2.5, label=f'\uae30\uc900\uac00 ({mid_value:.0f}{unit})')
        
        # \ud558\ud55c/\uc0c1\ud55c \ud45c\uc2dc
        ax.plot(low_value, y_pos, marker='|', markersize=15, color='#6B7280', label=f'\ud558\ud55c ({low_value:.0f}{unit})')
        ax.plot(high_value, y_pos, marker='|', markersize=15, color='#6B7280', label=f'\uc0c1\ud55c ({high_value:.0f}{unit})')
        
        # \ucd95 \uc124\uc815
        ax.set_yticks([])
        ax.set_xlabel(f'\uac00\uaca9 ({unit})', fontsize=11, color='#0A1E3C')
        ax.set_title(title, fontsize=13, fontweight='bold', color='#0A1E3C', pad=15)
        
        # \ubc94\ub840
        ax.legend(loc='upper right', fontsize=9, framealpha=0.9)
        
        # \uadf8\ub9ac\ub4dc
        ax.grid(axis='x', alpha=0.3, linestyle='--')
        
        # \uc5ec\ubc31 \uc81c\uac70
        ax.set_ylim(0, 1)
        plt.tight_layout()
        
        # BytesIO\ub85c \ubcc0\ud658
        img_buffer = BytesIO()
        plt.savefig(img_buffer, format='png', dpi=150, bbox_inches='tight')
        plt.close(fig)
        img_buffer.seek(0)
        
        return img_buffer
    
    def create_lifestyle_cards(self, lifestyle_data: list) -> Any:
        """
        Lifestyle Cards (\uc0dd\ud65c \ud328\ud134 \uce74\ub4dc)
        
        \ubaa9\ud45c: "\uccad\ub144\ud615"\uc774\ub77c\ub294 \ub2e8\uc5b4\ubcf4\ub2e4 \uc0dd\ud65c \uc7a5\uba74\uc774 \uba3c\uc800 \ubcf4\uc774\uac8c \ubc30\uce58
        
        Args:
            lifestyle_data: [\n                {\"icon\": \"\ud83c\udfc3\", \"label\": \"\uc9c1\uc8fc\uadfc\uc811\"},\n                {\"icon\": \"\ud83d\udd52\", \"label\": \"\ub2e8\uae30 \uac70\uc8fc\"},\n                {\"icon\": \"\ud83c\udfe0\", \"label\": \"\uac1c\uc778 \uc911\uc2ec\"},\n                {\"icon\": \"\ud83d\ude87\", \"label\": \"\ub300\uc911\uad50\ud1b5\"}\n            ]
        
        Returns:
            ReportLab Table object
        """
        from reportlab.platypus import Table, Paragraph
        from reportlab.lib.styles import ParagraphStyle
        from reportlab.lib.enums import TA_CENTER
        from reportlab.lib.units import cm
        
        card_style = ParagraphStyle(
            'LifestyleCard',
            fontName=self.typography.font_regular,
            fontSize=10,
            leading=14,
            textColor=self.colors.text_primary,
            alignment=TA_CENTER,
        )
        
        icon_style = ParagraphStyle(
            'LifestyleIcon',
            fontName=self.typography.font_regular,
            fontSize=24,
            textColor=self.colors.accent,
            alignment=TA_CENTER,
        )
        
        # Ïπ¥Îìú Îç∞Ïù¥ÌÑ∞ Íµ¨ÏÑ±
        cards = []
        for item in lifestyle_data:
            icon_para = Paragraph(item["icon"], icon_style)
            label_para = Paragraph(item["label"], card_style)
            cards.append([icon_para, label_para])
        
        # 4Í∞úÏùò Ïπ¥ÎìúÎ•º Í∞ÄÎ°úÎ°ú Î∞∞Ïπò
        from reportlab.platypus import TableStyle
        cards_table = Table([[cards[0][0], cards[1][0], cards[2][0], cards[3][0]],
                             [cards[0][1], cards[1][1], cards[2][1], cards[3][1]]], 
                            colWidths=[4*cm, 4*cm, 4*cm, 4*cm])
        
        cards_table.setStyle(TableStyle([\n            ('ALIGN', (0, 0), (-1, -1), 'CENTER'),\n            ('VALIGN', (0, 0), (-1, -1), 'MIDDLE'),\n            ('BACKGROUND', (0, 0), (-1, -1), self.colors.background),\n            ('BOX', (0, 0), (-1, -1), 1, self.colors.border),\n            ('INNERGRID', (0, 0), (-1, -1), 0.5, self.colors.border),\n            ('TOPPADDING', (0, 0), (-1, -1), 12),\n            ('BOTTOMPADDING', (0, 0), (-1, -1), 12),\n        ]))\n        \n        return cards_table\n    \n    def create_comparison_cards(self, left_title: str, left_items: list,\n                               right_title: str, right_items: list) -> Any:\n        \"\"\"\n        Comparison Cards (\ube44\uad50 \uce74\ub4dc)\n        \n        \ubaa9\ud45c: \uc77c\ubc18 \ubd84\uc591 vs LH \uc77c\uad04 \ub9e4\uc785 \ub4f1 \ube44\uad50 \uad6c\uc870 \uc2dc\uac01\ud654\n        \n        Args:\n            left_title: \uc67c\ucabd \uce74\ub4dc \uc81c\ubaa9 (\uc608: \"\uc77c\ubc18 \ubd84\uc591\")\n            left_items: \uc67c\ucabd \ud56d\ubaa9 [\"\ubd84\uc591 \ub9ac\uc2a4\ud06c \u26d4\", ...]\n            right_title: \uc624\ub978\ucabd \uce74\ub4dc \uc81c\ubaa9 (\uc608: \"LH \uc77c\uad04 \ub9e4\uc785\")\n            right_items: \uc624\ub978\ucabd \ud56d\ubaa9 [\"\uc218\uc775 \ud655\uc815 \u2705\", ...]\n        \n        Returns:\n            ReportLab Table object\n        \"\"\"\n        from reportlab.platypus import Table, Paragraph\n        from reportlab.lib.styles import ParagraphStyle\n        from reportlab.lib.enums import TA_LEFT\n        from reportlab.lib.units import cm\n        \n        title_style = ParagraphStyle(\n            'ComparisonTitle',\n            fontName=self.typography.font_bold,\n            fontSize=12,\n            textColor=self.colors.primary,\n            alignment=TA_LEFT,\n            spaceAfter=6,\n        )\n        \n        item_style = ParagraphStyle(\n            'ComparisonItem',\n            fontName=self.typography.font_regular,\n            fontSize=10,\n            leading=16,\n            textColor=self.colors.text_primary,\n            alignment=TA_LEFT,\n        )\n        \n        # \uc67c\ucabd \uce74\ub4dc\n        left_content = [Paragraph(left_title, title_style)]\n        for item in left_items:\n            left_content.append(Paragraph(f\"‚Ä¢ {item}\", item_style))\n        \n        # \uc624\ub978\ucabd \uce74\ub4dc\n        right_content = [Paragraph(right_title, title_style)]\n        for item in right_items:\n            right_content.append(Paragraph(f\"‚Ä¢ {item}\", item_style))\n        \n        # \ud14c\uc774\ube14 \uad6c\uc131\n        from reportlab.platypus import TableStyle\n        comparison_table = Table([[left_content, right_content]], colWidths=[8*cm, 8*cm])\n        \n        comparison_table.setStyle(TableStyle([\n            ('ALIGN', (0, 0), (-1, -1), 'LEFT'),\n            ('VALIGN', (0, 0), (-1, -1), 'TOP'),\n            ('BACKGROUND', (0, 0), (0, 0), colors.HexColor('#FEF2F2')),  # \uc67c\ucabd \ubc30\uacbd (\uc5f0\ud55c \ube68\uac04)\n            ('BACKGROUND', (1, 0), (1, 0), colors.HexColor('#F0FDF4')),  # \uc624\ub978\ucabd \ubc30\uacbd (\uc5f0\ud55c \ub179\uc0c9)\n            ('BOX', (0, 0), (-1, -1), 1.5, self.colors.border),\n            ('INNERGRID', (0, 0), (-1, -1), 1, self.colors.border),\n            ('TOPPADDING', (0, 0), (-1, -1), 15),\n            ('BOTTOMPADDING', (0, 0), (-1, -1), 15),\n            ('LEFTPADDING', (0, 0), (-1, -1), 12),\n            ('RIGHTPADDING', (0, 0), (-1, -1), 12),\n        ]))\n        \n        return comparison_table
    
    def create_final_decision_badge(self, decision: str, score: float, subtitle: str = "") -> Any:
        """
        Final Decision Badge (M6 ÏµúÏ¢Ö ÌåêÎã® Î∞∞ÏßÄ)
        
        Î™©Ìëú: GO / CONDITIONAL / NO-GO Ïª¨Îü¨ + ÏïÑÏù¥ÏΩò + Ìïú Î¨∏Ïû•
        
        Args:
            decision: ÌåêÎã® (GO, CONDITIONAL, NOGO)
            score: LH Ï†êÏàò (0-100)
            subtitle: Î∂ÄÍ∞Ä ÏÑ§Î™Ö (ÏÑ†ÌÉù)
        
        Returns:
            ReportLab Table object
        """
        from reportlab.platypus import Table, Paragraph
        from reportlab.lib.styles import ParagraphStyle
        from reportlab.lib.enums import TA_CENTER
        from reportlab.lib.units import cm
        
        # ÌåêÎã®Î≥Ñ Ïª¨Îü¨ Î∞è ÏïÑÏù¥ÏΩò
        decision_map = {
            'GO': {
                'color': self.colors.positive_green,
                'icon': '‚úÖ',
                'text': 'ÏßÑÌñâ Í∞ÄÎä•',
                'bg': colors.HexColor('#F0FDF4')
            },
            'CONDITIONAL': {
                'color': self.colors.warning,
                'icon': '‚ö†Ô∏è',
                'text': 'Ï°∞Í±¥Î∂Ä Í∞ÄÎä•',
                'bg': colors.HexColor('#FFFBEB')
            },
            'NOGO': {
                'color': self.colors.risk_red,
                'icon': '‚ùå',
                'text': 'Í≤ÄÌÜ† ÌïÑÏöî',
                'bg': colors.HexColor('#FEF2F2')
            }
        }
        
        decision_info = decision_map.get(decision, decision_map['CONDITIONAL'])
        
        # Ïä§ÌÉÄÏùº
        icon_style = ParagraphStyle(
            'DecisionIcon',
            fontName=self.typography.font_regular,
            fontSize=48,
            alignment=TA_CENTER,
        )
        
        title_style = ParagraphStyle(
            'DecisionTitle',
            fontName=self.typography.font_bold,
            fontSize=18,
            textColor=decision_info['color'],
            alignment=TA_CENTER,
            spaceAfter=4,
        )
        
        score_style = ParagraphStyle(
            'DecisionScore',
            fontName=self.typography.font_bold,
            fontSize=24,
            textColor=self.colors.primary,
            alignment=TA_CENTER,
            spaceAfter=4,
        )
        
        subtitle_style = ParagraphStyle(
            'DecisionSubtitle',
            fontName=self.typography.font_regular,
            fontSize=11,
            textColor=self.colors.text_secondary,
            alignment=TA_CENTER,
        )
        
        # Î∞∞ÏßÄ Ïª®ÌÖêÏ∏†
        icon_para = Paragraph(decision_info['icon'], icon_style)
        title_para = Paragraph(decision_info['text'], title_style)
        score_para = Paragraph(f"{score:.1f}/100", score_style)
        subtitle_para = Paragraph(subtitle, subtitle_style) if subtitle else Paragraph("", subtitle_style)
        
        # Î∞∞ÏßÄ ÌÖåÏù¥Î∏î
        from reportlab.platypus import TableStyle
        badge_table = Table([[icon_para], [title_para], [score_para], [subtitle_para]], colWidths=[14*cm])
        
        badge_table.setStyle(TableStyle([
            ('ALIGN', (0, 0), (-1, -1), 'CENTER'),
            ('VALIGN', (0, 0), (-1, -1), 'MIDDLE'),
            ('BACKGROUND', (0, 0), (-1, -1), decision_info['bg']),
            ('BOX', (0, 0), (-1, -1), 3, decision_info['color']),
            ('TOPPADDING', (0, 0), (-1, -1), 20),
            ('BOTTOMPADDING', (0, 0), (-1, -1), 20),
        ]))
        
        return badge_table


# Singleton instance for easy import
theme = ZeroSiteTheme()


# Export all public classes and instances
__all__ = [
    'ZeroSiteColors',
    'ZeroSiteTypography',
    'ZeroSiteLayout',
    'ZeroSiteTheme',
    'theme',  # Singleton instance
]
