"""
ZeroSite v37.0 - 법정동코드 매퍼
시·군·구 → 법정동코드 변환

Author: Antenna Holdings Development Team
Date: 2025-12-13
Purpose: Convert city/district names to LAWD codes for MOLIT API
"""

import logging

logger = logging.getLogger(__name__)

# 전국 주요 시·군·구 법정동코드 (5자리)
LAWD_CODE_MAP = {
    # 서울특별시 (25개 구)
    '강남구': '11680',
    '강동구': '11740',
    '강북구': '11305',
    '강서구': '11500',
    '관악구': '11620',
    '광진구': '11215',
    '구로구': '11530',
    '금천구': '11545',
    '노원구': '11350',
    '도봉구': '11320',
    '동대문구': '11230',
    '동작구': '11590',
    '마포구': '11440',
    '서대문구': '11410',
    '서초구': '11650',
    '성동구': '11200',
    '성북구': '11290',
    '송파구': '11710',
    '양천구': '11470',
    '영등포구': '11560',
    '용산구': '11170',
    '은평구': '11380',
    '종로구': '11110',
    '중구': '11140',
    '중랑구': '11260',
    
    # 부산광역시 (16개 구·군)
    '해운대구': '26350',
    '수영구': '26380',
    '동래구': '26260',
    '부산진구': '26230',
    '남구': '26290',
    '연제구': '26470',
    '중구': '26110',
    '서구': '26140',
    '동구': '26170',
    '영도구': '26200',
    '북구': '26320',
    '강서구': '26440',
    '사상구': '26410',
    '금정구': '26410',
    '사하구': '26380',
    '기장군': '26710',
    
    # 인천광역시 (10개 구·군)
    '연수구': '28185',
    '남동구': '28177',
    '부평구': '28237',
    '계양구': '28245',
    '서구': '28260',
    '중구': '28110',
    '동구': '28140',
    '미추홀구': '28177',
    '강화군': '28710',
    '옹진군': '28720',
    
    # 대구광역시 (8개 구·군)
    '수성구': '27200',
    '중구': '27110',
    '동구': '27140',
    '서구': '27170',
    '남구': '27200',
    '북구': '27230',
    '달서구': '27260',
    '달성군': '27710',
    
    # 광주광역시 (5개 구)
    '서구': '29140',
    '동구': '29110',
    '남구': '29155',
    '북구': '29170',
    '광산구': '29200',
    
    # 대전광역시 (5개 구)
    '유성구': '30200',
    '서구': '30140',
    '중구': '30110',
    '동구': '30170',
    '대덕구': '30230',
    
    # 울산광역시 (5개 구·군)
    '남구': '31140',
    '중구': '31110',
    '동구': '31170',
    '북구': '31200',
    '울주군': '31710',
    
    # 세종특별자치시
    '세종시': '36110',
    '세종특별자치시': '36110',
    
    # 경기도 (주요 시)
    '수원시': '41110',
    '성남시': '41130',
    '고양시': '41280',
    '용인시': '41460',
    '부천시': '41190',
    '안양시': '41170',
    '남양주시': '41360',
    '화성시': '41590',
    '평택시': '41220',
    '의정부시': '41150',
    '시흥시': '41390',
    '파주시': '41480',
    '김포시': '41570',
    '광명시': '41210',
    '광주시': '41610',
    '군포시': '41410',
    '하남시': '41450',
    '오산시': '41370',
    '양주시': '41630',
    '이천시': '41500',
    '구리시': '41310',
    '안성시': '41550',
    '포천시': '41650',
    '의왕시': '41430',
    '양평군': '41830',
    '여주시': '41670',
    '동두천시': '41250',
    '과천시': '41290',
    '가평군': '41820',
    '연천군': '41800',
    
    # 강원특별자치도 (18개 시·군)
    '춘천시': '42110',
    '원주시': '42130',
    '강릉시': '42150',
    '동해시': '42170',
    '태백시': '42190',
    '속초시': '42210',
    '삼척시': '42230',
    '홍천군': '42720',
    '횡성군': '42730',
    '영월군': '42750',
    '평창군': '42760',
    '정선군': '42770',
    '철원군': '42780',
    '화천군': '42790',
    '양구군': '42800',
    '인제군': '42810',
    '고성군': '42820',
    '양양군': '42830',
    
    # 충청북도 (11개 시·군)
    '청주시': '43110',
    '충주시': '43130',
    '제천시': '43150',
    '보은군': '43720',
    '옥천군': '43730',
    '영동군': '43740',
    '증평군': '43745',
    '진천군': '43750',
    '괴산군': '43760',
    '음성군': '43770',
    '단양군': '43800',
    
    # 충청남도 (15개 시·군)
    '천안시': '44130',
    '공주시': '44150',
    '보령시': '44180',
    '아산시': '44200',
    '서산시': '44210',
    '논산시': '44230',
    '계룡시': '44250',
    '당진시': '44270',
    '금산군': '44710',
    '부여군': '44760',
    '서천군': '44770',
    '청양군': '44790',
    '홍성군': '44800',
    '예산군': '44810',
    '태안군': '44825',
    
    # 전북특별자치도 (14개 시·군)
    '전주시': '45110',
    '군산시': '45130',
    '익산시': '45140',
    '정읍시': '45180',
    '남원시': '45190',
    '김제시': '45210',
    '완주군': '45710',
    '진안군': '45720',
    '무주군': '45730',
    '장수군': '45740',
    '임실군': '45750',
    '순창군': '45770',
    '고창군': '45790',
    '부안군': '45800',
    
    # 전라남도 (22개 시·군)
    '목포시': '46110',
    '여수시': '46130',
    '순천시': '46150',
    '나주시': '46170',
    '광양시': '46230',
    '담양군': '46710',
    '곡성군': '46720',
    '구례군': '46730',
    '고흥군': '46770',
    '보성군': '46780',
    '화순군': '46790',
    '장흥군': '46800',
    '강진군': '46810',
    '해남군': '46820',
    '영암군': '46830',
    '무안군': '46840',
    '함평군': '46860',
    '영광군': '46870',
    '장성군': '46880',
    '완도군': '46890',
    '진도군': '46900',
    '신안군': '46910',
    
    # 경상북도 (23개 시·군)
    '포항시': '47110',
    '경주시': '47130',
    '김천시': '47150',
    '안동시': '47170',
    '구미시': '47190',
    '영주시': '47210',
    '영천시': '47230',
    '상주시': '47250',
    '문경시': '47280',
    '경산시': '47290',
    '의성군': '47730',
    '청송군': '47750',
    '영양군': '47760',
    '영덕군': '47770',
    '청도군': '47820',
    '고령군': '47830',
    '성주군': '47840',
    '칠곡군': '47850',
    '예천군': '47900',
    '봉화군': '47920',
    '울진군': '47930',
    '울릉군': '47940',
    '군위군': '47720',
    
    # 경상남도 (18개 시·군)
    '창원시': '48120',
    '진주시': '48170',
    '통영시': '48220',
    '사천시': '48240',
    '김해시': '48250',
    '밀양시': '48270',
    '거제시': '48310',
    '양산시': '48330',
    '의령군': '48720',
    '함안군': '48730',
    '창녕군': '48740',
    '고성군': '48820',
    '남해군': '48840',
    '하동군': '48850',
    '산청군': '48860',
    '함양군': '48870',
    '거창군': '48880',
    '합천군': '48890',
    
    # 제주특별자치도 (2개 시)
    '제주시': '50110',
    '서귀포시': '50130',
}


def get_lawd_code(sigungu: str) -> str:
    """
    시·군·구 → 법정동코드 변환
    
    Args:
        sigungu: 시·군·구 이름
            예: "강남구", "성남시", "제주시"
    
    Returns:
        법정동코드 (5자리) 또는 빈 문자열
        예: "11680", "41130", "50110"
    """
    
    if not sigungu:
        logger.warning("시·군·구 정보 없음")
        return ''
    
    # 정확히 일치
    if sigungu in LAWD_CODE_MAP:
        code = LAWD_CODE_MAP[sigungu]
        logger.info(f"✅ 법정동코드: {sigungu} → {code}")
        return code
    
    # 부분 일치 (예: "수원시 팔달구" → "수원시")
    for key in LAWD_CODE_MAP.keys():
        if key in sigungu or sigungu in key:
            code = LAWD_CODE_MAP[key]
            logger.info(f"✅ 법정동코드 (부분일치): {sigungu} → {key} → {code}")
            return code
    
    logger.warning(f"⚠️ 법정동코드 없음: {sigungu}")
    return ''


def get_all_codes() -> dict:
    """모든 법정동코드 반환 (디버깅용)"""
    return LAWD_CODE_MAP.copy()


# ============================================================================
# TEST CODE
# ============================================================================

if __name__ == "__main__":
    import logging
    logging.basicConfig(level=logging.INFO)
    
    print("=" * 60)
    print("LAWD Code Mapper Test")
    print("=" * 60)
    
    test_cases = [
        "강남구",
        "해운대구",
        "연수구",
        "수성구",
        "제주시",
        "성남시",
        "수원시 팔달구",
        "존재하지않는구"
    ]
    
    for sigungu in test_cases:
        code = get_lawd_code(sigungu)
        print(f"\n{sigungu}: {code if code else 'NOT FOUND'}")
    
    print("\n" + "=" * 60)
    print(f"Total registered codes: {len(LAWD_CODE_MAP)}")
    print("=" * 60)
