<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ZeroSite Expert Edition v3 - í† ì§€ê°ì •í‰ê°€</title>
    <style>
        @page {
            size: A4;
            margin: 20mm;
            @bottom-center {
                content: "Â© ZeroSite Expert Edition v3 Â· Antenna Holdings Â· Na Tae-heum. All rights reserved.";
                font-size: 8pt;
                color: #666;
            }
            @bottom-right {
                content: "Page " counter(page);
                font-size: 8pt;
                color: #666;
            }
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Noto Sans KR', 'Malgun Gothic', sans-serif;
            font-size: 10pt;
            line-height: 1.6;
            color: #222;
            background: white;
        }

        /* Cover Page */
        .cover-page {
            page-break-after: always;
            height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            background: linear-gradient(135deg, #1a1a1a 0%, #2d2d2d 100%);
            color: white;
            text-align: center;
            padding: 40mm;
        }

        .cover-logo {
            font-size: 48pt;
            font-weight: 900;
            letter-spacing: -2px;
            margin-bottom: 20px;
        }

        .cover-subtitle {
            font-size: 14pt;
            color: #aaa;
            margin-bottom: 60px;
            letter-spacing: 2px;
        }

        .cover-title {
            font-size: 24pt;
            font-weight: 700;
            margin-bottom: 20px;
            line-height: 1.4;
        }

        .cover-address {
            font-size: 18pt;
            color: #ccc;
            margin-bottom: 60px;
        }

        .cover-meta {
            font-size: 11pt;
            color: #888;
        }

        /* Content Pages */
        .content-page {
            page-break-after: always;
        }

        .header {
            border-bottom: 3px solid #1a1a1a;
            padding-bottom: 10px;
            margin-bottom: 20px;
        }

        h1 {
            font-size: 20pt;
            font-weight: 700;
            color: #1a1a1a;
            margin-bottom: 5px;
        }

        h2 {
            font-size: 14pt;
            font-weight: 600;
            color: #2d2d2d;
            margin-top: 20px;
            margin-bottom: 10px;
            padding-left: 10px;
            border-left: 4px solid #1a1a1a;
        }

        h3 {
            font-size: 12pt;
            font-weight: 600;
            color: #444;
            margin-top: 15px;
            margin-bottom: 8px;
        }

        .info-box {
            background: #f8f9fa;
            border-left: 4px solid #1a1a1a;
            padding: 15px;
            margin: 15px 0;
            border-radius: 4px;
        }

        .info-box h3 {
            margin-top: 0;
            color: #1a1a1a;
        }

        .info-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-top: 10px;
        }

        .info-item {
            padding: 8px;
            background: white;
            border-radius: 4px;
        }

        .info-label {
            font-size: 9pt;
            color: #666;
            font-weight: 600;
        }

        .info-value {
            font-size: 11pt;
            color: #1a1a1a;
            font-weight: 700;
            margin-top: 2px;
        }

        .highlight-box {
            background: linear-gradient(135deg, #1a1a1a 0%, #2d2d2d 100%);
            color: white;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
            text-align: center;
        }

        .highlight-value {
            font-size: 28pt;
            font-weight: 900;
            margin: 10px 0;
        }

        .highlight-label {
            font-size: 11pt;
            color: #ccc;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
            font-size: 9pt;
        }

        th {
            background: #1a1a1a;
            color: white;
            padding: 10px;
            text-align: left;
            font-weight: 600;
        }

        td {
            padding: 8px 10px;
            border-bottom: 1px solid #ddd;
        }

        tr:nth-child(even) {
            background: #f8f9fa;
        }

        .badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 9pt;
            font-weight: 600;
            margin-right: 5px;
        }

        .badge-high {
            background: #d4edda;
            color: #155724;
        }

        .badge-medium {
            background: #fff3cd;
            color: #856404;
        }

        .badge-low {
            background: #f8d7da;
            color: #721c24;
        }

        .status-buy {
            color: #0066cc;
            font-weight: 700;
        }

        .status-hold {
            color: #ff9900;
            font-weight: 700;
        }

        .status-sell {
            color: #cc0000;
            font-weight: 700;
        }

        .watermark {
            position: fixed;
            bottom: 10mm;
            right: 10mm;
            font-size: 8pt;
            color: #ccc;
            opacity: 0.5;
        }

        .section {
            margin-bottom: 30px;
        }

        .two-column {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 15px 0;
        }

        .metric-card {
            background: white;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            padding: 15px;
            text-align: center;
        }

        .metric-value {
            font-size: 18pt;
            font-weight: 700;
            color: #1a1a1a;
            margin: 5px 0;
        }

        .metric-label {
            font-size: 9pt;
            color: #666;
        }
    </style>
</head>
<body>
    <!-- Cover Page -->
    <div class="cover-page">
        <div class="cover-logo">ZeroSite</div>
        <div class="cover-subtitle">Expert Edition v3 Â· Academic Research-Grade Report</div>
        <div class="cover-title">í† ì§€ê°ì •í‰ê°€ ì „ë¬¸ê°€ ë¶„ì„ ë³´ê³ ì„œ<br>Land Appraisal Expert Report</div>
        <div class="cover-address">{{ data.input.address }}</div>
        <div class="cover-meta">
            ëŒ€ì§€ë©´ì : {{ "%.1f"|format(data.input.land_size_sqm) }}ã¡ | ìš©ë„ì§€ì—­: {{ data.input.zone_type }}<br>
            ìƒì„±ì¼ì‹œ: {{ data.timestamp }}<br>
            ë³´ê³ ì„œ ID: {{ data.report_id }}
        </div>
    </div>

    <!-- Page 1: Executive Summary -->
    <div class="content-page">
        <div class="header">
            <h1>01. Executive Summary (ê²½ì˜ì§„ ìš”ì•½)</h1>
        </div>

        <div class="highlight-box">
            <div class="highlight-label">ê°ì •í‰ê°€ì•¡ (Estimated Value)</div>
            <div class="highlight-value">â‚©{{ "{:,.0f}".format(data.valuation.estimated_price_krw) }}</div>
            <div class="highlight-label">{{ "{:,.0f}".format(data.valuation.price_per_sqm_krw) }} ì›/ã¡</div>
        </div>

        <div class="section">
            <h2>í‰ê°€ ê°œìš”</h2>
            <div class="info-grid">
                <div class="info-item">
                    <div class="info-label">ëŒ€ìƒ ì£¼ì†Œ</div>
                    <div class="info-value">{{ data.input.address }}</div>
                </div>
                <div class="info-item">
                    <div class="info-label">ëŒ€ì§€ ë©´ì </div>
                    <div class="info-value">{{ "%.1f"|format(data.input.land_size_sqm) }}ã¡</div>
                </div>
                <div class="info-item">
                    <div class="info-label">ìš©ë„ ì§€ì—­</div>
                    <div class="info-value">{{ data.input.zone_type }}</div>
                </div>
                <div class="info-item">
                    <div class="info-label">í‰ê°€ ì‹ ë¢°ë„</div>
                    <div class="info-value">
                        {{ "%.0f"|format(data.valuation.confidence_score * 100) }}%
                        <span class="badge badge-{{ 'high' if data.valuation.confidence_level == 'HIGH' else ('medium' if data.valuation.confidence_level == 'MEDIUM' else 'low') }}">
                            {{ data.valuation.confidence_level }}
                        </span>
                    </div>
                </div>
            </div>
        </div>

        <div class="section">
            <h2>ê°€ê²© ë²”ìœ„ ë¶„ì„</h2>
            <div class="two-column">
                <div class="metric-card">
                    <div class="metric-label">ìµœì €ê°€</div>
                    <div class="metric-value">â‚©{{ "{:,.0f}".format(data.valuation.price_range.low) }}</div>
                </div>
                <div class="metric-card">
                    <div class="metric-label">í‰ê· ê°€</div>
                    <div class="metric-value">â‚©{{ "{:,.0f}".format(data.valuation.price_range.avg) }}</div>
                </div>
            </div>
            <div class="two-column">
                <div class="metric-card">
                    <div class="metric-label">ìµœê³ ê°€</div>
                    <div class="metric-value">â‚©{{ "{:,.0f}".format(data.valuation.price_range.high) }}</div>
                </div>
                <div class="metric-card">
                    <div class="metric-label">ê±°ë˜ ì‚¬ë¡€ìˆ˜</div>
                    <div class="metric-value">{{ data.valuation.transaction_count }}ê±´</div>
                </div>
            </div>
        </div>

        {% if data.recommendation %}
        <div class="section">
            <h2>íˆ¬ì ì˜ê²¬</h2>
            <div class="info-box">
                <h3>
                    {% if data.input.asking_price %}
                    ìš”ì²­ê°€: â‚©{{ "{:,.0f}".format(data.input.asking_price) }}
                    {% endif %}
                </h3>
                <p style="font-size: 12pt; margin-top: 10px;">
                    <strong>íŒì •:</strong>
                    <span class="status-{{ 'buy' if 'ë§¤ìˆ˜' in data.recommendation.status else ('hold' if 'ê´€ë§' in data.recommendation.status else 'sell') }}">
                        {{ data.recommendation.emoji }} {{ data.recommendation.status }}
                    </span>
                </p>
                {% if data.recommendation.difference_krw %}
                <p style="margin-top: 8px; font-size: 10pt; color: #666;">
                    ì‹œì„¸ ì°¨ì´: â‚©{{ "{:,.0f}".format(data.recommendation.difference_krw) }}
                    ({{ "%.2f"|format(data.recommendation.difference_pct) }}%)
                </p>
                {% endif %}
            </div>
        </div>
        {% endif %}

        <div class="section">
            <h2>Enhanced Features (GenSpark AI)</h2>
            <div class="info-grid">
                <div class="info-item">
                    <div class="info-label">ê±°ë¦¬ ë³´ì •</div>
                    <div class="info-value">{{ data.valuation.enhanced_features.adjustment_weights.distance }}</div>
                </div>
                <div class="info-item">
                    <div class="info-label">ì‹œì  ë³´ì •</div>
                    <div class="info-value">{{ data.valuation.enhanced_features.adjustment_weights.time }}</div>
                </div>
                <div class="info-item">
                    <div class="info-label">ê·œëª¨ ë³´ì •</div>
                    <div class="info-value">{{ data.valuation.enhanced_features.adjustment_weights.size }}</div>
                </div>
                <div class="info-item">
                    <div class="info-label">ìš©ë„ ë³´ì •</div>
                    <div class="info-value">{{ data.valuation.enhanced_features.adjustment_weights.zone }}</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Page 2: Comparable Transactions -->
    <div class="content-page">
        <div class="header">
            <h1>02. ë¹„êµ ê±°ë˜ ì‚¬ë¡€ (Comparable Transactions)</h1>
        </div>

        <div class="section">
            <h2>ê±°ë˜ ì‚¬ë¡€ ë¶„ì„</h2>
            <p style="margin-bottom: 15px; color: #666;">
                ì´ <strong>{{ data.valuation.transaction_count }}ê±´</strong>ì˜ ìœ ì‚¬ ê±°ë˜ ì‚¬ë¡€ë¥¼ ë¶„ì„í–ˆìŠµë‹ˆë‹¤.
                ë™ì  ì•Œê³ ë¦¬ì¦˜ìœ¼ë¡œ ìƒì„±ëœ ë¹„êµ ì‚¬ë¡€ëŠ” ê±°ë¦¬, ì‹œì , ê·œëª¨, ìš©ë„ë¥¼ 4-Factorë¡œ ë³´ì •í–ˆìŠµë‹ˆë‹¤.
            </p>

            <table>
                <thead>
                    <tr>
                        <th>ì£¼ì†Œ</th>
                        <th>ê±°ë¦¬</th>
                        <th>ë©´ì </th>
                        <th>ë‹¨ê°€ (ì›/ã¡)</th>
                        <th>ê±°ë˜ì¼</th>
                        <th>ë³´ì •ìœ¨</th>
                    </tr>
                </thead>
                <tbody>
                    {% for comp in data.comparables[:5] %}
                    <tr>
                        <td>{{ comp.address }}</td>
                        <td>{{ "%.2f"|format(comp.distance_km) }}km</td>
                        <td>{{ "%.1f"|format(comp.size_sqm) }}ã¡</td>
                        <td>â‚©{{ "{:,}".format(comp.price_per_sqm) }}</td>
                        <td>{{ comp.transaction_date }}</td>
                        <td>{{ comp.adjustments.total }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>

        <div class="section">
            <h2>ìœ„ì¹˜ ì •ë³´</h2>
            <div class="info-box">
                <h3>ì¢Œí‘œ ì •ë³´</h3>
                <div class="info-grid">
                    <div class="info-item">
                        <div class="info-label">ìœ„ë„ (Latitude)</div>
                        <div class="info-value">{{ "%.6f"|format(data.valuation.coordinate.lat) }}</div>
                    </div>
                    <div class="info-item">
                        <div class="info-label">ê²½ë„ (Longitude)</div>
                        <div class="info-value">{{ "%.6f"|format(data.valuation.coordinate.lng) }}</div>
                    </div>
                    <div class="info-item">
                        <div class="info-label">ê´‘ì—­ì‹œë„</div>
                        <div class="info-value">{{ data.valuation.coordinate.region }}</div>
                    </div>
                    <div class="info-item">
                        <div class="info-label">ì‹œêµ°êµ¬</div>
                        <div class="info-value">{{ data.valuation.coordinate.district }}</div>
                    </div>
                </div>
            </div>
        </div>

        {% if data.negotiation %}
        <div class="section">
            <h2>í˜‘ìƒ ì „ëµ (Negotiation Strategy)</h2>
            {% if data.negotiation.market_price %}
            <div class="info-box">
                <h3>ğŸ“Š ì‹œì¥ í‰ê· ê°€ ì „ëµ</h3>
                <p>â‚©{{ "{:,.0f}".format(data.negotiation.market_price) }}</p>
            </div>
            {% endif %}
            {% if data.negotiation.recommended_price %}
            <div class="info-box">
                <h3>â­ ì¶”ì²œ ë§¤ì…ê°€ (Top 3 í‰ê· )</h3>
                <p style="font-size: 14pt; font-weight: 700; color: #0066cc;">
                    â‚©{{ "{:,.0f}".format(data.negotiation.recommended_price) }}
                </p>
            </div>
            {% endif %}
            {% if data.negotiation.conservative_price %}
            <div class="info-box">
                <h3>ğŸ’¡ ë³´ìˆ˜ì  ì „ëµ (5% í• ì¸)</h3>
                <p>â‚©{{ "{:,.0f}".format(data.negotiation.conservative_price) }}</p>
            </div>
            {% endif %}
        </div>
        {% endif %}
    </div>

    <!-- Page 3: Technical Details -->
    <div class="content-page">
        <div class="header">
            <h1>03. ê¸°ìˆ  ì •ë³´ (Technical Information)</h1>
        </div>

        <div class="section">
            <h2>í‰ê°€ ì—”ì§„ ì •ë³´</h2>
            <div class="info-box">
                <h3>Land Valuation Engine v9.1 Enhanced</h3>
                <p style="margin-top: 10px; line-height: 1.8;">
                    <strong>âœ¨ Enhanced Mode:</strong> GenSpark AI ë°±ì—”ë“œ ì„œë¹„ìŠ¤ í†µí•©<br>
                    <strong>ğŸ”§ Dynamic Transactions:</strong> ì•Œê³ ë¦¬ì¦˜ ê¸°ë°˜ ë¹„êµì‚¬ë¡€ ìƒì„± ({{ data.valuation.transaction_count }}ê±´)<br>
                    <strong>ğŸ“Š 4-Factor Adjustment:</strong> ê±°ë¦¬(35%) + ì‹œì (25%) + ê·œëª¨(25%) + ìš©ë„(15%)<br>
                    <strong>ğŸ¯ Advanced Confidence:</strong> í‘œë³¸ìˆ˜(30%) + ê°€ê²©ë¶„ì‚°(30%) + ê±°ë¦¬(25%) + ìµœì‹ ì„±(15%)<br>
                    <strong>ğŸ’° Financial Analysis:</strong> ìë™ ì¬ë¬´ ë¶„ì„ ë° í˜‘ìƒ ì „ëµ ìƒì„±
                </p>
            </div>
        </div>

        <div class="section">
            <h2>ë³´ê³ ì„œ ë©”íƒ€ë°ì´í„°</h2>
            <div class="info-grid">
                <div class="info-item">
                    <div class="info-label">ë³´ê³ ì„œ ID</div>
                    <div class="info-value" style="font-size: 9pt;">{{ data.report_id }}</div>
                </div>
                <div class="info-item">
                    <div class="info-label">ìƒì„± ì‹œê°</div>
                    <div class="info-value" style="font-size: 9pt;">{{ data.timestamp }}</div>
                </div>
                <div class="info-item">
                    <div class="info-label">API ë²„ì „</div>
                    <div class="info-value">v3.0</div>
                </div>
                <div class="info-item">
                    <div class="info-label">ì—”ì§„ ëª¨ë“œ</div>
                    <div class="info-value">Enhanced</div>
                </div>
            </div>
        </div>

        <div class="section">
            <h2>ë©´ì±… ì¡°í•­ (Disclaimer)</h2>
            <div style="background: #fff3cd; border-left: 4px solid #ffc107; padding: 15px; font-size: 9pt; line-height: 1.8;">
                <p><strong>âš ï¸ ì¤‘ìš” ì•ˆë‚´ì‚¬í•­</strong></p>
                <p style="margin-top: 10px;">
                    ë³¸ ë³´ê³ ì„œëŠ” ZeroSite Expert Edition v3ì˜ Land Valuation Engine v9.1ì„ ì‚¬ìš©í•˜ì—¬ ìë™ ìƒì„±ëœ 
                    í† ì§€ê°ì •í‰ê°€ ì°¸ê³ ìë£Œì…ë‹ˆë‹¤. ì‹¤ì œ ê±°ë˜ ì‹œì—ëŠ” ê³µì¸ê°ì •í‰ê°€ì‚¬ì˜ ì •ì‹ ê°ì •í‰ê°€ì„œë¥¼ ë°›ìœ¼ì‹œê¸° ë°”ëë‹ˆë‹¤.
                </p>
                <p style="margin-top: 10px;">
                    <strong>ìƒì„± ê¸°ìˆ :</strong> GenSpark AI Enhanced Services (Dynamic Transaction Generation, 
                    4-Factor Price Adjustment, Advanced Confidence Scoring)
                </p>
                <p style="margin-top: 10px;">
                    <strong>ë°ì´í„° ì¶œì²˜:</strong> ê³µê°œëœ ë¶€ë™ì‚° ê±°ë˜ ì •ë³´ ë° ì•Œê³ ë¦¬ì¦˜ ìƒì„± ë¹„êµì‚¬ë¡€
                </p>
            </div>
        </div>

        <div style="margin-top: 40px; text-align: center; color: #999; font-size: 9pt;">
            <p><strong>ZeroSite Expert Edition v3</strong></p>
            <p>Academic Research-Grade Land Appraisal System</p>
            <p style="margin-top: 10px;">Â© Antenna Holdings Â· Na Tae-heum. All rights reserved.</p>
            <p style="margin-top: 5px;">Generated by Land Report API v3 with WeasyPrint</p>
        </div>
    </div>

    <div class="watermark">ZeroSite v3</div>
</body>
</html>
