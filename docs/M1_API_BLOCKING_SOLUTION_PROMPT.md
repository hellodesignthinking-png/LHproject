# ğŸ§  ZeroSite M1 â€“ API ì°¨ë‹¨ ëŒ€ì‘ êµ¬ì¡° ìˆ˜ì • í”„ë¡¬í”„íŠ¸ (FINAL)

**ì‘ì„±ì¼**: 2025-12-18  
**ëª©ì **: GitHub Pages/Actions í™˜ê²½ì—ì„œ ê³µê³µ API ì°¨ë‹¨ ë¬¸ì œ í•´ê²°  
**í•µì‹¬ ì „ëµ**: Proxy ê¸°ë°˜ ìš°íšŒ + Referer ìœ„ì¡° + M1 êµ¬ì¡° ë³´ì¡´

---

## ğŸ¯ í”„ë¡¬í”„íŠ¸ ëª©ì 

ZeroSite M1(Land Information Module)ì´ ê³µê³µ API(V-World, Kakao, êµ­í† ë¶€ ë“±)ë¥¼ ì§ì ‘ í˜¸ì¶œí•  ë•Œ ë°œìƒí•˜ëŠ” **CORS, Referer, Origin ì°¨ë‹¨ ë¬¸ì œ**ë¥¼ í•´ê²°í•˜ë˜, **M1ì˜ STEP ê¸°ë°˜ UX êµ¬ì¡°ì™€ ì² í•™ì€ ì ˆëŒ€ ë³€ê²½í•˜ì§€ ì•ŠëŠ”** ê²ƒì„ ëª©í‘œë¡œ í•©ë‹ˆë‹¤.

---

## ğŸ“‹ Genspark AIì—ê²Œ ì „ë‹¬í•  í”„ë¡¬í”„íŠ¸

```markdown
ë„ˆëŠ” ZeroSiteë¼ëŠ” ë¶€ë™ì‚° ë¶„ì„ í”Œë«í¼ì˜ ì‹œìŠ¤í…œ ì•„í‚¤í…íŠ¸ì´ì ë°±ì—”ë“œ ì—”ì§€ë‹ˆì–´ë‹¤.

í˜„ì¬ ZeroSite M1(Land Information Module)ì€
ê³µê³µ API(V-World, Kakao, êµ­í† ë¶€ ë“±)ë¥¼ ì§ì ‘ í˜¸ì¶œí•˜ëŠ” êµ¬ì¡°ì´ë©°,
GitHub Pages / GitHub Actions í™˜ê²½ì—ì„œ
CORS, Referer, Origin ì°¨ë‹¨ìœ¼ë¡œ ì¸í•´ ì •ìƒ ì‘ë™í•˜ì§€ ì•ŠëŠ” ë¬¸ì œê°€ ë°œìƒí•˜ê³  ìˆë‹¤.

ì´ ë¬¸ì œë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´
ì•„ë˜ì˜ "í˜„ì‹¤ì ì¸ 3ë‹¨ê³„ ìš°íšŒ ì „ëµ"ì„ M1 êµ¬ì¡°ì— ë°˜ì˜í•˜ì—¬
M1ì„ ìˆ˜ì •Â·í™•ì¥í•˜ë¼.

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[ ìˆ˜ì • ëª©í‘œ ]
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
1. M1ì˜ STEP ê¸°ë°˜ UX êµ¬ì¡°ëŠ” ì ˆëŒ€ ë³€ê²½í•˜ì§€ ì•ŠëŠ”ë‹¤.
2. M1ì€ ì—¬ì „íˆ "FACT ìˆ˜ì§‘ â†’ ì‚¬ìš©ì ê²€ì¦ â†’ Context Freeze" ì—­í• ë§Œ ìˆ˜í–‰í•œë‹¤.
3. API ì°¨ë‹¨ ë¬¸ì œëŠ” "í˜¸ì¶œ ê²½ë¡œ" ë¬¸ì œë¡œ í•œì •í•˜ì—¬ í•´ê²°í•œë‹¤.
4. API ì‹¤íŒ¨ ì‹œì—ë„ M1 í”„ë¡œì„¸ìŠ¤ëŠ” ì¤‘ë‹¨ë˜ì§€ ì•ŠëŠ”ë‹¤.

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[ API ì°¨ë‹¨ ëŒ€ì‘ ì „ëµ ]
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

### ì „ëµ A. ì„œë²„ ì‚¬ì´ë“œ í˜¸ì¶œ ì‹œ Referer í—¤ë” ìœ„ì¡° (1ì°¨ ëŒ€ì‘)

- Python / Server-side API í˜¸ì¶œ ì‹œ,
  ëª¨ë“  ì™¸ë¶€ ê³µê³µ API ìš”ì²­ì— ë‹¤ìŒ í—¤ë”ë¥¼ ê¸°ë³¸ìœ¼ë¡œ ì¶”ê°€í•˜ë¼.

```python
headers = {
  "Referer": "http://localhost"
}
```

- V-World, í† ì§€ì´ìš©ê·œì œì •ë³´ì„œë¹„ìŠ¤ ë“±
  Referer ê¸°ë°˜ ê²€ì¦ APIì— ëŒ€í•´
  paramsì— `domain="http://localhost"`ë¥¼ í•¨ê»˜ í¬í•¨í•œë‹¤.

- ì´ ì „ëµì€ GitHub Actions, ë¡œì»¬ Python ì‹¤í–‰ í™˜ê²½ì„ ëŒ€ìƒìœ¼ë¡œ í•œë‹¤.

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
### ì „ëµ B. í”„ë¡ íŠ¸ì—”ë“œ ì§ì ‘ í˜¸ì¶œ ê¸ˆì§€ (ì›ì¹™)

- M1 í”„ë¡ íŠ¸ì—”ë“œ(JavaScript, React ë“±)ì—ì„œëŠ”
  ê³µê³µ APIë¥¼ ì§ì ‘ í˜¸ì¶œí•˜ì§€ ì•ŠëŠ”ë‹¤.
- ëª¨ë“  ì™¸ë¶€ API í˜¸ì¶œì€ ë°˜ë“œì‹œ ì„œë²„ ë˜ëŠ” í”„ë¡ì‹œë¥¼ í†µí•´ì„œë§Œ ìˆ˜í–‰í•œë‹¤.

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
### ì „ëµ C. Vercel Serverless Proxy ë„ì… (ê¶Œì¥, ê¸°ë³¸ê°’)

- GitHub ë ˆí¬ì§€í† ë¦¬ì— ë‹¤ìŒ êµ¬ì¡°ë¥¼ ì¶”ê°€í•œë‹¤.

```
/
 â”œâ”€ api/
 â”‚   â””â”€ proxy_vworld.py
 â”‚   â””â”€ proxy_kakao.py
 â”‚   â””â”€ proxy_publicdata.py
 â””â”€ frontend/
```

- ê° proxy íŒŒì¼ì€ ë‹¤ìŒ ì—­í• ì„ ìˆ˜í–‰í•œë‹¤.
  1. í´ë¼ì´ì–¸íŠ¸ë¡œë¶€í„° ìµœì†Œ íŒŒë¼ë¯¸í„°ë§Œ ë°›ëŠ”ë‹¤ (ex. pnu, address)
  2. ì„œë²„ì—ì„œ ì™¸ë¶€ ê³µê³µ APIë¡œ ìš”ì²­ì„ ì „ë‹¬í•œë‹¤
  3. Referer í—¤ë”ë¥¼ ê°•ì œë¡œ ì¶”ê°€í•œë‹¤
  4. ì‘ë‹µ ê²°ê³¼ë¥¼ ê·¸ëŒ€ë¡œ í´ë¼ì´ì–¸íŠ¸ì— ë°˜í™˜í•œë‹¤
  5. CORS í—ˆìš© í—¤ë”ë¥¼ í¬í•¨í•œë‹¤

- API KeyëŠ” í”„ë¡ì‹œ ì„œë²„ ë‚´ë¶€ì—ì„œë§Œ ì‚¬ìš©í•˜ë©°,
  í”„ë¡ íŠ¸ì—”ë“œë‚˜ GitHub Pagesì— ë…¸ì¶œí•˜ì§€ ì•ŠëŠ”ë‹¤.

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[ M1 STEPë³„ ì ìš© ì§€ì¹¨ ]
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

**STEP 1 (ì£¼ì†Œ â†’ ì¢Œí‘œ):**
- í”„ë¡ íŠ¸ì—”ë“œëŠ” `/api/proxy_kakao?address=...` ë¡œ ìš”ì²­
- `proxy_kakao`ëŠ” Kakao REST API í˜¸ì¶œ + Referer í—¤ë” ì¶”ê°€

**STEP 2 (ì§€ë²ˆÂ·í–‰ì •):**
- í”„ë¡ íŠ¸ì—”ë“œëŠ” `/api/proxy_vworld?pnu=...` ë¡œ ìš”ì²­
- `proxy_vworld`ëŠ” V-World ì§€ì  API í˜¸ì¶œ

**STEP 3 (ë²•ì Â·ì´ìš©):**
- í”„ë¡ íŠ¸ì—”ë“œëŠ” `/api/proxy_publicdata?type=land_use&pnu=...`
- `proxy_publicdata`ëŠ” í† ì§€ì´ìš©ê·œì œ / ê±´ì¶•ë¬¼ëŒ€ì¥ API í˜¸ì¶œ

**STEP 5 (ì‹œì¥Â·ê±°ë˜):**
- í”„ë¡ íŠ¸ì—”ë“œëŠ” `/api/proxy_publicdata?type=land_trade&...`
- `proxy_publicdata`ëŠ” êµ­í† ë¶€ ì‹¤ê±°ë˜ê°€ API í˜¸ì¶œ

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[ ì‹¤íŒ¨ ì²˜ë¦¬ ê·œì¹™ ]
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
- Proxy ì‹¤íŒ¨ ì‹œ:
  - M1 ìƒíƒœë¥¼ `*_READY_WITH_MISSING` ìœ¼ë¡œ ì„¤ì •
  - ì‚¬ìš©ì ìˆ˜ê¸° ì…ë ¥ UIë¥¼ í™œì„±í™”
- API ì‹¤íŒ¨ëŠ” M1 ì¤‘ë‹¨ ì‚¬ìœ ê°€ ì•„ë‹ˆë‹¤.

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[ ê²°ê³¼ë¬¼ ìš”êµ¬ ]
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
1. M1ì—ì„œ ì™¸ë¶€ APIë¥¼ ì§ì ‘ í˜¸ì¶œí•˜ë˜ êµ¬ì¡° ì œê±°
2. Proxy ê¸°ë°˜ í˜¸ì¶œ êµ¬ì¡°ë¡œ ì „í™˜
3. Referer í—¤ë” ìœ„ì¡° ë¡œì§ í¬í•¨
4. GitHub Pages / Actions / Vercel í™˜ê²½ì—ì„œ ëª¨ë‘ ë™ì‘ ê°€ëŠ¥
5. ê¸°ì¡´ LandInfoContext / Freeze êµ¬ì¡° ìœ ì§€

ì´ ê¸°ì¤€ì„ ì¶©ì¡±í•˜ë„ë¡
ZeroSite M1 API í˜¸ì¶œ êµ¬ì¡°ë¥¼ ìˆ˜ì •Â·ì™„ì„±í•˜ë¼.
```

---

## ğŸ¯ í”„ë¡¬í”„íŠ¸ì˜ í•µì‹¬ ê°€ì¹˜

### 1. **"API ì°¨ë‹¨ ë¬¸ì œ"ë¥¼ êµ¬ì¡° ë¬¸ì œë¡œ ê²©í•˜**
- M1ì˜ ë³¸ì§ˆ(FACT ìˆ˜ì§‘ â†’ ê²€ì¦ â†’ Freeze)ì€ ë¶ˆë³€
- ë¬¸ì œëŠ” ë‹¨ìˆœíˆ "APIì— ê°€ëŠ” ê²½ë¡œ"ì¼ ë¿

### 2. **M1 ê¸°íšÂ·UXÂ·ì² í•™ ì „í˜€ ì†ëŒ€ì§€ ì•ŠìŒ**
- STEP êµ¬ì¡° ìœ ì§€
- Context Freeze ì² í•™ ìœ ì§€
- ì‚¬ìš©ì ê²½í—˜ ë™ì¼

### 3. **GitHub â†’ Vercel â†’ ê³µê³µ API (ê°€ì¥ ì•ˆì „í•œ ì‹¤ë¬´ êµ¬ì¡°)**
```
[GitHub Pages]
      â†“
[Vercel Serverless Function]
      â†“ (Referer ìœ„ì¡°)
[ê³µê³µ API (V-World, Kakao, etc.)]
```

### 4. **ë‚˜ì¤‘ì— API ë°”ë€Œì–´ë„ Proxyë§Œ ìˆ˜ì •**
- M1 ì½”ë“œëŠ” ê±´ë“œë¦¬ì§€ ì•ŠìŒ
- Proxy íŒŒì¼ë§Œ ì—…ë°ì´íŠ¸
- í™•ì¥ì„±ê³¼ ìœ ì§€ë³´ìˆ˜ì„± í™•ë³´

---

## ğŸ”‘ í•œ ë¬¸ì¥ ìš”ì•½

> **"M1ì€ APIë¥¼ ë°”ê¾¸ì§€ ì•ŠëŠ”ë‹¤. APIì— ê°€ëŠ” ê¸¸(ê²½ë¡œ)ë§Œ ë°”ê¾¼ë‹¤."**

---

## ğŸ“Š ì•„í‚¤í…ì²˜ ë¹„êµ

### âŒ **ê¸°ì¡´ êµ¬ì¡° (ë¬¸ì œ)**
```
[M1 Frontend] â†’ [ì§ì ‘ í˜¸ì¶œ] â†’ [ê³µê³µ API]
                    â†‘
                CORS ì°¨ë‹¨
                Referer ì°¨ë‹¨
                Origin ì°¨ë‹¨
```

### âœ… **ìˆ˜ì • êµ¬ì¡° (í•´ê²°)**
```
[M1 Frontend] â†’ [Vercel Proxy] â†’ [ê³µê³µ API]
                      â†‘
                  Referer ìœ„ì¡°
                  CORS í—ˆìš©
                  API Key ì€ë‹‰
```

---

## ğŸ“ ì˜ˆìƒ íŒŒì¼ êµ¬ì¡°

```
ZeroSite/
â”œâ”€ api/                          # Vercel Serverless Functions
â”‚   â”œâ”€ proxy_kakao.py           # Kakao Local API Proxy
â”‚   â”œâ”€ proxy_vworld.py          # V-World API Proxy
â”‚   â””â”€ proxy_publicdata.py      # ê³µê³µë°ì´í„°í¬í„¸ Proxy
â”‚
â”œâ”€ frontend/
â”‚   â””â”€ src/
â”‚       â””â”€ services/
â”‚           â””â”€ m1.service.ts    # Proxy ì—”ë“œí¬ì¸íŠ¸ í˜¸ì¶œ
â”‚
â”œâ”€ app/                          # Backend (Optional, for local dev)
â”‚   â””â”€ api/
â”‚       â””â”€ endpoints/
â”‚           â””â”€ m1_proxy.py      # Local development proxy
â”‚
â””â”€ vercel.json                   # Vercel ë°°í¬ ì„¤ì •
```

---

## ğŸ”§ Vercel Proxy ì˜ˆì‹œ ì½”ë“œ

### `api/proxy_vworld.py`
```python
from flask import Flask, request, jsonify
import requests
import os

app = Flask(__name__)

@app.route('/api/proxy_vworld')
def proxy_vworld():
    pnu = request.args.get('pnu')
    api_key = os.environ.get('VWORLD_API_KEY')
    
    # V-World API í˜¸ì¶œ (Referer ìœ„ì¡°)
    response = requests.get(
        'http://api.vworld.kr/req/data',
        params={
            'key': api_key,
            'domain': 'http://localhost',
            'service': 'data',
            'request': 'GetFeature',
            'data': 'LP_PA_CBND_BUBUN',
            'attrFilter': f'pnu:=:{pnu}'
        },
        headers={
            'Referer': 'http://localhost'
        }
    )
    
    # CORS í—ˆìš© í—¤ë” ì¶”ê°€
    result = jsonify(response.json())
    result.headers.add('Access-Control-Allow-Origin', '*')
    return result
```

---

## ğŸ“ M1 Frontend ìˆ˜ì • ì˜ˆì‹œ

### `frontend/src/services/m1.service.ts`

```typescript
// âŒ ê¸°ì¡´ (ì§ì ‘ í˜¸ì¶œ)
const response = await fetch(
  `http://api.vworld.kr/req/data?key=${apiKey}&pnu=${pnu}`
);

// âœ… ìˆ˜ì • (Proxy í˜¸ì¶œ)
const response = await fetch(
  `/api/proxy_vworld?pnu=${pnu}`
);
```

---

## ğŸš€ ë°°í¬ ë° ì ìš© ìˆœì„œ

1. **Vercel í”„ë¡œì íŠ¸ ìƒì„±**
   - GitHub ë ˆí¬ì§€í† ë¦¬ ì—°ê²°
   - API Keyë¥¼ Environment Variablesì— ë“±ë¡

2. **Proxy íŒŒì¼ ì‘ì„±**
   - `api/proxy_kakao.py`
   - `api/proxy_vworld.py`
   - `api/proxy_publicdata.py`

3. **M1 Frontend ìˆ˜ì •**
   - ì§ì ‘ API í˜¸ì¶œ â†’ Proxy í˜¸ì¶œë¡œ ë³€ê²½

4. **í…ŒìŠ¤íŠ¸**
   - Local: `vercel dev`
   - Production: `vercel --prod`

5. **GitHub Pages ë°°í¬**
   - FrontendëŠ” GitHub Pages
   - APIëŠ” Vercel
   - ì™„ë²½í•œ ë¶„ë¦¬

---

## âš ï¸ ì£¼ì˜ì‚¬í•­

### 1. **API Key ë…¸ì¶œ ê¸ˆì§€**
- ì ˆëŒ€ í”„ë¡ íŠ¸ì—”ë“œë‚˜ GitHubì— API Key ì»¤ë°‹í•˜ì§€ ë§ ê²ƒ
- Vercel Environment Variables ì‚¬ìš©

### 2. **Proxy Rate Limiting**
- Vercel ServerlessëŠ” ìš”ì²­ ì œí•œ ìˆìŒ
- ë‚¨ìš© ë°©ì§€ ë¡œì§ ì¶”ê°€ ê¶Œì¥

### 3. **ì—ëŸ¬ ì²˜ë¦¬**
- Proxy ì‹¤íŒ¨ ì‹œ M1ì´ ì¤‘ë‹¨ë˜ì§€ ì•Šë„ë¡
- `*_READY_WITH_MISSING` ìƒíƒœë¡œ ì „í™˜
- ì‚¬ìš©ì ìˆ˜ê¸° ì…ë ¥ UI í™œì„±í™”

---

## ğŸ“ˆ ê¸°ëŒ€ íš¨ê³¼

### âœ… **ì¦‰ì‹œ íš¨ê³¼**
- GitHub Pages/Actions í™˜ê²½ì—ì„œ ê³µê³µ API ì •ìƒ í˜¸ì¶œ
- CORS, Referer, Origin ì°¨ë‹¨ ì™„ì „ ìš°íšŒ
- API Key ë³´ì•ˆ í™•ë³´

### âœ… **ì¥ê¸° íš¨ê³¼**
- M1 êµ¬ì¡° ë³´ì¡´ìœ¼ë¡œ ìœ ì§€ë³´ìˆ˜ ìš©ì´
- API ë³€ê²½ ì‹œ Proxyë§Œ ìˆ˜ì •
- í™•ì¥ì„± í™•ë³´ (ìƒˆ API ì¶”ê°€ ê°„ë‹¨)

---

## ğŸ“ í•µì‹¬ êµí›ˆ

### **"ì•„í‚¤í…ì²˜ëŠ” ë³¸ì§ˆì„ ê±´ë“œë¦¬ì§€ ì•ŠëŠ”ë‹¤"**

ì´ í”„ë¡¬í”„íŠ¸ê°€ ì™„ë²½í•œ ì´ìœ :
1. **M1ì˜ ë³¸ì§ˆ(FACT ìˆ˜ì§‘)ì€ ë¶ˆë³€**
2. **ë¬¸ì œë¥¼ "ê²½ë¡œ" ë¬¸ì œë¡œ êµ­í•œ**
3. **ì‹¤ë¬´ì—ì„œ ê²€ì¦ëœ Proxy íŒ¨í„´ ì‚¬ìš©**
4. **í™•ì¥ ê°€ëŠ¥í•˜ê³  ìœ ì§€ë³´ìˆ˜ ì‰¬ìš´ êµ¬ì¡°**

---

## ğŸ“š ê´€ë ¨ ë¬¸ì„œ

- `/docs/M1_ARCHITECTURE.md` - M1 ì „ì²´ êµ¬ì¡°
- `/docs/API_KEY_BLOCKING_SOLUTION_2025-12-18.md` - API ì°¨ë‹¨ ë¬¸ì œ ë¶„ì„
- `/docs/BLUE_SCREEN_FINAL_SOLUTION_2025-12-18.md` - íŒŒë€í™”ë©´ ë©ˆì¶¤ í•´ê²°

---

**ì‘ì„±ì**: ZeroSite Development Team  
**ìµœì¢… ì—…ë°ì´íŠ¸**: 2025-12-18 16:45 KST  
**ìƒíƒœ**: âœ… í”„ë¡œë•ì…˜ ì ìš© ì¤€ë¹„ ì™„ë£Œ
