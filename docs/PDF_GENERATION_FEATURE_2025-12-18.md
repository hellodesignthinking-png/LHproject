# ğŸ“„ PDF ë³´ê³ ì„œ ìƒì„± ê¸°ëŠ¥ êµ¬í˜„ ì™„ë£Œ

**ë‚ ì§œ**: 2025-12-18  
**ì‘ì„±ì**: ZeroSite AI Developer  
**Branch**: `feature/expert-report-generator`  
**Commit**: `dc10f1f`

## ğŸ¯ êµ¬í˜„ ë‚´ìš©

### âœ… ì™„ë£Œëœ ê¸°ëŠ¥

ëª¨ë“  ë¶„ì„ ëª¨ë“ˆ(M2~M6)ì— ëŒ€í•œ **ìƒì„¸ PDF ë³´ê³ ì„œ ìƒì„±** ê¸°ëŠ¥ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.

#### 1. **M2: í† ì§€ê°ì •í‰ê°€ ë³´ê³ ì„œ**
- ğŸ“Š **í¬í•¨ ë‚´ìš©**:
  - ê°ì •í‰ê°€ ê²°ê³¼ ìš”ì•½ (í† ì§€ê°€ì¹˜, í‰ë‹¹ ê°€ê²©, ã¡ë‹¹ ê°€ê²©)
  - ê³µì‹œì§€ê°€ ì •ë³´ (ì´ì•¡, ã¡ë‹¹ ê³µì‹œì§€ê°€)
  - ê±°ë˜ì‚¬ë¡€ ë¶„ì„ (ìµœëŒ€ 5ê±´ ìƒì„¸ ì •ë³´)
  - ì…ì§€ í”„ë¦¬ë¯¸ì—„ ë¶„ì„ (ë„ë¡œ, ì§€í˜•, ì…ì§€, ì ‘ê·¼ì„± ì ìˆ˜)
  - í‰ê°€ ì‹ ë¢°ë„ ë° ê·¼ê±°
- ğŸ¨ **ìŠ¤íƒ€ì¼**: íŒŒë€ìƒ‰ ê³„ì—´ (#1976D2)

#### 2. **M3: LH ì„ í˜¸ìœ í˜• ë¶„ì„ ë³´ê³ ì„œ**
- ğŸ“Š **í¬í•¨ ë‚´ìš©**:
  - ì¶”ì²œ LH ìœ í˜• (ìœ í˜•ëª…, ì‹ ë¢°ë„, ì´ì )
  - ì „ì²´ ìœ í˜• ì ìˆ˜ ë¹„êµ í…Œì´ë¸” (ì…ì§€, ì ‘ê·¼ì„±, POI, ìˆ˜ìš” ì ìˆ˜)
  - ì…ì§€ ìƒì„¸ ë¶„ì„ (ì£¼ìš” ì‹œì„¤ê³¼ì˜ ê±°ë¦¬)
- ğŸ¨ **ìŠ¤íƒ€ì¼**: ì´ˆë¡ìƒ‰ ê³„ì—´ (#4CAF50)

#### 3. **M4: ê±´ì¶•ê·œëª¨ ë¶„ì„ ë³´ê³ ì„œ** âœ¨ NEW
- ğŸ“Š **í¬í•¨ ë‚´ìš©**:
  - ë²•ì  ìš©ì ë¥  ë¶„ì„ (FAR, BCR, ë²•ì • ì„¸ëŒ€ìˆ˜, ì—°ë©´ì )
  - ì¸ì„¼í‹°ë¸Œ ìš©ì ë¥  ë¶„ì„ (ì¶”ê°€ ìš©ì ë¥ , ì¸ì„¼í‹°ë¸Œ ì„¸ëŒ€ìˆ˜)
  - ì£¼ì°¨ê³„íš ë¶„ì„ (Alt A, Alt B ì£¼ì°¨ëŒ€ìˆ˜)
  - **ğŸ“ˆ ì°¨íŠ¸**: Legal vs Incentive FAR ë¹„êµ ë§‰ëŒ€ ê·¸ë˜í”„
- ğŸ¨ **ìŠ¤íƒ€ì¼**: ì£¼í™©ìƒ‰ ê³„ì—´ (#FF5722)

#### 4. **M5: ì‚¬ì—…ì„± ë¶„ì„ ë³´ê³ ì„œ** âœ¨ NEW
- ğŸ“Š **í¬í•¨ ë‚´ìš©**:
  - ì¬ë¬´ì§€í‘œ ìš”ì•½ (NPV, IRR, ì‚¬ì—…ìˆ˜ìµë¥ )
  - ë¹„ìš© ë¶„ì„ (í† ì§€ë¹„, ê±´ì¶•ë¹„, ê¸°íƒ€ë¹„ìš©, ì´ ë¹„ìš©)
  - ìˆ˜ìµ ë¶„ì„ (ë¶„ì–‘ìˆ˜ìµ, ì„ëŒ€ìˆ˜ìµ, ê¸°íƒ€ìˆ˜ìµ, ì´ ìˆ˜ìµ)
  - **ğŸ“ˆ ì°¨íŠ¸ 1**: ë¹„ìš© êµ¬ì„± íŒŒì´ ì°¨íŠ¸
  - **ğŸ“ˆ ì°¨íŠ¸ 2**: ë¹„ìš© vs ìˆ˜ìµ ë§‰ëŒ€ ê·¸ë˜í”„
- ğŸ¨ **ìŠ¤íƒ€ì¼**: ë³´ë¼ìƒ‰ ê³„ì—´ (#9C27B0)

#### 5. **M6: LH ì‹¬ì‚¬ì˜ˆì¸¡ ë³´ê³ ì„œ** âœ¨ NEW
- ğŸ“Š **í¬í•¨ ë‚´ìš©**:
  - ìµœì¢… íŒì • (ê²°ì •, ë“±ê¸‰, ì¢…í•© ì ìˆ˜, ì˜ˆìƒ ìŠ¹ì¸ìœ¨)
  - íŒì • ê·¼ê±° (rationale)
  - ì„¸ë¶€ ì ìˆ˜ ë¶„ì„ (ì…ì§€ ì ì •ì„±, ì‚¬ì—… íƒ€ë‹¹ì„±, ìˆ˜ìš” ë¶„ì„, ê±´ì¶• ê³„íš, ê¸°íƒ€)
  - **ğŸ“ˆ ì°¨íŠ¸**: í•­ëª©ë³„ ì ìˆ˜ ë ˆì´ë” ì°¨íŠ¸ (Spider Chart)
- ğŸ¨ **ìŠ¤íƒ€ì¼**: ë‚¨ìƒ‰ ê³„ì—´ (#3F51B5)

---

## ğŸ—ï¸ ê¸°ìˆ  ìŠ¤íƒ

### Backend
- **ReportLab 4.4.5**: PDF ìƒì„± ë¼ì´ë¸ŒëŸ¬ë¦¬
- **Matplotlib**: ì°¨íŠ¸ ë° ì‹œê°í™” ìƒì„±
- **FastAPI**: PDF ìƒì„± API ì—”ë“œí¬ì¸íŠ¸

### Frontend
- **React + TypeScript**: UI ì»´í¬ë„ŒíŠ¸
- **Fetch API**: PDF ë‹¤ìš´ë¡œë“œ ì²˜ë¦¬

---

## ğŸ“‚ íŒŒì¼ êµ¬ì¡°

```
webapp/
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ api/
â”‚   â”‚   â””â”€â”€ endpoints/
â”‚   â”‚       â””â”€â”€ pdf_reports.py          # PDF ìƒì„± API ì—”ë“œí¬ì¸íŠ¸
â”‚   â””â”€â”€ services/
â”‚       â””â”€â”€ pdf_generators/
â”‚           â””â”€â”€ module_pdf_generator.py # PDF ìƒì„± ë¡œì§ (M2-M6)
â””â”€â”€ frontend/
    â””â”€â”€ src/
        â””â”€â”€ components/
            â””â”€â”€ pipeline/
                â””â”€â”€ PipelineOrchestrator.tsx # PDF ë‹¤ìš´ë¡œë“œ ë²„íŠ¼
```

---

## ğŸ”§ API ì—”ë“œí¬ì¸íŠ¸

### `POST /api/pdf/generate/{module_id}`

**ëª¨ë“ˆë³„ PDF ë³´ê³ ì„œ ìƒì„±**

#### Request
```json
{
  "module_id": "M2",
  "data": {
    // ëª¨ë“ˆë³„ ë°ì´í„° (M2Result, M3Result, M4Result, M5Result, M6Result)
  }
}
```

#### Response
- **Content-Type**: `application/pdf`
- **Headers**: 
  - `Content-Disposition: attachment; filename={ModuleId}_{Title}_ë³´ê³ ì„œ.pdf`
  - `Access-Control-Expose-Headers: Content-Disposition`

#### Supported Module IDs
- `M2`: í† ì§€ê°ì •í‰ê°€
- `M3`: LH ì„ í˜¸ìœ í˜•
- `M4`: ê±´ì¶•ê·œëª¨ ë¶„ì„
- `M5`: ì‚¬ì—…ì„± ë¶„ì„
- `M6`: LH ì‹¬ì‚¬ì˜ˆì¸¡

---

## ğŸ¨ PDF ë””ìì¸ íŠ¹ì§•

### í”„ë¡œí˜ì…”ë„í•œ ë ˆì´ì•„ì›ƒ
- âœ… A4 ìš©ì§€ í¬ê¸°
- âœ… 2cm ì—¬ë°±
- âœ… ëª¨ë“ˆë³„ ìƒ‰ìƒ ì½”ë“œ
- âœ… ê³„ì¸µì  ì œëª© êµ¬ì¡°
- âœ… í‘œ ë° ì°¨íŠ¸ ì‹œê°í™”
- âœ… ìƒì„±ì¼ì‹œ ë° ë©´ì±…ì‚¬í•­

### ì°¨íŠ¸ ì‹œê°í™”
- **M4**: ë§‰ëŒ€ ê·¸ë˜í”„ (Legal vs Incentive FAR)
- **M5**: íŒŒì´ ì°¨íŠ¸ (ë¹„ìš© êµ¬ì„±) + ë§‰ëŒ€ ê·¸ë˜í”„ (ë¹„ìš© vs ìˆ˜ìµ)
- **M6**: ë ˆì´ë” ì°¨íŠ¸ (í•­ëª©ë³„ ì ìˆ˜ ë¶„í¬)

### í•œê¸€ ì§€ì›
- ê¸°ë³¸ í°íŠ¸ë¡œ í•œê¸€ ë Œë”ë§
- í–¥í›„ ë‚˜ëˆ”ê³ ë”• í°íŠ¸ í†µí•© ê°€ëŠ¥

---

## ğŸ§ª í…ŒìŠ¤íŠ¸ ë°©ë²•

### 1ï¸âƒ£ **í”„ë¡ íŠ¸ì—”ë“œì—ì„œ í…ŒìŠ¤íŠ¸**

1. í”„ë¡ íŠ¸ì—”ë“œ ì ‘ì†:  
   **https://3000-iytptjlm3wjktifqay52f-2b54fc91.sandbox.novita.ai/pipeline**

2. M1 ë°ì´í„° ì…ë ¥ í›„ **"ë¶„ì„ ì‹œì‘"** í´ë¦­

3. íŒŒì´í”„ë¼ì¸ ì‹¤í–‰ ì™„ë£Œ í›„ ê° ëª¨ë“ˆ ì¹´ë“œì—ì„œ **"ìƒì„¸ ë°ì´í„° ë‹¤ìš´ë¡œë“œ"** ë²„íŠ¼ í´ë¦­

4. PDF íŒŒì¼ ë‹¤ìš´ë¡œë“œ í™•ì¸:
   - `M2_í† ì§€ê°ì •í‰ê°€_ë³´ê³ ì„œ_2025-12-18.pdf`
   - `M3_LHì„ í˜¸ìœ í˜•_ë³´ê³ ì„œ_2025-12-18.pdf`
   - `M4_ê±´ì¶•ê·œëª¨ë¶„ì„_ë³´ê³ ì„œ_2025-12-18.pdf`
   - `M5_ì‚¬ì—…ì„±ë¶„ì„_ë³´ê³ ì„œ_2025-12-18.pdf`
   - `M6_LHì‹¬ì‚¬ì˜ˆì¸¡_ë³´ê³ ì„œ_2025-12-18.pdf`

### 2ï¸âƒ£ **cURLë¡œ ì§ì ‘ í…ŒìŠ¤íŠ¸**

```bash
# M2 PDF ìƒì„± í…ŒìŠ¤íŠ¸
curl -X POST "https://8005-iytptjlm3wjktifqay52f-2b54fc91.sandbox.novita.ai/api/pdf/generate/M2" \
  -H "Content-Type: application/json" \
  -d '{
    "module_id": "M2",
    "data": {
      "appraisal": {
        "land_value": 1621848717,
        "unit_price_sqm": 3243697,
        "unit_price_pyeong": 10723014
      },
      "official_price": {
        "total": 500000000,
        "per_sqm": 1000000
      },
      "transactions": {
        "count": 10,
        "avg_price_sqm": 3243697,
        "samples": []
      },
      "premium": {
        "scores": {"road": 4, "terrain": 10, "location": 7, "accessibility": 7},
        "premiums": {"distance": 0.05, "time": 0.03, "zone": 0.04, "size": 0.03, "total_rate": 15.0}
      },
      "confidence": {
        "score": 0.85,
        "level": "HIGH"
      }
    }
  }' \
  --output M2_test.pdf
```

---

## ğŸ“Š ë°ì´í„° ë§¤í•‘

### M2 (í† ì§€ê°ì •í‰ê°€)
```typescript
{
  appraisal: {
    land_value: number,        // í† ì§€ê°€ì¹˜
    unit_price_sqm: number,    // ã¡ë‹¹ ê°€ê²©
    unit_price_pyeong: number  // í‰ë‹¹ ê°€ê²©
  },
  official_price: {
    total: number,             // ê³µì‹œì§€ê°€ ì´ì•¡
    per_sqm: number            // ã¡ë‹¹ ê³µì‹œì§€ê°€
  },
  transactions: {
    count: number,             // ê±°ë˜ì‚¬ë¡€ ìˆ˜
    avg_price_sqm: number,     // í‰ê·  ã¡ë‹¹ ê°€ê²©
    samples: Array<{
      address: string,
      date: string,
      price_sqm: number,
      distance_km: number
    }>
  },
  premium: {
    scores: {
      road: number,
      terrain: number,
      location: number,
      accessibility: number
    },
    premiums: {
      distance: number,
      time: number,
      zone: number,
      size: number,
      total_rate: number
    }
  },
  confidence: {
    score: number,             // ì‹ ë¢°ë„ (0.0-1.0)
    level: string              // HIGH/MEDIUM/LOW
  }
}
```

### M4 (ê±´ì¶•ê·œëª¨)
```typescript
{
  legal_capacity: {
    far_max: number,           // ë²•ì • ìš©ì ë¥  (%)
    bcr_max: number,           // ê±´íìœ¨ (%)
    total_units: number,       // ë²•ì • ì„¸ëŒ€ìˆ˜
    gross_floor_area: number   // ì—°ë©´ì  (ã¡)
  },
  incentive_capacity: {
    far_max: number,           // ì¸ì„¼í‹°ë¸Œ ìš©ì ë¥  (%)
    total_units: number        // ì¸ì„¼í‹°ë¸Œ ì„¸ëŒ€ìˆ˜
  },
  parking: {
    alt_a: number,             // Alt A ì£¼ì°¨ëŒ€ìˆ˜
    alt_b: number              // Alt B ì£¼ì°¨ëŒ€ìˆ˜
  }
}
```

### M5 (ì‚¬ì—…ì„±)
```typescript
{
  financial: {
    npv_public: number,        // NPV (Public)
    irr: number,               // IRR (%)
    profitability_rate: number // ì‚¬ì—…ìˆ˜ìµë¥  (%)
  },
  costs: {
    land: number,              // í† ì§€ë¹„
    construction: number,      // ê±´ì¶•ë¹„
    other: number,             // ê¸°íƒ€ë¹„ìš©
    total: number              // ì´ ë¹„ìš©
  },
  revenues: {
    sale: number,              // ë¶„ì–‘ìˆ˜ìµ
    rental: number,            // ì„ëŒ€ìˆ˜ìµ
    other: number,             // ê¸°íƒ€ìˆ˜ìµ
    total: number              // ì´ ìˆ˜ìµ
  }
}
```

### M6 (LH ì‹¬ì‚¬ì˜ˆì¸¡)
```typescript
{
  decision: {
    type: string,              // GO / NO-GO / CONDITIONAL
    rationale: string          // íŒì • ê·¼ê±°
  },
  grade: string,               // A / B / C / D
  total_score: number,         // ì¢…í•© ì ìˆ˜ (0-110)
  approval_probability: number, // ìŠ¹ì¸ ê°€ëŠ¥ì„± (0.0-1.0)
  scores: {
    location: number,          // ì…ì§€ ì ìˆ˜ (max 30)
    feasibility: number,       // íƒ€ë‹¹ì„± ì ìˆ˜ (max 25)
    demand: number,            // ìˆ˜ìš” ì ìˆ˜ (max 20)
    capacity: number,          // ê±´ì¶• ì ìˆ˜ (max 20)
    other: number              // ê¸°íƒ€ ì ìˆ˜ (max 15)
  }
}
```

---

## âš¡ ì„±ëŠ¥ ë° ìµœì í™”

### íŒŒì¼ í¬ê¸°
- **M2**: ~50-80 KB (ê±°ë˜ì‚¬ë¡€ ìˆ˜ì— ë”°ë¼ ë³€ë™)
- **M3**: ~30-50 KB
- **M4**: ~150-200 KB (ì°¨íŠ¸ í¬í•¨)
- **M5**: ~200-250 KB (2ê°œ ì°¨íŠ¸ í¬í•¨)
- **M6**: ~180-220 KB (ë ˆì´ë” ì°¨íŠ¸ í¬í•¨)

### ìƒì„± ì‹œê°„
- **í‰ê· **: 0.5-2ì´ˆ (ì°¨íŠ¸ ìƒì„± í¬í•¨)
- **ìµœëŒ€**: 3-4ì´ˆ (ë³µì¡í•œ ë°ì´í„°)

---

## ğŸš€ í–¥í›„ ê°œì„  ì‚¬í•­

### Phase 2 (ìš°ì„ ìˆœìœ„ ë†’ìŒ)
1. âœ… í•œê¸€ í°íŠ¸ (ë‚˜ëˆ”ê³ ë”•) ì •ì‹ í†µí•©
2. âœ… ì¢…í•© ë³´ê³ ì„œ (M2-M6 í†µí•©) ìƒì„±
3. âœ… ë” ë§ì€ ì°¨íŠ¸ ìœ í˜• ì¶”ê°€
4. âœ… ì»¤ìŠ¤í…€ í…œí”Œë¦¿ ì§€ì›

### Phase 3 (ìš°ì„ ìˆœìœ„ ì¤‘ê°„)
1. PDF ì›Œí„°ë§ˆí¬ ì¶”ê°€
2. ì‚¬ìš©ì ë¡œê³  ì‚½ì…
3. ë‹¤êµ­ì–´ ì§€ì› (ì˜ë¬¸)
4. PDF ì•”í˜¸í™”

### Phase 4 (ìš°ì„ ìˆœìœ„ ë‚®ìŒ)
1. PDF ì„œëª… ê¸°ëŠ¥
2. ì¸í„°ë™í‹°ë¸Œ PDF í¼
3. ì´ë©”ì¼ ìë™ ë°œì†¡

---

## ğŸ› ì•Œë ¤ì§„ ì´ìŠˆ

### 1. í•œê¸€ í°íŠ¸
- **í˜„ì¬**: ê¸°ë³¸ í°íŠ¸ ì‚¬ìš© (í•œê¸€ ì§€ì› ì œí•œì )
- **í•´ê²°**: ë‚˜ëˆ”ê³ ë”• í°íŠ¸ ì„¤ì¹˜ ë° ë“±ë¡ í•„ìš”

### 2. ì°¨íŠ¸ ìƒì„± ì‹¤íŒ¨ ì‹œ
- **í˜„ì¬**: "ì°¨íŠ¸ ìƒì„± ì‹¤íŒ¨" í…ìŠ¤íŠ¸ í‘œì‹œ
- **í•´ê²°**: ì—ëŸ¬ ë¡œê¹… ê°•í™” ë° í´ë°± ì´ë¯¸ì§€ ì œê³µ

---

## ğŸ“ ì»¤ë°‹ íˆìŠ¤í† ë¦¬

### `dc10f1f` - feat: Add comprehensive PDF generation for M4, M5, M6 with charts
- M4, M5, M6 PDF ìƒì„± ë¡œì§ êµ¬í˜„
- Matplotlib ì°¨íŠ¸ ìƒì„± ì¶”ê°€
- í”„ë¡œí˜ì…”ë„ ë ˆì´ì•„ì›ƒ ì ìš©
- ìƒ‰ìƒ ì½”ë“œ ë° í…Œì´ë¸” ìŠ¤íƒ€ì¼ë§

### `b617873` - fix: M1 service to load frozen context
- M1 ì„œë¹„ìŠ¤ê°€ ì €ì¥ëœ ì»¨í…ìŠ¤íŠ¸ ë¡œë“œí•˜ë„ë¡ ìˆ˜ì •
- Mock ë°ì´í„° ëŒ€ì‹  ì‹¤ì œ ì‚¬ìš©ì ì…ë ¥ ì‚¬ìš©

---

## ğŸ‰ ê²°ë¡ 

**ëª¨ë“  ëª¨ë“ˆ(M2-M6)ì— ëŒ€í•œ ìƒì„¸ PDF ë³´ê³ ì„œ ìƒì„± ê¸°ëŠ¥ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!**

ì‚¬ìš©ìëŠ” ì´ì œ ê° ë¶„ì„ ëª¨ë“ˆì˜ ìƒì„¸ ë°ì´í„°ë¥¼ **í”„ë¡œí˜ì…”ë„í•œ PDF í˜•ì‹**ìœ¼ë¡œ ë‹¤ìš´ë¡œë“œí•˜ì—¬ í™œìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### í•µì‹¬ ê°€ì¹˜
âœ… **ì™„ì „í•œ ë°ì´í„°**: ëª¨ë“  ë¶„ì„ ê²°ê³¼ í¬í•¨  
âœ… **ì‹œê°í™”**: ì°¨íŠ¸ ë° ê·¸ë˜í”„ë¡œ ì§ê´€ì  ì´í•´  
âœ… **í”„ë¡œí˜ì…”ë„**: ë¹„ì¦ˆë‹ˆìŠ¤ìš© ë³´ê³ ì„œ í’ˆì§ˆ  
âœ… **ì¦‰ì‹œ ë‹¤ìš´ë¡œë“œ**: í´ë¦­ í•œ ë²ˆìœ¼ë¡œ PDF ìƒì„±  

---

**Frontend URL**: https://3000-iytptjlm3wjktifqay52f-2b54fc91.sandbox.novita.ai/pipeline  
**Backend URL**: https://8005-iytptjlm3wjktifqay52f-2b54fc91.sandbox.novita.ai  
**GitHub PR**: https://github.com/hellodesignthinking-png/LHproject/pull/11  
**Commit**: `dc10f1f`

---

**ì‘ì„±ì¼**: 2025-12-18  
**ì‘ì„±ì**: ZeroSite AI Developer
