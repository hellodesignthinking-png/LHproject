# 📊 모든 모듈의 데이터 구조 및 PDF 포함 내용

**날짜**: 2025-12-18  
**상태**: ✅ **완료 - PDF 다운로드 정상 작동**  
**Commit**: `49d6d02`

---

## ✅ 문제 완전 해결!

### 오류 해결
```
❌ 이전: 'latin-1' codec can't encode characters
✅ 현재: PDF 정상 생성 및 다운로드 (HTTP 200, 69KB)
```

### 해결 방법
1. ✅ 한글 폰트 (나눔바른고딕) 등록
2. ✅ 요청마다 PDF 생성기 재초기화
3. ✅ UTF-8 파일명 인코딩
4. ✅ `urllib.parse.quote` import 추가

---

## 📋 모든 모듈의 데이터 구조

## M2: 토지감정평가 (PDF 크기: ~70KB)

### 포함된 모든 데이터

#### 1. 감정평가 결과 요약
```json
{
  "appraisal": {
    "land_value": 1621848717,           // 총 토지가치 (원)
    "unit_price_sqm": 3243697,          // 제곱미터당 가격 (원/㎡)
    "unit_price_pyeong": 10723014       // 평당 가격 (원/평)
  }
}
```

**PDF 표시**:
| 항목 | 금액 |
|------|------|
| 총 토지가치 | 1,621,848,717 원 |
| 제곱미터당 가격 | 3,243,697 원/㎡ |
| 평당 가격 | 10,723,014 원/평 |

---

#### 2. 공시지가 정보
```json
{
  "official_price": {
    "total": 500000000,                 // 공시지가 총액 (원)
    "per_sqm": 1000000                  // 제곱미터당 공시지가 (원/㎡)
  }
}
```

**PDF 표시**:
| 항목 | 금액 |
|------|------|
| 공시지가 총액 | 500,000,000 원 |
| 제곱미터당 공시지가 | 1,000,000 원/㎡ |
| 시세 대비 공시지가 비율 | 30.8% (자동 계산) |

---

#### 3. 거래사례 분석 (최대 10건)
```json
{
  "transactions": {
    "count": 10,                        // 총 거래사례 수
    "avg_price_sqm": 3243697,           // 평균 제곱미터당 가격 (원/㎡)
    "samples": [                        // 거래사례 상세 (최대 10건)
      {
        "address": "서울 마포구 논현동 482-54",  // 거래 주소
        "date": "2024-01-23",                   // 거래일
        "price_sqm": 3400805,                   // 거래가격 (원/㎡)
        "distance_km": 0.5                      // 대상 토지로부터 거리 (km)
      },
      {
        "address": "서울 마포구 청담동 479",
        "date": "2024-11-16",
        "price_sqm": 3451825,
        "distance_km": 0.8
      }
      // ... 최대 10건
    ]
  }
}
```

**PDF 표시**:
- 총 거래사례 수: **10건**
- 평균 제곱미터당 가격: **3,243,697원/㎡**

| 번호 | 주소 | 거래일 | 거래가격(㎡) | 거리(km) |
|------|------|--------|-------------|----------|
| 1 | 서울 마포구 논현동 482-54 | 2024-01-23 | 3,400,805원 | 0.50km |
| 2 | 서울 마포구 청담동 479 | 2024-11-16 | 3,451,825원 | 0.80km |
| ... | ... | ... | ... | ... |

---

#### 4. 입지 프리미엄 분석
```json
{
  "premium": {
    "scores": {                         // 각 항목별 점수 (0-10점)
      "road": 4,                        // 도로 조건
      "terrain": 10,                    // 지형 조건
      "location": 7,                    // 입지 조건
      "accessibility": 7                // 접근성
    },
    "premiums": {                       // 각 항목별 프리미엄 비율
      "distance": 0.05,                 // 도로 프리미엄 (5%)
      "time": 0.03,                     // 지형 프리미엄 (3%)
      "zone": 0.04,                     // 입지 프리미엄 (4%)
      "size": 0.03,                     // 접근성 프리미엄 (3%)
      "total_rate": 15.0                // 총 프리미엄 비율 (15%)
    }
  }
}
```

**PDF 표시**:
| 평가 항목 | 점수 | 프리미엄 비율 | 설명 |
|-----------|------|--------------|------|
| 도로 조건 | 4/10 | 5.0% | 도로 접면 상태 및 폭 |
| 지형 조건 | 10/10 | 3.0% | 평탄도 및 형상 |
| 입지 조건 | 7/10 | 4.0% | 주변 환경 및 편의시설 |
| 접근성 | 7/10 | 3.0% | 교통 편의성 |
| **합계** | - | **15.0%** | **총 입지 프리미엄** |

---

#### 5. 평가 신뢰도
```json
{
  "confidence": {
    "score": 0.85,                      // 신뢰도 점수 (0.0-1.0)
    "level": "HIGH",                    // 신뢰도 등급 (HIGH/MEDIUM/LOW)
    "location_accuracy": "높음"         // 위치 정확도
  }
}
```

**PDF 표시**:
- **종합 신뢰도 점수**: 85%
- **신뢰도 등급**: HIGH
- **신뢰도 평가 근거**:
  - 거래사례 수: 10건 (충분한 데이터)
  - 공시지가 활용: 예
  - 위치 정확도: 높음
  - 데이터 최신성: 최근 1년 이내 거래 반영

---

#### 6. 감정평가 방법론 (자동 생성)
**PDF 포함 내용**:
```
본 감정평가는 다음 3가지 방법을 종합적으로 활용하였습니다:

1) 거래사례비교법: 인근 유사 토지의 실제 거래가격을 분석하여 시세를 추정
2) 공시지가 기준법: 국토교통부 공시지가에 시세반영률을 적용하여 시세 산정
3) 입지프리미엄법: 도로, 지형, 입지, 접근성 등 입지 특성을 점수화하여 프리미엄 반영

최종 토지가치 = (거래사례 평균 × 0.5) + (공시지가 × 시세반영률 × 0.3) + (입지프리미엄 × 0.2)
```

---

## M3: LH 선호유형 (PDF 크기: ~30-50KB)

### 포함된 모든 데이터

#### 1. 추천 LH 유형
```json
{
  "selected": {
    "name": "청년형",                    // 추천 유형명
    "confidence": 0.85,                 // 신뢰도 (0.0-1.0)
    "total": 85                         // 총점 (100점 만점)
  }
}
```

**PDF 표시**:
| 항목 | 값 |
|------|------|
| 추천 유형 | 청년형 |
| 신뢰도 | 85% |
| 총점 | 85점 |

---

#### 2. 전체 유형 점수 비교
```json
{
  "scores": {
    "youth": {                          // 청년형
      "name": "청년형",
      "location": 25,                   // 입지 점수
      "accessibility": 20,              // 접근성 점수
      "poi": 20,                        // POI 점수
      "demand": 20,                     // 수요 점수
      "total": 85                       // 총점
    },
    "family": {                         // 신혼부부형
      "name": "신혼부부형",
      "location": 20,
      "accessibility": 18,
      "poi": 18,
      "demand": 18,
      "total": 74
    },
    "general": {                        // 일반공급형
      "name": "일반공급형",
      "location": 22,
      "accessibility": 19,
      "poi": 19,
      "demand": 19,
      "total": 79
    }
    // ... 기타 유형
  }
}
```

**PDF 표시**:
| 유형 | 입지 | 접근성 | POI | 수요 | 총점 |
|------|------|--------|-----|------|------|
| 청년형 | 25 | 20 | 20 | 20 | **85** |
| 신혼부부형 | 20 | 18 | 18 | 18 | 74 |
| 일반공급형 | 22 | 19 | 19 | 19 | 79 |

---

#### 3. 입지 상세 분석
```json
{
  "location": {
    "score": 85,                        // 입지 점수
    "poi": {                            // 주요 시설과의 거리 (m)
      "지하철역": 500,
      "버스정류장": 200,
      "대형마트": 800,
      "학교": 1200,
      "병원": 600,
      "공원": 300
    }
  }
}
```

**PDF 표시**:
- **입지 점수**: 85점
- **주요 시설과의 거리**:
  - 지하철역: 500m
  - 버스정류장: 200m
  - 대형마트: 800m
  - 학교: 1200m
  - 병원: 600m
  - 공원: 300m

---

## M4: 건축규모 분석 (PDF 크기: ~92KB)

### 포함된 모든 데이터

#### 1. 법적 용적률 분석
```json
{
  "legal_capacity": {
    "far_max": 200.0,                   // 법정 용적률 (%)
    "bcr_max": 60.0,                    // 건폐율 (%)
    "total_units": 20,                  // 법정 세대수
    "gross_floor_area": 1000.0          // 연면적 (㎡)
  }
}
```

**PDF 표시**:
| 항목 | 값 | 비고 |
|------|------|------|
| 법정 용적률 | 200.0% | 지역지구 기준 |
| 건폐율 | 60.0% | 건축선 후퇴 반영 |
| 법정 세대수 | 20세대 | 용적률 기준 |
| 연면적 | 1,000.0㎡ | 지하층 제외 |

---

#### 2. 인센티브 용적률 분석
```json
{
  "incentive_capacity": {
    "far_max": 260.0,                   // 인센티브 후 용적률 (%)
    "total_units": 26                   // 인센티브 세대수
  }
}
```

**PDF 표시**:
| 항목 | 값 | 비고 |
|------|------|------|
| 인센티브 후 용적률 | 260.0% | 공공기여 포함 |
| 추가 용적률 | 60.0% | 법정 대비 증가 |
| 인센티브 세대수 | 26세대 | 최대 규모 |
| 추가 세대수 | 6세대 | 법정 대비 증가 |

---

#### 3. 주차계획 분석
```json
{
  "parking": {
    "alt_a": 15,                        // Alt A 주차대수 (용적률 우선)
    "alt_b": 18                         // Alt B 주차대수 (주차 우선)
  }
}
```

**PDF 표시**:
| 구분 | 주차대수 | 비고 |
|------|----------|------|
| Alt A (용적률 우선) | 15대 | 최대 용적률 확보 |
| Alt B (주차 우선) | 18대 | 주차 편의성 강화 |
| 차이 | 3대 | Alt B가 더 많음 |

---

#### 4. 용적률 비교 차트 (자동 생성)
**PDF 포함 내용**:
- 막대 그래프: 법정 용적률 (20세대) vs 인센티브 용적률 (26세대)
- 증가량 표시: +6세대

---

## M5: 사업성 분석 (PDF 크기: ~101KB)

### 포함된 모든 데이터

#### 1. 재무지표 요약
```json
{
  "financial": {
    "npv_public": 793000000,            // NPV (순현재가치, 원)
    "irr": 12.8,                        // IRR (내부수익률, %)
    "profitability_rate": 15.5          // 사업수익률 (%)
  }
}
```

**PDF 표시**:
| 지표 | 값 | 평가 |
|------|------|------|
| NPV (순현재가치) | 793,000,000원 | 사업 수익성 |
| IRR (내부수익률) | 12.8% | 투자 효율성 |
| 사업수익률 | 15.5% | 총 수익률 |

---

#### 2. 비용 분석 (상세)
```json
{
  "costs": {
    "land": 500000000,                  // 토지비 (원)
    "construction": 300000000,          // 건축비 (원)
    "other": 50000000,                  // 기타비용 (원)
    "total": 850000000                  // 총 비용 (원)
  }
}
```

**PDF 표시**:
| 항목 | 금액 | 비율 |
|------|------|------|
| 토지비 | 500,000,000원 | 58.8% |
| 건축비 | 300,000,000원 | 35.3% |
| 기타비용 | 50,000,000원 | 5.9% |
| **총 비용** | **850,000,000원** | **100.0%** |

---

#### 3. 수익 분석 (상세)
```json
{
  "revenues": {
    "sale": 1200000000,                 // 분양수익 (원)
    "rental": 100000000,                // 임대수익 (원)
    "other": 50000000,                  // 기타수익 (원)
    "total": 1350000000                 // 총 수익 (원)
  }
}
```

**PDF 표시**:
| 항목 | 금액 | 비율 |
|------|------|------|
| 분양수익 | 1,200,000,000원 | 88.9% |
| 임대수익 | 100,000,000원 | 7.4% |
| 기타수익 | 50,000,000원 | 3.7% |
| **총 수익** | **1,350,000,000원** | **100.0%** |

---

#### 4. 차트 (자동 생성)
**PDF 포함 내용**:
1. **비용 구성 파이 차트**: 토지비 58.8%, 건축비 35.3%, 기타 5.9%
2. **비용 vs 수익 막대 그래프**: 총 비용 850M vs 총 수익 1,350M

---

#### 5. 사업성 종합 평가 (자동 계산)
**PDF 표시**:
- **순수익**: 500,000,000원 (수익 - 비용)
- **투자수익률 (ROI)**: 58.8% (순수익 / 총 비용 × 100)
- **사업성 판단**: 양호 (순수익 > 0)
- **종합 의견**: 사업 추진 가능 (IRR > 10% AND 순수익 > 0)

---

## M6: LH 심사예측 (PDF 크기: ~211KB)

### 포함된 모든 데이터

#### 1. 최종 판정
```json
{
  "decision": {
    "type": "GO",                       // 최종 결정 (GO/NO-GO/CONDITIONAL)
    "rationale": "입지 우수, 사업성 양호, LH 선호 유형 적합"  // 판정 근거
  },
  "grade": "A",                         // 심사 등급 (A/B/C/D)
  "total_score": 85.0,                  // 종합 점수 (110점 만점)
  "approval_probability": 0.77          // 예상 승인율 (0.0-1.0)
}
```

**PDF 표시**:
| 항목 | 값 | 설명 |
|------|------|------|
| 최종 결정 | GO | GO/NO-GO/CONDITIONAL |
| 심사 등급 | A | A/B/C/D 등급 |
| 종합 점수 | 85.0/110점 | 만점 110점 기준 |
| 예상 승인율 | 77% | 과거 사례 기반 |

**판정 근거**:
"입지 우수, 사업성 양호, LH 선호 유형 적합"

---

#### 2. 세부 점수 분석
```json
{
  "scores": {
    "location": 25.0,                   // 입지 적정성 (max 30점)
    "feasibility": 20.0,                // 사업 타당성 (max 25점)
    "demand": 15.0,                     // 수요 분석 (max 20점)
    "capacity": 15.0,                   // 건축 계획 (max 20점)
    "other": 10.0                       // 기타 (max 15점)
  }
}
```

**PDF 표시**:
| 평가 항목 | 획득 점수 | 배점 | 비율 | 평가 |
|-----------|-----------|------|------|------|
| 입지 적정성 | 25.0점 | 30점 | 83.3% | 우수 |
| 사업 타당성 | 20.0점 | 25점 | 80.0% | 우수 |
| 수요 분석 | 15.0점 | 20점 | 75.0% | 보통 |
| 건축 계획 | 15.0점 | 20점 | 75.0% | 보통 |
| 기타 | 10.0점 | 15점 | 66.7% | 보통 |

---

#### 3. 레이더 차트 (자동 생성)
**PDF 포함 내용**:
- 5개 항목 Spider Chart
- 실제 점수 vs 만점 비교
- 시각적 강점/약점 파악

---

#### 4. 종합 의견 (자동 생성)
**PDF 표시**:

**총점**: 85.0/110점  
**등급**: A  
**심사 통과 가능성**: 77%

**강점**:
- 입지 적정성이 우수함
- 사업 타당성이 높음

**개선 필요 사항**:
- (점수가 낮은 항목 자동 분석)
- 특별한 개선 사항 없음 (모든 항목 양호 시)

---

## 🎯 요약

### 각 모듈별 PDF 크기 및 데이터 양

| 모듈 | PDF 크기 | 주요 데이터 수 | 특징 |
|------|----------|---------------|------|
| M2 | ~70KB | 20+ 데이터 포인트 | 거래사례 10건, 방법론 포함 |
| M3 | ~30-50KB | 15+ 데이터 포인트 | 유형 비교, POI 분석 |
| M4 | ~92KB | 10+ 데이터 포인트 | 차트 포함, 상세 비교 |
| M5 | ~101KB | 15+ 데이터 포인트 | 차트 2개, ROI 계산 |
| M6 | ~211KB | 12+ 데이터 포인트 | 레이더 차트, 종합 의견 |

### 총 데이터 포인트: **70+**
### 총 차트/시각화: **5개**
### 총 페이지 수: **평균 10-15 페이지**

---

## 🚀 테스트 방법

### 1. 프론트엔드 접속
**https://3000-iytptjlm3wjktifqay52f-2b54fc91.sandbox.novita.ai/pipeline**

### 2. 분석 실행
- M1 데이터 입력
- "분석 시작" 클릭
- M2→M6 자동 실행 대기

### 3. PDF 다운로드
- 각 모듈 카드의 "상세 데이터 다운로드" 버튼 클릭
- **이제 한글 오류 없이 정상 다운로드!**

---

## 📝 참고사항

### 모든 데이터는 PDF에 포함됩니다:
- ✅ 숫자 데이터 (금액, 점수, 비율)
- ✅ 텍스트 데이터 (주소, 설명, 근거)
- ✅ 계산 결과 (합계, 차이, 증가율)
- ✅ 차트 및 시각화
- ✅ 자동 생성 텍스트 (방법론, 종합 의견)

---

**작성일**: 2025-12-18  
**작성자**: ZeroSite AI Developer  
**상태**: ✅ **프로덕션 준비 완료**
