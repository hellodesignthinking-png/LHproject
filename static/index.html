<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ZeroSite Land Report v5.0 - ZeroSite</title>
    
    <!-- Leaflet CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" 
          integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" 
          crossorigin=""/>
    
    <!-- Leaflet JS -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" 
            integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" 
            crossorigin=""></script>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 28px;
            margin-bottom: 10px;
        }

        .header p {
            font-size: 14px;
            opacity: 0.9;
        }

        .content {
            padding: 40px;
        }

        .input-group {
            margin-bottom: 25px;
        }

        .input-group label {
            display: block;
            font-weight: 600;
            margin-bottom: 10px;
            color: #333;
            font-size: 14px;
        }

        .input-group input,
        .input-group select {
            width: 100%;
            padding: 15px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            font-size: 16px;
            transition: all 0.3s;
        }

        .input-group input:focus,
        .input-group select:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .input-hint {
            font-size: 12px;
            color: #888;
            margin-top: 5px;
        }

        .btn-analyze {
            width: 100%;
            padding: 18px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 18px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            margin-top: 10px;
        }

        .btn-analyze:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.3);
        }

        .btn-analyze:active {
            transform: translateY(0);
        }

        .btn-analyze:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
        }

        .loading {
            display: none;
            text-align: center;
            padding: 30px;
            color: #667eea;
        }

        .loading.active {
            display: block;
        }

        .spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #667eea;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .result {
            display: none;
            margin-top: 30px;
            padding: 30px;
            background: #f8f9fa;
            border-radius: 15px;
        }

        .result.active {
            display: block;
        }

        .result-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 25px;
            padding-bottom: 20px;
            border-bottom: 2px solid #e0e0e0;
        }

        .result-title {
            font-size: 24px;
            font-weight: 700;
            color: #333;
        }

        .result-badge {
            padding: 8px 20px;
            border-radius: 20px;
            font-weight: 600;
            font-size: 14px;
        }

        .result-badge.eligible {
            background: #d4edda;
            color: #155724;
        }

        .result-badge.not-eligible {
            background: #f8d7da;
            color: #721c24;
        }
        
        /* ë“±ê¸‰ ë°°ì§€ ìŠ¤íƒ€ì¼ */
        .result-badge.grade-a {
            background: linear-gradient(135deg, #4caf50, #66bb6a);
            color: white;
            box-shadow: 0 4px 8px rgba(76, 175, 80, 0.3);
        }
        
        .result-badge.grade-b {
            background: linear-gradient(135deg, #ff9800, #ffa726);
            color: white;
            box-shadow: 0 4px 8px rgba(255, 152, 0, 0.3);
        }
        
        .result-badge.grade-c {
            background: linear-gradient(135deg, #f44336, #e57373);
            color: white;
            box-shadow: 0 4px 8px rgba(244, 67, 54, 0.3);
        }

        .result-section {
            margin-bottom: 25px;
            padding: 20px;
            background: white;
            border-radius: 10px;
        }

        .result-section h3 {
            font-size: 16px;
            color: #667eea;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
        }

        .result-section h3::before {
            content: '';
            width: 4px;
            height: 20px;
            background: #667eea;
            margin-right: 10px;
            border-radius: 2px;
        }

        .result-item {
            display: flex;
            justify-content: space-between;
            padding: 10px 0;
            border-bottom: 1px solid #f0f0f0;
        }

        .result-item:last-child {
            border-bottom: none;
        }

        .result-label {
            color: #666;
            font-size: 14px;
        }

        .result-value {
            color: #333;
            font-weight: 600;
            font-size: 14px;
        }

        .risk-list {
            list-style: none;
        }

        .risk-item {
            padding: 10px;
            margin-bottom: 8px;
            background: #fff3cd;
            border-left: 4px solid #ffc107;
            border-radius: 5px;
            font-size: 14px;
        }

        .risk-high {
            background: #f8d7da;
            border-color: #dc3545;
        }

        .risk-medium {
            background: #fff3cd;
            border-color: #ffc107;
        }

        .risk-low {
            background: #d4edda;
            border-color: #28a745;
        }

        .score-bar {
            width: 100%;
            height: 30px;
            background: #e0e0e0;
            border-radius: 15px;
            overflow: hidden;
            margin-top: 10px;
        }

        .score-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
            font-size: 14px;
            transition: width 1s ease;
        }

        .error {
            display: none;
            padding: 20px;
            background: #f8d7da;
            border: 1px solid #f5c6cb;
            border-radius: 10px;
            color: #721c24;
            margin-top: 20px;
        }

        .error.active {
            display: block;
        }

        .example-addresses {
            margin-top: 10px;
            font-size: 12px;
            color: #666;
        }

        .example-btn {
            display: inline-block;
            padding: 5px 10px;
            margin: 3px;
            background: #e9ecef;
            border: 1px solid #dee2e6;
            border-radius: 5px;
            cursor: pointer;
            font-size: 11px;
            transition: all 0.2s;
        }

        .example-btn:hover {
            background: #667eea;
            color: white;
            border-color: #667eea;
        }

        .facilities-list {
            font-size: 13px;
            color: #666;
        }

        .facility-item {
            padding: 8px;
            margin-bottom: 5px;
            background: #f8f9fa;
            border-radius: 5px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ¢ ZeroSite LH í† ì§€ì§„ë‹¨ ì‹œìŠ¤í…œ</h1>
            <p>ì£¼ì†Œë§Œ ì…ë ¥í•˜ë©´ ìë™ìœ¼ë¡œ ë¶„ì„ë©ë‹ˆë‹¤</p>
            <p style="font-size: 11px; margin-top: 10px; opacity: 0.8;">Â© 2024 ZeroSite. All Rights Reserved. ë³¸ ì‹œìŠ¤í…œì€ ZeroSiteì˜ ìì‚°ì´ë©°, ë¬´ë‹¨ ë³µì œ ë° ë°°í¬ë¥¼ ê¸ˆì§€í•©ë‹ˆë‹¤.</p>
        </div>

        <div class="content">
            <form id="analysisForm">
                <div class="input-group">
                    <label for="address">ğŸ“ í† ì§€ ì£¼ì†Œ</label>
                    <input 
                        type="text" 
                        id="address" 
                        placeholder="ì˜ˆ: ì„œìš¸íŠ¹ë³„ì‹œ ê°•ë‚¨êµ¬ ì—­ì‚¼ë™ 679" 
                        required
                    >
                    <div class="input-hint">ë„ë¡œëª… ì£¼ì†Œ ë˜ëŠ” ì§€ë²ˆ ì£¼ì†Œë¥¼ ì…ë ¥í•˜ì„¸ìš”</div>
                    <div class="example-addresses">
                        <strong>ì˜ˆì‹œ:</strong>
                        <span class="example-btn" onclick="setExample('ì„œìš¸íŠ¹ë³„ì‹œ ê°•ë‚¨êµ¬ ì—­ì‚¼ë™ 679')">ê°•ë‚¨ ì—­ì‚¼ë™</span>
                        <span class="example-btn" onclick="setExample('ì„œìš¸íŠ¹ë³„ì‹œ ë§ˆí¬êµ¬ ì„œêµë™ 395-1')">ë§ˆí¬ í™ëŒ€</span>
                        <span class="example-btn" onclick="setExample('ì„œìš¸íŠ¹ë³„ì‹œ ì„œì´ˆêµ¬ ë°˜í¬ë™ 19-1')">ì„œì´ˆ ë°˜í¬ë™</span>
                    </div>
                </div>

                <div class="input-group">
                    <label for="landArea">ğŸ“ í† ì§€ ë©´ì  (ã¡)</label>
                    <input 
                        type="number" 
                        id="landArea" 
                        placeholder="500" 
                        min="100" 
                        max="10000"
                        value="500"
                        required
                    >
                    <div class="input-hint">100ã¡ ~ 10,000ã¡ ì‚¬ì´ë¡œ ì…ë ¥í•˜ì„¸ìš”</div>
                </div>

                <div class="input-group" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); padding: 20px; border-radius: 10px; color: white;">
                    <label style="color: white; font-size: 14pt; font-weight: bold; margin-bottom: 10px; display: block;">
                        ğŸ  ì„¸ëŒ€ ìœ í˜• ì„ íƒ ë°©ì‹ (ìë™ ë¶„ì„)
                    </label>
                    <div style="background: rgba(255,255,255,0.2); padding: 15px; border-radius: 8px; line-height: 1.8;">
                        <p style="margin: 0 0 10px 0; font-weight: bold;">âœ¨ ì§€ëŠ¥í˜• ìœ í˜• ì¶”ì²œ ì‹œìŠ¤í…œ</p>
                        <p style="margin: 0; font-size: 10pt;">
                            ì‹œìŠ¤í…œì´ <strong>LH ê³µì‹ 7ê°œ ìœ í˜•</strong>ì„ ëª¨ë‘ ìë™ìœ¼ë¡œ ë¶„ì„í•˜ì—¬<br>
                            í•´ë‹¹ ì§€ì—­ì— ê°€ì¥ ì í•©í•œ ìœ í˜•ì„ ì¶”ì²œí•©ë‹ˆë‹¤.
                        </p>
                        <ul style="margin: 10px 0 0 20px; font-size: 9pt; list-style: none; padding: 0;">
                            <li>âœ“ ì²­ë…„í˜• (ë§Œ 19~39ì„¸, 30ã¡)</li>
                            <li>âœ“ ì‹ í˜¼Â·ì‹ ìƒì•„ Ií˜• (ìë…€ ì—†ìŒ, 45ã¡)</li>
                            <li>âœ“ ì‹ í˜¼Â·ì‹ ìƒì•„ IIí˜• (ìë…€ 1ëª… ì´ìƒ, 55ã¡)</li>
                            <li>âœ“ ë‹¤ìë…€í˜• (ìë…€ 3ëª… ì´ìƒ, 65ã¡)</li>
                            <li>âœ“ ê³ ë ¹ìí˜• (ë§Œ 65ì„¸ ì´ìƒ, 40ã¡)</li>
                            <li>âœ“ ì¼ë°˜í˜• (ì†Œë“ 7ë¶„ìœ„ ì´í•˜, 85ã¡)</li>
                            <li>âœ“ ë“ ë“ ì „ì„¸í˜• (ì²­ë…„Â·ì‹ í˜¼ë¶€ë¶€ ì „ì„¸, 85ã¡)</li>
                        </ul>
                    </div>
                </div>

                <div class="input-group">
                    <label for="zoneType">ğŸ—ï¸ ìš©ë„ì§€ì—­ (ì •í™•í•œ ì •ë³´ ì„ íƒ)</label>
                    <select id="zoneType">
                        <option value="">ìë™ ì¡°íšŒ (API ì‚¬ìš©)</option>
                        <optgroup label="ì£¼ê±°ì§€ì—­">
                            <option value="ì œ1ì¢…ì „ìš©ì£¼ê±°ì§€ì—­">ì œ1ì¢…ì „ìš©ì£¼ê±°ì§€ì—­ (ê±´íìœ¨ 50%, ìš©ì ë¥  100%)</option>
                            <option value="ì œ2ì¢…ì „ìš©ì£¼ê±°ì§€ì—­">ì œ2ì¢…ì „ìš©ì£¼ê±°ì§€ì—­ (ê±´íìœ¨ 50%, ìš©ì ë¥  150%)</option>
                            <option value="ì œ1ì¢…ì¼ë°˜ì£¼ê±°ì§€ì—­">ì œ1ì¢…ì¼ë°˜ì£¼ê±°ì§€ì—­ (ê±´íìœ¨ 60%, ìš©ì ë¥  200%)</option>
                            <option value="ì œ2ì¢…ì¼ë°˜ì£¼ê±°ì§€ì—­">ì œ2ì¢…ì¼ë°˜ì£¼ê±°ì§€ì—­ (ê±´íìœ¨ 60%, ìš©ì ë¥  200%)</option>
                            <option value="ì œ3ì¢…ì¼ë°˜ì£¼ê±°ì§€ì—­">ì œ3ì¢…ì¼ë°˜ì£¼ê±°ì§€ì—­ (ê±´íìœ¨ 50%, ìš©ì ë¥  300%)</option>
                            <option value="ì¤€ì£¼ê±°ì§€ì—­">ì¤€ì£¼ê±°ì§€ì—­ (ê±´íìœ¨ 70%, ìš©ì ë¥  500%)</option>
                        </optgroup>
                        <optgroup label="ìƒì—…ì§€ì—­">
                            <option value="ì¤‘ì‹¬ìƒì—…ì§€ì—­">ì¤‘ì‹¬ìƒì—…ì§€ì—­ (ê±´íìœ¨ 90%, ìš©ì ë¥  1500%)</option>
                            <option value="ì¼ë°˜ìƒì—…ì§€ì—­">ì¼ë°˜ìƒì—…ì§€ì—­ (ê±´íìœ¨ 80%, ìš©ì ë¥  1300%)</option>
                            <option value="ê·¼ë¦°ìƒì—…ì§€ì—­">ê·¼ë¦°ìƒì—…ì§€ì—­ (ê±´íìœ¨ 70%, ìš©ì ë¥  900%)</option>
                            <option value="ìœ í†µìƒì—…ì§€ì—­">ìœ í†µìƒì—…ì§€ì—­ (ê±´íìœ¨ 80%, ìš©ì ë¥  1100%)</option>
                        </optgroup>
                        <optgroup label="ê³µì—…ì§€ì—­">
                            <option value="ì „ìš©ê³µì—…ì§€ì—­">ì „ìš©ê³µì—…ì§€ì—­ (ê±´íìœ¨ 70%, ìš©ì ë¥  300%)</option>
                            <option value="ì¼ë°˜ê³µì—…ì§€ì—­">ì¼ë°˜ê³µì—…ì§€ì—­ (ê±´íìœ¨ 70%, ìš©ì ë¥  350%)</option>
                            <option value="ì¤€ê³µì—…ì§€ì—­">ì¤€ê³µì—…ì§€ì—­ (ê±´íìœ¨ 70%, ìš©ì ë¥  400%)</option>
                        </optgroup>
                        <optgroup label="ë…¹ì§€ì§€ì—­">
                            <option value="ë³´ì „ë…¹ì§€ì§€ì—­">ë³´ì „ë…¹ì§€ì§€ì—­ (ê±´íìœ¨ 20%, ìš©ì ë¥  80%)</option>
                            <option value="ìƒì‚°ë…¹ì§€ì§€ì—­">ìƒì‚°ë…¹ì§€ì§€ì—­ (ê±´íìœ¨ 20%, ìš©ì ë¥  100%)</option>
                            <option value="ìì—°ë…¹ì§€ì§€ì—­">ìì—°ë…¹ì§€ì§€ì—­ (ê±´íìœ¨ 20%, ìš©ì ë¥  100%)</option>
                        </optgroup>
                        <optgroup label="ê´€ë¦¬ì§€ì—­">
                            <option value="ë³´ì „ê´€ë¦¬ì§€ì—­">ë³´ì „ê´€ë¦¬ì§€ì—­ (ê±´íìœ¨ 20%, ìš©ì ë¥  80%)</option>
                            <option value="ìƒì‚°ê´€ë¦¬ì§€ì—­">ìƒì‚°ê´€ë¦¬ì§€ì—­ (ê±´íìœ¨ 20%, ìš©ì ë¥  80%)</option>
                            <option value="ê³„íšê´€ë¦¬ì§€ì—­">ê³„íšê´€ë¦¬ì§€ì—­ (ê±´íìœ¨ 40%, ìš©ì ë¥  100%)</option>
                        </optgroup>
                        <optgroup label="ë³´ì „ì§€ì—­">
                            <option value="ìì—°í™˜ê²½ë³´ì „ì§€ì—­">ìì—°í™˜ê²½ë³´ì „ì§€ì—­ (ê±´íìœ¨ 20%, ìš©ì ë¥  80%)</option>
                        </optgroup>
                    </select>
                    <div class="input-hint">ì •í™•í•œ ìš©ë„ì§€ì—­ì„ ì•Œê³  ê³„ì‹œë©´ ì„ íƒí•˜ì„¸ìš” (API ì¡°íšŒë³´ë‹¤ ì •í™•)</div>
                </div>

                <div class="input-group">
                    <label for="landStatus">ğŸ—ï¸ ì¢…ì „ ëŒ€ì§€ ì´ìš©ìƒíƒœ</label>
                    <select id="landStatus" required>
                        <option value="ë‚˜ëŒ€ì§€" selected>ë‚˜ëŒ€ì§€ (ë¹ˆ ë•…)</option>
                        <option value="ì£¼íƒ">ì£¼íƒ (ë‹¨ë…/ë‹¤ê°€êµ¬)</option>
                        <option value="ìƒê°€">ìƒê°€/ì í¬</option>
                        <option value="ê³µì¥">ê³µì¥/ì°½ê³ </option>
                        <option value="ë†ì§€">ë†ì§€/ì „ë‹µ</option>
                        <option value="ì„ì•¼">ì„ì•¼/ì‚°ì§€</option>
                        <option value="ê¸°íƒ€">ê¸°íƒ€</option>
                    </select>
                    <div class="input-hint">í˜„ì¬ í† ì§€ì˜ ì´ìš© ìƒíƒœë¥¼ ì„ íƒí•˜ì„¸ìš”</div>
                </div>

                <div class="input-group">
                    <label for="landAppraisalPrice">ğŸ’° í† ì§€ íƒìƒê°ì •í‰ê°€ì•¡ (ì›/ã¡, ì„ íƒì‚¬í•­)</label>
                    <input 
                        type="number" 
                        id="landAppraisalPrice" 
                        placeholder="ì˜ˆ: 5500000 (ì…ë ¥í•˜ì§€ ì•Šìœ¼ë©´ ìë™ ê³„ì‚°)" 
                        min="100000" 
                        max="100000000"
                        step="10000"
                    >
                    <div class="input-hint">ê°ì •í‰ê°€ì•¡ì„ ì§ì ‘ ì…ë ¥í•˜ë©´ í•´ë‹¹ ê°’ìœ¼ë¡œ ê³„ì‚°ë©ë‹ˆë‹¤ (ë¹„ì–´ìˆìœ¼ë©´ ì§€ì—­ ê±°ë˜ê°€ ê¸°ì¤€ ìë™ ê³„ì‚°)</div>
                </div>

                <!-- ê°€ì¤‘ì¹˜ ì¡°ì • (ì‹ ê·œ) -->
                <div style="margin: 30px 0; padding: 20px; background: #fff3cd; border-radius: 10px; border-left: 4px solid #ffc107;">
                    <h3 style="margin: 0 0 15px 0; font-size: 15px; color: #333;">
                        âš–ï¸ í‰ê°€ ê°€ì¤‘ì¹˜ ì¡°ì • (ê³ ê¸‰ ì˜µì…˜)
                    </h3>
                    <div style="margin-bottom: 10px; padding: 10px; background: white; border-radius: 6px; font-size: 12px; color: #666;">
                        <strong>ğŸ’¡ íŒ:</strong> ê° ì¹´í…Œê³ ë¦¬ì˜ ì¤‘ìš”ë„ë¥¼ ì¡°ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. í•©ê³„ëŠ” ìë™ìœ¼ë¡œ 100%ë¡œ ë§ì¶°ì§‘ë‹ˆë‹¤.
                    </div>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                        <div>
                            <label style="font-size: 13px; color: #333; display: flex; justify-content: space-between; margin-bottom: 8px;">
                                <span>ğŸ“ ì…ì§€</span>
                                <span id="weightLocationValue" style="font-weight: bold; color: #667eea;">30%</span>
                            </label>
                            <input type="range" id="weightLocation" min="0" max="60" value="30" step="5" 
                                style="width: 100%; cursor: pointer;">
                        </div>
                        <div>
                            <label style="font-size: 13px; color: #333; display: flex; justify-content: space-between; margin-bottom: 8px;">
                                <span>ğŸ—ï¸ ê·œëª¨</span>
                                <span id="weightScaleValue" style="font-weight: bold; color: #667eea;">25%</span>
                            </label>
                            <input type="range" id="weightScale" min="0" max="60" value="25" step="5" 
                                style="width: 100%; cursor: pointer;">
                        </div>
                        <div>
                            <label style="font-size: 13px; color: #333; display: flex; justify-content: space-between; margin-bottom: 8px;">
                                <span>ğŸ’° ì‚¬ì—…ì„±</span>
                                <span id="weightBusinessValue" style="font-weight: bold; color: #667eea;">30%</span>
                            </label>
                            <input type="range" id="weightBusiness" min="0" max="60" value="30" step="5" 
                                style="width: 100%; cursor: pointer;">
                        </div>
                        <div>
                            <label style="font-size: 13px; color: #333; display: flex; justify-content: space-between; margin-bottom: 8px;">
                                <span>ğŸ“‹ ë²•ê·œ</span>
                                <span id="weightRegulationValue" style="font-weight: bold; color: #667eea;">15%</span>
                            </label>
                            <input type="range" id="weightRegulation" min="0" max="60" value="15" step="5" 
                                style="width: 100%; cursor: pointer;">
                        </div>
                    </div>
                    <div style="margin-top: 15px; padding: 10px; background: white; border-radius: 6px; text-align: center;">
                        <span style="font-size: 12px; color: #666;">ê°€ì¤‘ì¹˜ í•©ê³„: </span>
                        <span id="weightTotal" style="font-size: 16px; font-weight: bold; color: #667eea;">100%</span>
                    </div>
                </div>

                <!-- ì»¨ì„¤íŒ… ë‹´ë‹¹ì ì •ë³´ -->
                <div style="margin: 30px 0; padding: 20px; background: #f8f9fa; border-radius: 10px; border-left: 4px solid #667eea;">
                    <h3 style="margin: 0 0 15px 0; font-size: 15px; color: #333;">
                        ğŸ‘¤ ì»¨ì„¤íŒ… ë‹´ë‹¹ì ì •ë³´ (ì„ íƒì‚¬í•­)
                    </h3>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                        <div class="input-group" style="margin-bottom: 0;">
                            <label for="consultantName" style="font-size: 13px;">ì´ë¦„</label>
                            <input 
                                type="text" 
                                id="consultantName" 
                                placeholder="í™ê¸¸ë™"
                                style="padding: 12px; font-size: 14px;"
                            >
                        </div>
                        <div class="input-group" style="margin-bottom: 0;">
                            <label for="consultantPhone" style="font-size: 13px;">ì—°ë½ì²˜</label>
                            <input 
                                type="tel" 
                                id="consultantPhone" 
                                placeholder="010-1234-5678"
                                style="padding: 12px; font-size: 14px;"
                            >
                        </div>
                        <div class="input-group" style="margin-bottom: 0;">
                            <label for="consultantDepartment" style="font-size: 13px;">ë¶€ì„œ</label>
                            <input 
                                type="text" 
                                id="consultantDepartment" 
                                placeholder="í† ì§€ê°œë°œíŒ€"
                                style="padding: 12px; font-size: 14px;"
                            >
                        </div>
                        <div class="input-group" style="margin-bottom: 0;">
                            <label for="consultantEmail" style="font-size: 13px;">ì´ë©”ì¼</label>
                            <input 
                                type="email" 
                                id="consultantEmail" 
                                placeholder="hong@example.com"
                                style="padding: 12px; font-size: 14px;"
                            >
                        </div>
                    </div>
                    <div class="input-hint" style="margin-top: 10px;">
                        ë‹´ë‹¹ì ì •ë³´ëŠ” ë³´ê³ ì„œì— í¬í•¨ë˜ë©°, êµ¬ê¸€ ì‹œíŠ¸ì— í•¨ê»˜ ì €ì¥ë©ë‹ˆë‹¤
                    </div>
                </div>

                <button type="submit" class="btn-analyze" id="analyzeBtn">
                    ğŸ” í† ì§€ ë¶„ì„ ì‹œì‘
                </button>

                <!-- âœ¨ v5.0: ë‹¤ì¤‘ í•„ì§€ ë¶„ì„ UI -->
                <div style="margin-top: 30px; padding: 20px; background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%); border-radius: 12px; border: 2px solid #667eea;">
                    <h3 style="margin: 0 0 15px 0; color: #333; font-size: 18px; display: flex; align-items: center;">
                        <span style="font-size: 24px; margin-right: 10px;">ğŸ“¦</span>
                        ë‹¤ì¤‘ í•„ì§€ ë™ì‹œ ë¶„ì„ (ìµœëŒ€ 10ê°œ)
                    </h3>
                    <p style="margin: 0 0 15px 0; font-size: 13px; color: #666; line-height: 1.6;">
                        ì—¬ëŸ¬ í•„ì§€ë¥¼ í•œë²ˆì— ë¶„ì„í•˜ì—¬ ìµœì ì˜ í•„ì§€ì™€ ì¡°í•©ì„ ì°¾ì•„ë“œë¦½ë‹ˆë‹¤. ê° ì¤„ì— í•˜ë‚˜ì”© ì£¼ì†Œë¥¼ ì…ë ¥í•˜ì„¸ìš”.
                    </p>
                    
                    <div class="input-group" style="margin-bottom: 15px;">
                        <label for="multiParcelAddresses" style="font-weight: 600; color: #333;">í•„ì§€ ì£¼ì†Œ ëª©ë¡ (í•œ ì¤„ì— í•˜ë‚˜ì”©)</label>
                        <textarea 
                            id="multiParcelAddresses" 
                            rows="6"
                            placeholder="ì˜ˆì‹œ:&#10;ì„œìš¸íŠ¹ë³„ì‹œ ë§ˆí¬êµ¬ ì›”ë“œì»µë¶ë¡œ 120&#10;ì„œìš¸íŠ¹ë³„ì‹œ ë§ˆí¬êµ¬ ì›”ë“œì»µë¶ë¡œ 121&#10;ì„œìš¸íŠ¹ë³„ì‹œ ë§ˆí¬êµ¬ ì›”ë“œì»µë¶ë¡œ 122"
                            style="width: 100%; padding: 12px; border: 2px solid #ddd; border-radius: 8px; font-size: 14px; font-family: inherit; resize: vertical;"
                        ></textarea>
                        <div class="input-hint">ìµœëŒ€ 10ê°œ í•„ì§€ê¹Œì§€ ì…ë ¥ ê°€ëŠ¥í•©ë‹ˆë‹¤</div>
                    </div>

                    <button type="button" class="btn-analyze" id="analyzeMultiParcelBtn" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); width: 100%;">
                        ğŸš€ ë‹¤ì¤‘ í•„ì§€ ë¶„ì„ ì‹œì‘
                    </button>
                </div>
            </form>

            <div class="loading" id="loading">
                <div class="spinner"></div>
                <p>í† ì§€ë¥¼ ë¶„ì„í•˜ê³  ìˆìŠµë‹ˆë‹¤...</p>
                <p style="font-size: 14px; margin-top: 10px;">ì•½ 6-8ì´ˆ ì†Œìš”ë©ë‹ˆë‹¤</p>
            </div>

            <div class="error" id="error"></div>

            <div class="result" id="result">
                <div class="result-header">
                    <div class="result-title" id="resultTitle">ë¶„ì„ ê²°ê³¼</div>
                    <div class="result-badge" id="resultBadge"></div>
                </div>

                <div class="result-section">
                    <h3>ğŸ“Š ê¸°ë³¸ ì •ë³´</h3>
                    <div class="result-item">
                        <span class="result-label">ì£¼ì†Œ</span>
                        <span class="result-value" id="resultAddress"></span>
                    </div>
                    <div class="result-item">
                        <span class="result-label">ìš©ë„ì§€ì—­</span>
                        <span class="result-value" id="resultZone"></span>
                    </div>
                    <div class="result-item">
                        <span class="result-label">ê±´íìœ¨ / ìš©ì ë¥ </span>
                        <span class="result-value" id="resultRatio"></span>
                    </div>
                </div>

                <div class="result-section">
                    <h3>ğŸ—ï¸ ê±´ì¶• ê·œëª¨</h3>
                    <div class="result-item">
                        <span class="result-label">ì˜ˆìƒ ì„¸ëŒ€ìˆ˜</span>
                        <span class="result-value" id="resultUnits"></span>
                    </div>
                    <div class="result-item">
                        <span class="result-label">ì¸µìˆ˜</span>
                        <span class="result-value" id="resultFloors"></span>
                    </div>
                    <div class="result-item">
                        <span class="result-label">ì£¼ì°¨ëŒ€ìˆ˜</span>
                        <span class="result-value" id="resultParking"></span>
                    </div>
                </div>

                <div class="result-section" id="allTypesSection" style="display: none;">
                    <h3>ğŸ  ì „ì²´ ìœ í˜• ìˆ˜ìš” ì ìˆ˜ ë¹„êµ (7ê°œ ìœ í˜• ìë™ ë¶„ì„)</h3>
                    <div style="margin-bottom: 15px; padding: 12px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 8px; color: white;">
                        <p style="margin: 0; font-size: 13px; font-weight: bold;">
                            âœ¨ ì¶”ì²œ ìœ í˜•: <span id="recommendedType" style="font-size: 16px;"></span>
                        </p>
                        <p style="margin: 5px 0 0 0; font-size: 11px; opacity: 0.9;">
                            ì‹œìŠ¤í…œì´ ì§€ì—­ íŠ¹ì„±ì„ ë¶„ì„í•˜ì—¬ ê°€ì¥ ì í•©í•œ ìœ í˜•ì„ ì¶”ì²œí–ˆìŠµë‹ˆë‹¤
                        </p>
                    </div>
                    <table style="width: 100%; border-collapse: collapse; font-size: 13px;">
                        <thead>
                            <tr style="background: #f8f9fa; border-bottom: 2px solid #dee2e6;">
                                <th style="padding: 12px; text-align: left; border: 1px solid #dee2e6; font-weight: 600;">ìˆœìœ„</th>
                                <th style="padding: 12px; text-align: left; border: 1px solid #dee2e6; font-weight: 600;">ì„¸ëŒ€ ìœ í˜•</th>
                                <th style="padding: 12px; text-align: center; border: 1px solid #dee2e6; font-weight: 600;">í‰í˜•</th>
                                <th style="padding: 12px; text-align: center; border: 1px solid #dee2e6; font-weight: 600;">ìˆ˜ìš” ì ìˆ˜</th>
                                <th style="padding: 12px; text-align: left; border: 1px solid #dee2e6; font-weight: 600;">ì ìˆ˜ ë°”</th>
                            </tr>
                        </thead>
                        <tbody id="allTypesTableBody">
                            <!-- JavaScriptë¡œ ë™ì  ìƒì„± -->
                        </tbody>
                    </table>
                    <div style="margin-top: 12px; padding: 10px; background: #f8f9fa; border-radius: 6px; font-size: 11px; color: #666;">
                        ğŸ’¡ <strong>ì°¸ê³ :</strong> ë³´ê³ ì„œëŠ” ì¶”ì²œ ìœ í˜•(ìµœê³  ì ìˆ˜)ì„ ê¸°ì¤€ìœ¼ë¡œ ê±´ì¶• ì„¤ê³„ ë° ìˆ˜ì§€ ë¶„ì„ì´ ì‘ì„±ë©ë‹ˆë‹¤.
                    </div>
                </div>

                <div class="result-section">
                    <h3>ğŸ“ˆ ìˆ˜ìš” ë¶„ì„ (ì¶”ì²œ ìœ í˜• ê¸°ì¤€)</h3>
                    <div class="result-item">
                        <span class="result-label">ìˆ˜ìš” ì ìˆ˜</span>
                        <span class="result-value" id="resultScore"></span>
                    </div>
                    <div class="score-bar">
                        <div class="score-fill" id="scoreBar"></div>
                    </div>
                    <div style="margin-top: 15px;">
                        <strong style="font-size: 14px; color: #333;">í•µì‹¬ ìš”ì¸:</strong>
                        <ul id="keyFactors" style="margin-top: 10px; padding-left: 20px; font-size: 14px; color: #666;"></ul>
                    </div>
                </div>

                <div class="result-section" id="riskSection">
                    <h3>âš ï¸ ë¦¬ìŠ¤í¬ ìš”ì¸</h3>
                    <ul class="risk-list" id="riskList"></ul>
                </div>

                <!-- âœ¨ v5.0: Geo Optimization ì§€ë„ ì‹œê°í™” -->
                <div class="result-section" id="geoOptimizationSection" style="display: none; background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%); border: 2px solid #2196f3;">
                    <h3>ğŸ—ºï¸ ì§€ë¦¬ì  ìµœì í™” ë¶„ì„</h3>
                    
                    <!-- í˜„ì¬ ìœ„ì¹˜ ì ìˆ˜ -->
                    <div style="background: white; padding: 15px; border-radius: 8px; margin-bottom: 15px;">
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <div>
                                <h4 style="margin: 0 0 5px 0; color: #333; font-size: 16px;">ğŸ“ ë¶„ì„ ìœ„ì¹˜ ì ìˆ˜</h4>
                                <div id="geoCurrentAddress" style="font-size: 13px; color: #666;"></div>
                            </div>
                            <div style="text-align: right;">
                                <div id="geoOptimizationScore" style="font-size: 32px; font-weight: bold; color: #2196f3;"></div>
                                <div style="font-size: 12px; color: #666;">ìµœì í™” ì ìˆ˜</div>
                            </div>
                        </div>
                    </div>

                    <!-- ê°•ì•½ì  ë¶„ì„ -->
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 15px;">
                        <div style="background: #e8f5e9; padding: 12px; border-radius: 8px; border-left: 3px solid #4caf50;">
                            <h5 style="margin: 0 0 8px 0; color: #2e7d32; font-size: 14px;">âœ… ê°•ì </h5>
                            <ul id="geoStrengths" style="margin: 0; padding-left: 18px; font-size: 12px; line-height: 1.6;"></ul>
                        </div>
                        <div style="background: #fff3e0; padding: 12px; border-radius: 8px; border-left: 3px solid #ff9800;">
                            <h5 style="margin: 0 0 8px 0; color: #e65100; font-size: 14px;">âš ï¸ ì•½ì </h5>
                            <ul id="geoWeaknesses" style="margin: 0; padding-left: 18px; font-size: 12px; line-height: 1.6;"></ul>
                        </div>
                    </div>

                    <!-- ì¶”ì²œ ëŒ€ì•ˆ ìœ„ì¹˜ ì§€ë„ -->
                    <div style="background: white; padding: 15px; border-radius: 8px;">
                        <h4 style="margin: 0 0 12px 0; color: #333; font-size: 15px;">ğŸ¯ ì¶”ì²œ ëŒ€ì•ˆ ìœ„ì¹˜ (ìƒìœ„ 3ê°œ)</h4>
                        <div id="geoMap" style="height: 400px; border-radius: 8px; overflow: hidden;"></div>
                        <div style="margin-top: 12px; padding: 10px; background: #f5f5f5; border-radius: 6px; font-size: 11px; color: #666;">
                            <strong>ğŸ’¡ ë²”ë¡€:</strong> 
                            <span style="display: inline-block; width: 12px; height: 12px; background: #4caf50; border-radius: 50%; margin: 0 5px;"></span> 80ì  ì´ìƒ
                            <span style="display: inline-block; width: 12px; height: 12px; background: #ff9800; border-radius: 50%; margin: 0 5px;"></span> 60-80ì 
                            <span style="display: inline-block; width: 12px; height: 12px; background: #f44336; border-radius: 50%; margin: 0 5px;"></span> 60ì  ë¯¸ë§Œ
                            <span style="display: inline-block; width: 12px; height: 12px; background: #2196f3; border-radius: 50%; margin: 0 5px;"></span> í˜„ì¬ ìœ„ì¹˜
                        </div>
                    </div>

                    <!-- ìµœì í™” ì œì•ˆ -->
                    <div id="geoSuggestions" style="display: none; background: #fff3cd; padding: 12px; border-radius: 8px; border-left: 3px solid #ffc107; margin-top: 15px;">
                        <h5 style="margin: 0 0 8px 0; color: #856404; font-size: 14px;">ğŸ’¡ ìµœì í™” ì œì•ˆ</h5>
                        <ul id="geoSuggestionsList" style="margin: 0; padding-left: 18px; font-size: 12px; line-height: 1.6;"></ul>
                    </div>

                    <!-- ì¶”ì²œ ì‚¬ì´íŠ¸ ìƒì„¸ ì •ë³´ -->
                    <div id="geoSitesDetails" style="margin-top: 15px;"></div>
                </div>

                <!-- ë“±ê¸‰ í‰ê°€ ê²°ê³¼ (ì‹ ê·œ) -->
                <div class="result-section" id="gradeSection" style="display: none;">
                    <h3>ğŸ† ì‚¬ì—… ë“±ê¸‰ í‰ê°€</h3>
                    <div style="text-align: center; margin: 20px 0;">
                        <div id="gradeDisplay" style="display: inline-block; padding: 30px 50px; border-radius: 15px; font-size: 60px; font-weight: bold; box-shadow: 0 4px 12px rgba(0,0,0,0.15);"></div>
                        <div id="gradeScore" style="margin-top: 15px; font-size: 18px; color: #666; font-weight: 600;"></div>
                    </div>
                    <div id="gradeSummary" style="padding: 15px; background: #f8f9fa; border-radius: 8px; border-left: 4px solid #007bff; margin-top: 20px; font-size: 14px; line-height: 1.6;"></div>
                    
                    <!-- ì¹´í…Œê³ ë¦¬ë³„ ì ìˆ˜ -->
                    <div style="margin-top: 25px;">
                        <h4 style="font-size: 15px; color: #333; margin-bottom: 15px;">ğŸ“Š ì¹´í…Œê³ ë¦¬ë³„ ì ìˆ˜</h4>
                        <div id="categoryScores"></div>
                    </div>
                    
                    <!-- ê°œì„  ê¶Œì¥ì‚¬í•­ -->
                    <div id="recommendationsSection" style="display: none; margin-top: 25px;">
                        <h4 style="font-size: 15px; color: #333; margin-bottom: 15px;">ğŸ’¡ ê°œì„  ê¶Œì¥ì‚¬í•­</h4>
                        <ul id="recommendationsList" style="padding-left: 20px; font-size: 13px; line-height: 1.8;"></ul>
                    </div>
                </div>

                <!-- ì²´í¬ë¦¬ìŠ¤íŠ¸ (ì‹ ê·œ) -->
                <div class="result-section" id="checklistSection" style="display: none;">
                    <h3>âœ… LH ê¸°ì¤€ ì²´í¬ë¦¬ìŠ¤íŠ¸</h3>
                    <div style="margin-bottom: 15px; padding: 12px; background: #e3f2fd; border-radius: 8px; font-size: 12px; color: #1976d2;">
                        <strong>ğŸ“Œ ì°¸ê³ :</strong> LH ì‹ ì¶•ë§¤ì…ì„ëŒ€ ê³µê³ ë¬¸ ê¸°ì¤€ì— ë”°ë¼ í•­ëª©ë³„ ì í•©ì„±ì„ ì²´í¬í•œ ê²°ê³¼ì…ë‹ˆë‹¤.
                    </div>
                    <div id="checklistByCategory"></div>
                </div>

                <!-- ì§€ìì²´ ìˆ˜ìš”ì˜ˆì¸¡ (ì‹ ê·œ) -->
                <div class="result-section" id="demandPredictionSection" style="display: none;">
                    <h3>ğŸ“Š ì§€ìì²´ ìˆ˜ìš”ì˜ˆì¸¡ (LITE 1.0)</h3>
                    <div style="margin-bottom: 15px; padding: 15px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 10px; color: white;">
                        <div style="font-size: 18px; font-weight: bold; margin-bottom: 8px;">
                            ìˆ˜ìš” ìˆ˜ì¤€: <span id="demandLevel"></span>
                        </div>
                        <div style="font-size: 24px; font-weight: bold;">
                            <span id="demandScore"></span> <span style="font-size: 16px; opacity: 0.9;">/ 100ì </span>
                        </div>
                    </div>
                    <div id="demandComment" style="padding: 15px; background: #f8f9fa; border-radius: 8px; margin-bottom: 15px; font-size: 14px; line-height: 1.6;"></div>
                    <div style="margin-bottom: 15px;">
                        <h4 style="font-size: 14px; margin-bottom: 10px;">ğŸ“ˆ ìš”ì¸ë³„ ì ìˆ˜</h4>
                        <div id="demandFactors"></div>
                    </div>
                    <div>
                        <h4 style="font-size: 14px; margin-bottom: 10px;">ğŸ’¡ ì¶”ì²œì‚¬í•­</h4>
                        <ul id="demandRecommendations" style="padding-left: 20px; font-size: 13px; line-height: 1.8;"></ul>
                    </div>
                </div>

                <!-- í˜‘ìƒì „ëµ (ì‹ ê·œ) -->
                <div class="result-section" id="negotiationSection" style="display: none;">
                    <h3>ğŸ¤ ì‚¬ì—…ì„± í˜‘ìƒì „ëµ</h3>
                    <div style="margin-bottom: 20px;">
                        <h4 style="font-size: 14px; margin-bottom: 10px; color: #28a745;">âœ… í˜‘ìƒ ê°•ì </h4>
                        <ul id="negotiationStrengths" style="padding-left: 20px; font-size: 13px; line-height: 1.8; color: #155724;"></ul>
                    </div>
                    <div style="margin-bottom: 20px;">
                        <h4 style="font-size: 14px; margin-bottom: 10px; color: #dc3545;">âš ï¸ í˜‘ìƒ ì•½ì </h4>
                        <ul id="negotiationWeaknesses" style="padding-left: 20px; font-size: 13px; line-height: 1.8; color: #721c24;"></ul>
                    </div>
                    <div style="margin-bottom: 20px;">
                        <h4 style="font-size: 14px; margin-bottom: 10px; color: #667eea;">ğŸ“‹ í˜‘ìƒ ì „ëµ</h4>
                        <div id="negotiationStrategies"></div>
                    </div>
                    <div>
                        <h4 style="font-size: 14px; margin-bottom: 10px; color: #ff9800;">ğŸ¯ ìš°ì„  ì¡°ì¹˜ì‚¬í•­</h4>
                        <ul id="negotiationActions" style="padding-left: 20px; font-size: 13px; line-height: 1.8; font-weight: 600;"></ul>
                    </div>
                </div>

                <div class="result-section">
                    <h3>ğŸ¯ ì¢…í•© íŒë‹¨</h3>
                    <div class="result-item">
                        <span class="result-label">LH ë§¤ì… ì ê²©</span>
                        <span class="result-value" id="resultEligible"></span>
                    </div>
                    <div class="result-item">
                        <span class="result-label">ìµœì¢… ì¶”ì²œ</span>
                        <span class="result-value" id="resultRecommendation"></span>
                    </div>
                </div>

                <div class="result-section" id="facilitiesSection" style="display: none;">
                    <h3>ğŸš‡ ì£¼ë³€ ì‹œì„¤</h3>
                    <div class="facilities-list" id="facilitiesList"></div>
                </div>

                <!-- âœ¨ v5.0: Multi-Parcel Analysis Results -->
                <div class="result-section" id="multiParcelResultsSection" style="display: none; background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%); border: 2px solid #667eea;">
                    <h3>ğŸ“¦ ë‹¤ì¤‘ í•„ì§€ ë¶„ì„ ê²°ê³¼</h3>
                    
                    <!-- í†µê³„ ìš”ì•½ -->
                    <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px; margin-bottom: 20px;">
                        <div style="background: white; padding: 15px; border-radius: 8px; text-align: center;">
                            <div style="font-size: 24px; font-weight: bold; color: #667eea;" id="mpTotalParcels">0</div>
                            <div style="font-size: 12px; color: #666; margin-top: 5px;">ì „ì²´ í•„ì§€</div>
                        </div>
                        <div style="background: white; padding: 15px; border-radius: 8px; text-align: center;">
                            <div style="font-size: 24px; font-weight: bold; color: #4caf50;" id="mpSuccessful">0</div>
                            <div style="font-size: 12px; color: #666; margin-top: 5px;">ë¶„ì„ ì„±ê³µ</div>
                        </div>
                        <div style="background: white; padding: 15px; border-radius: 8px; text-align: center;">
                            <div style="font-size: 24px; font-weight: bold; color: #f44336;" id="mpFailed">0</div>
                            <div style="font-size: 12px; color: #666; margin-top: 5px;">ë¶„ì„ ì‹¤íŒ¨</div>
                        </div>
                    </div>

                    <!-- ì¶”ì²œ í•„ì§€ -->
                    <div id="mpRecommended" style="display: none; background: linear-gradient(135deg, #fff9e6 0%, #ffe6f0 100%); padding: 15px; border-radius: 8px; margin-bottom: 20px; border: 2px solid #667eea;">
                        <h4 style="margin: 0 0 10px 0; color: #333; font-size: 16px;">ğŸ† ì¶”ì²œ í•„ì§€ (ìƒìœ„ 3ê°œ)</h4>
                        <div id="mpRecommendedList" style="font-size: 13px; line-height: 1.8;"></div>
                    </div>

                    <!-- í•„ì§€ë³„ ìƒì„¸ ê²°ê³¼ í…Œì´ë¸” -->
                    <div style="overflow-x: auto;">
                        <table id="multiParcelResults" style="width: 100%; border-collapse: collapse; background: white; border-radius: 8px; overflow: hidden; font-size: 13px;">
                            <thead>
                                <tr style="background: #667eea; color: white;">
                                    <th style="padding: 12px; text-align: center; border: 1px solid #5568d3;">ìˆœìœ„</th>
                                    <th style="padding: 12px; text-align: left; border: 1px solid #5568d3;">ì£¼ì†Œ</th>
                                    <th style="padding: 12px; text-align: center; border: 1px solid #5568d3;">ìƒíƒœ</th>
                                    <th style="padding: 12px; text-align: center; border: 1px solid #5568d3;">ìˆ˜ìš”ì ìˆ˜</th>
                                    <th style="padding: 12px; text-align: center; border: 1px solid #5568d3;">ì„¸ëŒ€ìˆ˜</th>
                                    <th style="padding: 12px; text-align: center; border: 1px solid #5568d3;">ì í•©ì„±</th>
                                </tr>
                            </thead>
                            <tbody id="multiParcelResultsBody">
                                <!-- JavaScriptë¡œ ë™ì  ìƒì„± -->
                            </tbody>
                        </table>
                    </div>

                    <!-- í´ëŸ¬ìŠ¤í„° ë¶„ì„ ê²°ê³¼ (ìˆëŠ” ê²½ìš°) -->
                    <div id="mpClusterAnalysis" style="display: none; margin-top: 20px;">
                        <h4 style="margin: 0 0 15px 0; color: #333; font-size: 16px;">ğŸ”— ë‹¤í•„ì§€ ì¡°í•© ë¶„ì„</h4>
                        <div id="mpClusterContent" style="background: white; padding: 15px; border-radius: 8px;"></div>
                    </div>
                </div>

                <!-- âœ¨ v5.0: Debug JSON Viewer for type_demand_scores verification -->
                <div class="result-section" id="debugJsonSection" style="display: none; background: #f8f9fa; border: 2px dashed #6c757d;">
                    <h3>ğŸ” ê°œë°œì ë””ë²„ê·¸: API ì‘ë‹µ JSON</h3>
                    <div style="margin-bottom: 10px;">
                        <button type="button" id="toggleDebugBtn" style="padding: 8px 15px; background: #6c757d; color: white; border: none; border-radius: 5px; cursor: pointer; font-size: 12px;">
                            ğŸ“‹ ì „ì²´ ì‘ë‹µ JSON ë³´ê¸°/ìˆ¨ê¸°ê¸°
                        </button>
                    </div>
                    <div id="debugJsonContent" style="display: none;">
                        <pre id="debugJsonPre" style="background: #2d2d2d; color: #f8f8f2; padding: 15px; border-radius: 8px; font-size: 12px; max-height: 500px; overflow-y: auto; white-space: pre-wrap; word-wrap: break-word;"></pre>
                    </div>
                    <div style="margin-top: 10px; padding: 10px; background: #fff3cd; border-left: 3px solid #ffc107; border-radius: 4px; font-size: 11px; color: #856404;">
                        <strong>ğŸ’¡ í™•ì¸ ì‚¬í•­:</strong>
                        <ul style="margin: 5px 0 0 20px; padding: 0;">
                            <li><code>type_demand_scores</code> í•„ë“œì— 5ê°œ ìœ í˜•ì˜ ë…ë¦½ì ì¸ ì ìˆ˜ê°€ ìˆëŠ”ì§€ í™•ì¸</li>
                            <li>ê° ìœ í˜•ì˜ ì ìˆ˜ê°€ ì„œë¡œ ë‹¤ë¥¸ ê°’ì¸ì§€ ê²€ì¦ (ë™ì¼ ê°’ì´ë©´ ë²„ê·¸)</li>
                            <li><code>all_types_scores</code> ë°°ì—´ì— 7ê°œ ìœ í˜• ì •ë³´ê°€ í¬í•¨ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸</li>
                        </ul>
                    </div>
                </div>

                <button type="button" class="btn-analyze" id="reportBtn" style="margin-top: 20px; background: linear-gradient(135deg, #28a745 0%, #20c997 100%);">
                    ğŸ“„ ì „ë¬¸ ë³´ê³ ì„œ ìƒì„± (LH ì œì¶œìš©)
                </button>

                <button type="button" class="btn-analyze" id="googleDocsBtn" style="margin-top: 10px; background: linear-gradient(135deg, #4285f4 0%, #34a853 100%);">
                    ğŸ“ Google Docsë¡œ ë‚´ë³´ë‚´ê¸°
                </button>
                
                <div style="margin-top: 8px; padding: 10px; background: #e3f2fd; border-left: 3px solid #2196f3; border-radius: 4px; font-size: 12px; color: #1565c0;">
                    <strong>ğŸ’¡ ì°¸ê³ :</strong> Google Docs ê¸°ëŠ¥ì„ ì‚¬ìš©í•˜ë ¤ë©´ Google Cloud ì„¤ì •ì´ í•„ìš”í•©ë‹ˆë‹¤.
                    <a href="https://github.com/yourusername/yourrepo/blob/main/GOOGLE_DOCS_SETUP.md" target="_blank" style="color: #1976d2; text-decoration: underline; margin-left: 5px;">ì„¤ì • ê°€ì´ë“œ ë³´ê¸°</a>
                    <span style="display: block; margin-top: 5px; font-size: 11px; color: #666;">
                        ë˜ëŠ” HTML ë³´ê³ ì„œë¥¼ ìƒì„±í•˜ì—¬ ìˆ˜ë™ìœ¼ë¡œ ë³µì‚¬í•˜ì„¸ìš”.
                    </span>
                </div>

                <div class="result-section" id="reportSection" style="display: none; margin-top: 20px;">
                    <h3>ğŸ“„ ì „ë¬¸ ë³´ê³ ì„œ</h3>
                    <div style="background: #f8f9fa; padding: 15px; border-radius: 10px; margin-top: 10px;">
                        <p style="font-size: 14px; color: #666; margin-bottom: 10px;">
                            LH ì‹ ì¶•ë§¤ì…ì•½ì • ì‚¬ì—… ì œì¶œìš© ì „ë¬¸ ë³´ê³ ì„œê°€ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤.
                        </p>
                        <button type="button" class="btn-analyze" id="viewReportBtn" style="padding: 12px; font-size: 14px;">
                            ğŸ“– ë³´ê³ ì„œ ì „ë¬¸ ë³´ê¸°
                        </button>
                        <button type="button" class="btn-analyze" id="downloadReportBtn" style="padding: 12px; font-size: 14px; margin-left: 10px; background: #6c757d;">
                            ğŸ’¾ ë‹¤ìš´ë¡œë“œ (ì¤€ë¹„ì¤‘)
                        </button>
                    </div>
                </div>

                <div class="result-section" id="googleDocsSection" style="display: none; margin-top: 20px;">
                    <h3>ğŸ“ Google Docs</h3>
                    <div style="background: #e8f5e9; padding: 15px; border-radius: 10px; margin-top: 10px; border: 2px solid #4caf50;">
                        <p style="font-size: 14px; color: #2e7d32; margin-bottom: 10px; font-weight: 600;">
                            âœ… Google Docs ë¬¸ì„œê°€ ì„±ê³µì ìœ¼ë¡œ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤!
                        </p>
                        <p style="font-size: 13px; color: #666; margin-bottom: 15px;" id="googleDocsTitle"></p>
                        <a href="#" id="googleDocsLink" target="_blank" style="display: inline-block; background: #4285f4; color: white; padding: 12px 20px; text-decoration: none; border-radius: 5px; font-weight: 600; font-size: 14px;">
                            ğŸ”— Google Docsì—ì„œ ì—´ê¸°
                        </a>
                        <p style="font-size: 12px; color: #999; margin-top: 10px;">
                            ğŸ’¡ íŒ: Google Docsì—ì„œ í¸ì§‘, ê³µìœ , PDF ë‹¤ìš´ë¡œë“œê°€ ê°€ëŠ¥í•©ë‹ˆë‹¤.
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- ë³´ê³ ì„œ ëª¨ë‹¬ -->
    <div id="reportModal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); z-index: 1000; overflow-y: auto;">
        <div style="max-width: 1200px; margin: 30px auto; background: white; border-radius: 20px; padding: 20px; position: relative;">
            <div style="position: sticky; top: 0; background: white; padding: 15px 20px; border-bottom: 2px solid #eee; margin: -20px -20px 20px -20px; border-radius: 20px 20px 0 0; z-index: 100; display: flex; justify-content: space-between; align-items: center;">
                <h2 style="margin: 0; color: #667eea; font-size: 20px;">ğŸ“„ LH ì‹ ì¶•ë§¤ì…ì„ëŒ€ ì‚¬ì—… ê°ì •í‰ê°€ ë³´ê³ ì„œ</h2>
                <div>
                    <button id="printReportBtn" style="background: #28a745; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer; font-size: 14px; margin-right: 10px; font-weight: 600;">
                        ğŸ–¨ï¸ ì¸ì‡„
                    </button>
                    <button onclick="closeReportModal()" style="background: #dc3545; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer; font-size: 14px; font-weight: 600;">
                        âœ• ë‹«ê¸°
                    </button>
                </div>
            </div>
            <div id="reportContent" style="font-family: 'Malgun Gothic', sans-serif; line-height: 1.6; color: #333;"></div>
        </div>
    </div>

    <script>
        const API_URL = window.location.origin;

        function setExample(address) {
            document.getElementById('address').value = address;
        }

        document.getElementById('analysisForm').addEventListener('submit', async (e) => {
            e.preventDefault();

            const address = document.getElementById('address').value;
            const landArea = parseFloat(document.getElementById('landArea').value);
            const zoneType = document.getElementById('zoneType').value;
            const landStatus = document.getElementById('landStatus').value;
            const landAppraisalPrice = document.getElementById('landAppraisalPrice').value;
            
            // ê°€ì¤‘ì¹˜ (ì‹ ê·œ)
            const weightLocation = parseFloat(document.getElementById('weightLocation').value);
            const weightScale = parseFloat(document.getElementById('weightScale').value);
            const weightBusiness = parseFloat(document.getElementById('weightBusiness').value);
            const weightRegulation = parseFloat(document.getElementById('weightRegulation').value);
            
            // ì»¨ì„¤íŒ… ë‹´ë‹¹ì ì •ë³´
            const consultantName = document.getElementById('consultantName').value;
            const consultantPhone = document.getElementById('consultantPhone').value;
            const consultantDepartment = document.getElementById('consultantDepartment').value;
            const consultantEmail = document.getElementById('consultantEmail').value;

            // UI ì´ˆê¸°í™”
            document.getElementById('loading').classList.add('active');
            document.getElementById('result').classList.remove('active');
            document.getElementById('error').classList.remove('active');
            document.getElementById('analyzeBtn').disabled = true;

            try {
                const requestBody = {
                    address: address,
                    land_area: landArea,
                    land_status: landStatus,
                    weights: {
                        location: weightLocation,
                        scale: weightScale,
                        business: weightBusiness,
                        regulation: weightRegulation
                    }
                    // unit_typeì€ ì œê±°ë¨ - ë°±ì—”ë“œì—ì„œ 7ê°€ì§€ ìœ í˜• ëª¨ë‘ ìë™ ë¶„ì„
                };
                
                // ìš©ë„ì§€ì—­ì´ ì„ íƒëœ ê²½ìš° ì¶”ê°€
                if (zoneType) {
                    requestBody.zone_type = zoneType;
                }

                // íƒìƒê°ì •í‰ê°€ì•¡ì´ ì…ë ¥ëœ ê²½ìš° ì¶”ê°€
                if (landAppraisalPrice && parseFloat(landAppraisalPrice) > 0) {
                    requestBody.land_appraisal_price = parseFloat(landAppraisalPrice);
                }
                
                // ì»¨ì„¤íŒ… ë‹´ë‹¹ì ì •ë³´ ì¶”ê°€ (í•˜ë‚˜ë¼ë„ ì…ë ¥ëœ ê²½ìš°)
                if (consultantName || consultantPhone || consultantDepartment || consultantEmail) {
                    requestBody.consultant = {
                        name: consultantName || null,
                        phone: consultantPhone || null,
                        department: consultantDepartment || null,
                        email: consultantEmail || null
                    };
                }
                
                const response = await fetch(`${API_URL}/api/analyze-land`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(requestBody)
                });

                if (!response.ok) {
                    throw new Error('ë¶„ì„ ìš”ì²­ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
                }

                const data = await response.json();
                // ì›ë³¸ ìš”ì²­ ë°ì´í„°ë¥¼ ë¶„ì„ ê²°ê³¼ì™€ í•¨ê»˜ ì €ì¥
                displayResult(data, requestBody);

            } catch (error) {
                document.getElementById('error').textContent = `ì˜¤ë¥˜: ${error.message}`;
                document.getElementById('error').classList.add('active');
            } finally {
                document.getElementById('loading').classList.remove('active');
                document.getElementById('analyzeBtn').disabled = false;
            }
        });

        function displayResult(data, requestBody) {
            // ë¶„ì„ ë°ì´í„° + ì›ë³¸ ìš”ì²­ ë°ì´í„° ì €ì¥ (ë³´ê³ ì„œ ìƒì„± ì‹œ ì‚¬ìš©)
            currentAnalysisData = {
                ...data,
                // ì›ë³¸ ìš”ì²­ ë°ì´í„° ì¶”ê°€ (ë³´ê³ ì„œ ìƒì„±ì— í•„ìš”)
                address: requestBody.address,
                land_area: requestBody.land_area,
                unit_type: data.recommended_unit_type || requestBody.unit_type,
                land_appraisal_price: requestBody.land_appraisal_price,
                land_status: requestBody.land_status,
                zone_type: requestBody.zone_type,
                consultant: requestBody.consultant
            };
            
            // ê¸°ë³¸ ì •ë³´
            document.getElementById('resultAddress').textContent = data.address;
            document.getElementById('resultZone').textContent = data.zone_info.zone_type;
            document.getElementById('resultRatio').textContent = 
                `${data.zone_info.building_coverage_ratio}% / ${data.zone_info.floor_area_ratio}%`;

            // ê±´ì¶• ê·œëª¨
            document.getElementById('resultUnits').textContent = `${data.building_capacity.units}ì„¸ëŒ€`;
            document.getElementById('resultFloors').textContent = `${data.building_capacity.floors}ì¸µ`;
            document.getElementById('resultParking').textContent = `${data.building_capacity.parking_spaces}ëŒ€`;

            // âœ¨ v5.0: ìœ í˜•ë³„ ìˆ˜ìš”ì ìˆ˜ ì™„ì „ ë¶„ë¦¬ ë Œë”ë§
            const typeScores = data.type_demand_scores || {};
            console.log('ğŸ“Š ìœ í˜•ë³„ ìˆ˜ìš”ì ìˆ˜:', typeScores);
            
            // ì „ì²´ ìœ í˜• ì ìˆ˜ ë¹„êµ (all_types_scores ë˜ëŠ” type_demand_scores ì‚¬ìš©)
            let displayScores = [];
            
            if (data.all_types_scores && data.all_types_scores.length > 0) {
                // all_types_scoresê°€ ìˆìœ¼ë©´ ìš°ì„  ì‚¬ìš©
                displayScores = data.all_types_scores;
            } else if (Object.keys(typeScores).length > 0) {
                // type_demand_scoresë¥¼ all_types_scores í˜•ì‹ìœ¼ë¡œ ë³€í™˜
                const sizeMap = {
                    "ì²­ë…„": "14í‰ (ì „ìš©ë©´ì  40ã¡ ì´í•˜)",
                    "ì‹ í˜¼Â·ì‹ ìƒì•„ I": "18í‰ (ì „ìš©ë©´ì  60ã¡ ë¯¸ë§Œ)",
                    "ì‹ í˜¼Â·ì‹ ìƒì•„ II": "25í‰ (ì „ìš©ë©´ì  60~85ã¡)",
                    "ë‹¤ìë…€": "26í‰ (ì „ìš©ë©´ì  85ã¡)",
                    "ê³ ë ¹ì": "12í‰ (ì „ìš©ë©´ì  40ã¡)"
                };
                
                displayScores = Object.entries(typeScores).map(([unitType, score]) => ({
                    unit_type: unitType,
                    score: score,
                    size: sizeMap[unitType] || "N/A"
                }));
                
                // ì ìˆ˜ ìˆœìœ¼ë¡œ ì •ë ¬
                displayScores.sort((a, b) => b.score - a.score);
            }
            
            if (displayScores.length > 0) {
                document.getElementById('allTypesSection').style.display = 'block';
                document.getElementById('recommendedType').textContent = data.recommended_unit_type || displayScores[0].unit_type;
                
                const tbody = document.getElementById('allTypesTableBody');
                tbody.innerHTML = '';
                
                // ìœ í˜•ë³„ ìƒ‰ìƒ ì •ì˜
                const typeColors = {
                    "ì²­ë…„": "#3498db",           // íŒŒë‘
                    "ì‹ í˜¼Â·ì‹ ìƒì•„ I": "#e91e63",  // ë¶„í™
                    "ì‹ í˜¼Â·ì‹ ìƒì•„ II": "#9c27b0", // ë³´ë¼
                    "ë‹¤ìë…€": "#4caf50",          // ì´ˆë¡
                    "ê³ ë ¹ì": "#ff9800"           // ì£¼í™©
                };
                
                displayScores.forEach((typeScore, index) => {
                    const row = document.createElement('tr');
                    const isRecommended = typeScore.unit_type === (data.recommended_unit_type || displayScores[0].unit_type);
                    const typeColor = typeColors[typeScore.unit_type] || '#6c757d';
                    
                    if (isRecommended) {
                        row.style.background = 'linear-gradient(135deg, #fff9e6 0%, #ffe6f0 100%)';
                        row.style.borderLeft = '4px solid #667eea';
                    }
                    
                    row.innerHTML = `
                        <td style="padding: 10px; border: 1px solid #dee2e6; text-align: center;">
                            ${isRecommended ? 'ğŸ†' : (index + 1)}
                        </td>
                        <td style="padding: 10px; border: 1px solid #dee2e6; font-weight: ${isRecommended ? 'bold' : 'normal'};">
                            <span style="display: inline-block; width: 10px; height: 10px; border-radius: 50%; background: ${typeColor}; margin-right: 5px;"></span>
                            ${typeScore.unit_type}${isRecommended ? ' â­' : ''}
                        </td>
                        <td style="padding: 10px; border: 1px solid #dee2e6; text-align: center;">
                            ${typeScore.size}
                        </td>
                        <td style="padding: 10px; border: 1px solid #dee2e6; text-align: center; font-weight: ${isRecommended ? 'bold' : 'normal'}; color: ${typeColor};">
                            ${typeScore.score.toFixed(1)}ì 
                        </td>
                        <td style="padding: 10px; border: 1px solid #dee2e6;">
                            <div style="background: #e9ecef; border-radius: 10px; height: 20px; overflow: hidden;">
                                <div style="background: ${typeColor}; height: 100%; width: ${typeScore.score}%; transition: width 0.3s;"></div>
                            </div>
                        </td>
                    `;
                    tbody.appendChild(row);
                });
            } else {
                document.getElementById('allTypesSection').style.display = 'none';
            }

            // ìˆ˜ìš” ë¶„ì„
            const score = data.demand_analysis.demand_score;
            document.getElementById('resultScore').textContent = `${score}/100ì `;
            document.getElementById('scoreBar').style.width = `${score}%`;
            document.getElementById('scoreBar').textContent = `${score}ì `;

            // í•µì‹¬ ìš”ì¸
            const factorsList = document.getElementById('keyFactors');
            factorsList.innerHTML = '';
            data.demand_analysis.key_factors.forEach(factor => {
                const li = document.createElement('li');
                li.textContent = factor;
                li.style.marginBottom = '5px';
                factorsList.appendChild(li);
            });

            // ë¦¬ìŠ¤í¬ ìš”ì¸
            const riskList = document.getElementById('riskList');
            riskList.innerHTML = '';
            if (data.risk_factors.length > 0) {
                data.risk_factors.forEach(risk => {
                    const li = document.createElement('li');
                    li.className = `risk-item risk-${risk.severity}`;
                    li.textContent = `[${risk.category}] ${risk.description}`;
                    riskList.appendChild(li);
                });
            } else {
                riskList.innerHTML = '<li style="padding: 10px; color: #28a745;">âœ… ë¦¬ìŠ¤í¬ ìš”ì¸ì´ ì—†ìŠµë‹ˆë‹¤.</li>';
            }

            // ë“±ê¸‰ í‰ê°€ ê²°ê³¼ í‘œì‹œ (ì‹ ê·œ)
            if (data.grade_info) {
                document.getElementById('gradeSection').style.display = 'block';
                
                // ë“±ê¸‰ í‘œì‹œ
                const gradeDisplay = document.getElementById('gradeDisplay');
                const grade = data.grade_info.grade;
                const gradeColors = {
                    'A': { bg: '#4caf50', color: '#fff' },
                    'B': { bg: '#ff9800', color: '#fff' },
                    'C': { bg: '#f44336', color: '#fff' }
                };
                const gradeColor = gradeColors[grade] || gradeColors['C'];
                gradeDisplay.textContent = `ë“±ê¸‰ ${grade}`;
                gradeDisplay.style.background = gradeColor.bg;
                gradeDisplay.style.color = gradeColor.color;
                
                // ì ìˆ˜ í‘œì‹œ
                document.getElementById('gradeScore').textContent = 
                    `ì¢…í•© ì ìˆ˜: ${data.grade_info.total_score.toFixed(1)}ì  / 100ì `;
                
                // ì¢…í•© ì˜ê²¬
                document.getElementById('gradeSummary').innerHTML = 
                    `<strong>ğŸ“ ì¢…í•© ì˜ê²¬:</strong><br>${data.grade_info.summary}`;
                
                // ì¹´í…Œê³ ë¦¬ë³„ ì ìˆ˜
                const categoryScoresDiv = document.getElementById('categoryScores');
                categoryScoresDiv.innerHTML = '';
                Object.entries(data.grade_info.category_scores).forEach(([category, score]) => {
                    const scoreDiv = document.createElement('div');
                    scoreDiv.style.marginBottom = '12px';
                    
                    const scoreColor = score >= 80 ? '#4caf50' : score >= 60 ? '#ff9800' : '#f44336';
                    
                    scoreDiv.innerHTML = `
                        <div style="display: flex; justify-content: space-between; margin-bottom: 5px; font-size: 13px;">
                            <span style="font-weight: 600;">${category}</span>
                            <span style="color: ${scoreColor}; font-weight: bold;">${score.toFixed(1)}ì </span>
                        </div>
                        <div style="background: #e9ecef; border-radius: 10px; height: 12px; overflow: hidden;">
                            <div style="background: ${scoreColor}; height: 100%; width: ${score}%; transition: width 0.5s;"></div>
                        </div>
                    `;
                    categoryScoresDiv.appendChild(scoreDiv);
                });
                
                // ê°œì„  ê¶Œì¥ì‚¬í•­
                if (data.grade_info.recommendations && data.grade_info.recommendations.length > 0) {
                    document.getElementById('recommendationsSection').style.display = 'block';
                    const recommendationsList = document.getElementById('recommendationsList');
                    recommendationsList.innerHTML = '';
                    data.grade_info.recommendations.forEach(rec => {
                        const li = document.createElement('li');
                        li.textContent = rec;
                        li.style.marginBottom = '8px';
                        if (rec.startsWith('[í•„ìˆ˜]')) {
                            li.style.color = '#d32f2f';
                            li.style.fontWeight = '600';
                        } else if (rec.startsWith('[ê¶Œì¥]')) {
                            li.style.color = '#f57c00';
                        }
                        recommendationsList.appendChild(li);
                    });
                }
            }
            
            // ì²´í¬ë¦¬ìŠ¤íŠ¸ í‘œì‹œ (ì‹ ê·œ)
            if (data.checklist && data.checklist.length > 0) {
                document.getElementById('checklistSection').style.display = 'block';
                
                // ì¹´í…Œê³ ë¦¬ë³„ë¡œ ê·¸ë£¹í™”
                const checklistByCategory = {};
                data.checklist.forEach(item => {
                    if (!checklistByCategory[item.category]) {
                        checklistByCategory[item.category] = [];
                    }
                    checklistByCategory[item.category].push(item);
                });
                
                const checklistDiv = document.getElementById('checklistByCategory');
                checklistDiv.innerHTML = '';
                
                Object.entries(checklistByCategory).forEach(([category, items]) => {
                    const categoryDiv = document.createElement('div');
                    categoryDiv.style.marginBottom = '20px';
                    
                    categoryDiv.innerHTML = `
                        <h4 style="font-size: 14px; color: #333; margin-bottom: 12px; padding-bottom: 8px; border-bottom: 2px solid #007bff;">
                            ğŸ“‹ ${category}
                        </h4>
                    `;
                    
                    items.forEach(item => {
                        const statusIcons = {
                            'í†µê³¼': 'âœ…',
                            'ë¶€ì í•©': 'âŒ',
                            'ì£¼ì˜': 'âš ï¸',
                            'ì°¸ê³ ': 'â„¹ï¸'
                        };
                        const statusColors = {
                            'í†µê³¼': '#4caf50',
                            'ë¶€ì í•©': '#f44336',
                            'ì£¼ì˜': '#ff9800',
                            'ì°¸ê³ ': '#2196f3'
                        };
                        
                        const itemDiv = document.createElement('div');
                        itemDiv.style.padding = '12px';
                        itemDiv.style.marginBottom = '8px';
                        itemDiv.style.background = '#f8f9fa';
                        itemDiv.style.borderRadius = '6px';
                        itemDiv.style.borderLeft = `4px solid ${statusColors[item.status] || '#ccc'}`;
                        itemDiv.style.fontSize = '13px';
                        
                        itemDiv.innerHTML = `
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 6px;">
                                <strong style="color: #333;">${item.item}</strong>
                                <span style="color: ${statusColors[item.status]}; font-weight: bold;">
                                    ${statusIcons[item.status] || ''} ${item.status}
                                </span>
                            </div>
                            <div style="display: flex; justify-content: space-between; margin-bottom: 4px; font-size: 12px; color: #666;">
                                <span>ì‹¤ì œ: <strong>${item.value}</strong></span>
                                <span>ê¸°ì¤€: ${item.standard}</span>
                            </div>
                            <div style="font-size: 12px; color: #666; font-style: italic;">
                                ${item.description}
                            </div>
                            <div style="margin-top: 6px; font-size: 11px; color: #999;">
                                í‰ê°€ ì ìˆ˜: ${item.score.toFixed(1)}ì 
                            </div>
                        `;
                        
                        categoryDiv.appendChild(itemDiv);
                    });
                    
                    checklistDiv.appendChild(categoryDiv);
                });
            }

            // ì§€ìì²´ ìˆ˜ìš”ì˜ˆì¸¡ í‘œì‹œ (ì‹ ê·œ)
            if (data.demand_prediction) {
                document.getElementById('demandPredictionSection').style.display = 'block';
                document.getElementById('demandLevel').textContent = data.demand_prediction.demand_level;
                document.getElementById('demandScore').textContent = data.demand_prediction.demand_score.toFixed(1);
                document.getElementById('demandComment').textContent = data.demand_prediction.comment;
                
                // ìš”ì¸ë³„ ì ìˆ˜
                const factorsDiv = document.getElementById('demandFactors');
                factorsDiv.innerHTML = '';
                Object.entries(data.demand_prediction.factor_scores).forEach(([factor, score]) => {
                    const scoreColor = score >= 80 ? '#4caf50' : score >= 60 ? '#ff9800' : '#f44336';
                    factorsDiv.innerHTML += `
                        <div style="margin-bottom: 10px;">
                            <div style="display: flex; justify-content: space-between; margin-bottom: 5px; font-size: 13px;">
                                <span>${factor}</span>
                                <span style="color: ${scoreColor}; font-weight: bold;">${score.toFixed(1)}ì </span>
                            </div>
                            <div style="background: #e9ecef; border-radius: 10px; height: 10px; overflow: hidden;">
                                <div style="background: ${scoreColor}; height: 100%; width: ${score}%; transition: width 0.5s;"></div>
                            </div>
                        </div>
                    `;
                });
                
                // ì¶”ì²œì‚¬í•­
                const recommendationsList = document.getElementById('demandRecommendations');
                recommendationsList.innerHTML = '';
                data.demand_prediction.recommendations.forEach(rec => {
                    const li = document.createElement('li');
                    li.textContent = rec;
                    li.style.marginBottom = '8px';
                    recommendationsList.appendChild(li);
                });
            }
            
            // í˜‘ìƒì „ëµ í‘œì‹œ (ì‹ ê·œ)
            if (data.negotiation_strategy) {
                document.getElementById('negotiationSection').style.display = 'block';
                
                // ê°•ì 
                const strengthsList = document.getElementById('negotiationStrengths');
                strengthsList.innerHTML = '';
                data.negotiation_strategy.strengths.forEach(strength => {
                    const li = document.createElement('li');
                    li.textContent = strength;
                    li.style.marginBottom = '6px';
                    strengthsList.appendChild(li);
                });
                
                // ì•½ì 
                const weaknessesList = document.getElementById('negotiationWeaknesses');
                weaknessesList.innerHTML = '';
                data.negotiation_strategy.weaknesses.forEach(weakness => {
                    const li = document.createElement('li');
                    li.textContent = weakness;
                    li.style.marginBottom = '6px';
                    weaknessesList.appendChild(li);
                });
                
                // ì „ëµ
                const strategiesDiv = document.getElementById('negotiationStrategies');
                strategiesDiv.innerHTML = '';
                data.negotiation_strategy.strategies.forEach((strategy, index) => {
                    const strategyDiv = document.createElement('div');
                    strategyDiv.style.padding = '12px';
                    strategyDiv.style.marginBottom = '10px';
                    strategyDiv.style.background = '#f8f9fa';
                    strategyDiv.style.borderRadius = '8px';
                    strategyDiv.style.borderLeft = '4px solid #667eea';
                    strategyDiv.style.fontSize = '13px';
                    strategyDiv.style.lineHeight = '1.6';
                    strategyDiv.textContent = `${index + 1}. ${strategy}`;
                    strategiesDiv.appendChild(strategyDiv);
                });
                
                // ìš°ì„  ì¡°ì¹˜ì‚¬í•­
                const actionsList = document.getElementById('negotiationActions');
                actionsList.innerHTML = '';
                data.negotiation_strategy.priority_actions.forEach(action => {
                    const li = document.createElement('li');
                    li.textContent = action;
                    li.style.marginBottom = '8px';
                    actionsList.appendChild(li);
                });
            }

            // ì¢…í•© íŒë‹¨
            const isEligible = data.summary.is_eligible;
            document.getElementById('resultEligible').textContent = isEligible ? 'âœ… ì ê²©' : 'âŒ ë¶€ì ê²©';
            document.getElementById('resultRecommendation').textContent = data.summary.recommendation;

            // ë°°ì§€ (ë“±ê¸‰ìœ¼ë¡œ ì—…ë°ì´íŠ¸)
            const badge = document.getElementById('resultBadge');
            if (data.grade_info && data.grade_info.grade) {
                badge.textContent = `ë“±ê¸‰ ${data.grade_info.grade}`;
                const gradeClasses = {
                    'A': 'grade-a',
                    'B': 'grade-b',
                    'C': 'grade-c'
                };
                badge.className = `result-badge ${gradeClasses[data.grade_info.grade] || 'not-eligible'}`;
            } else {
                badge.textContent = isEligible ? 'âœ… ì ê²©' : 'âŒ ë¶€ì ê²©';
                badge.className = `result-badge ${isEligible ? 'eligible' : 'not-eligible'}`;
            }

            // ì£¼ë³€ ì‹œì„¤ (ìˆëŠ” ê²½ìš°)
            if (data.demand_analysis.nearby_facilities && data.demand_analysis.nearby_facilities.length > 0) {
                const facilitiesSection = document.getElementById('facilitiesSection');
                const facilitiesList = document.getElementById('facilitiesList');
                facilitiesSection.style.display = 'block';
                facilitiesList.innerHTML = '';
                
                data.demand_analysis.nearby_facilities.forEach(facility => {
                    const div = document.createElement('div');
                    div.className = 'facility-item';
                    div.textContent = `${facility.name} (${Math.round(facility.distance)}m)`;
                    facilitiesList.appendChild(div);
                });
            }

            // âœ¨ v5.0: Debug JSON ë·°ì–´ í‘œì‹œ ë° ë°ì´í„° ì„¤ì •
            const debugJsonSection = document.getElementById('debugJsonSection');
            debugJsonSection.style.display = 'block';
            
            // ì „ì²´ API ì‘ë‹µ JSONì„ í¬ë§·í•˜ì—¬ í‘œì‹œ
            const debugJsonPre = document.getElementById('debugJsonPre');
            debugJsonPre.textContent = JSON.stringify(data, null, 2);
            
            // í† ê¸€ ë²„íŠ¼ ì´ë²¤íŠ¸
            document.getElementById('toggleDebugBtn').onclick = function() {
                const debugContent = document.getElementById('debugJsonContent');
                if (debugContent.style.display === 'none') {
                    debugContent.style.display = 'block';
                    this.textContent = 'ğŸ“‹ ì „ì²´ ì‘ë‹µ JSON ìˆ¨ê¸°ê¸°';
                } else {
                    debugContent.style.display = 'none';
                    this.textContent = 'ğŸ“‹ ì „ì²´ ì‘ë‹µ JSON ë³´ê¸°';
                }
            };

            // âœ¨ v5.0: Geo Optimization ì‹œê°í™”
            if (data.geo_optimization) {
                displayGeoOptimization(data.geo_optimization, data.coordinates);
            }

            // ê²°ê³¼ í‘œì‹œ
            document.getElementById('result').classList.add('active');

            // Google Docs ë²„íŠ¼ í‘œì‹œ (ë¶„ì„ ì™„ë£Œ í›„ ë°”ë¡œ ì‚¬ìš© ê°€ëŠ¥)
            console.log('ğŸ” Google Docs ë²„íŠ¼ í‘œì‹œ ì‹œë„...');
            const googleDocsBtn = document.getElementById('googleDocsBtn');
            if (googleDocsBtn) {
                googleDocsBtn.style.display = 'block';
                console.log('âœ… Google Docs ë²„íŠ¼ í‘œì‹œë¨:', googleDocsBtn.style.display);
            } else {
                console.error('âŒ Google Docs ë²„íŠ¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŒ!');
            }

            // ê²°ê³¼ë¡œ ìŠ¤í¬ë¡¤
            document.getElementById('result').scrollIntoView({ behavior: 'smooth', block: 'start' });
        }

        // ì „ë¬¸ ë³´ê³ ì„œ ìƒì„± ê¸°ëŠ¥
        let currentAnalysisData = null;
        let currentReport = null;

        document.getElementById('reportBtn').addEventListener('click', async () => {
            if (!currentAnalysisData) {
                alert('ë¨¼ì € í† ì§€ ë¶„ì„ì„ ì‹¤í–‰í•´ì£¼ì„¸ìš”.');
                return;
            }

            // íƒˆë½ì‚¬ìœ  í™•ì¸
            const riskFactors = currentAnalysisData.risk_factors || [];
            const criticalRisks = riskFactors.filter(r => 
                r.category === 'LHë§¤ì…ì œì™¸' || r.severity === 'critical' || r.severity === 'high'
            );

            if (criticalRisks.length > 0) {
                const riskList = criticalRisks.map(r => `â€¢ ${r.description}`).join('\n');
                const userChoice = confirm(
                    `âš ï¸ ë‹¤ìŒ íƒˆë½ì‚¬ìœ ê°€ ë°œê²¬ë˜ì—ˆìŠµë‹ˆë‹¤:\n\n${riskList}\n\n` +
                    `ì´ ì‚¬ìœ ë“¤ì„ ì œì™¸í•˜ê³  ë³´ê³ ì„œë¥¼ ìƒì„±í•˜ì‹œê² ìŠµë‹ˆê¹Œ?\n\n` +
                    `[í™•ì¸] = ì œì™¸í•˜ê³  ìƒì„±\n[ì·¨ì†Œ] = í¬í•¨í•´ì„œ ìƒì„±`
                );

                if (userChoice) {
                    // íƒˆë½ì‚¬ìœ  ì œì™¸
                    currentAnalysisData.exclude_risks = true;
                    currentAnalysisData.risk_factors = riskFactors.filter(r => 
                        r.category !== 'LHë§¤ì…ì œì™¸' && r.severity !== 'critical' && r.severity !== 'high'
                    );
                }
            }

            document.getElementById('reportBtn').disabled = true;
            document.getElementById('reportBtn').textContent = 'ğŸ“„ ë³´ê³ ì„œ ìƒì„± ì¤‘...';

            try {
                const response = await fetch(`${API_URL}/api/generate-report`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(currentAnalysisData)
                });

                if (!response.ok) {
                    throw new Error('ë³´ê³ ì„œ ìƒì„±ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
                }

                const data = await response.json();
                currentReport = data.report;

                // ë³´ê³ ì„œ ì„¹ì…˜ ë° Google Docs ë²„íŠ¼ í‘œì‹œ
                document.getElementById('reportSection').style.display = 'block';
                document.getElementById('googleDocsBtn').style.display = 'block';
                document.getElementById('reportBtn').textContent = 'âœ… ë³´ê³ ì„œ ìƒì„± ì™„ë£Œ';

            } catch (error) {
                alert(`ì˜¤ë¥˜: ${error.message}`);
                document.getElementById('reportBtn').textContent = 'ğŸ“„ ì „ë¬¸ ë³´ê³ ì„œ ìƒì„± (LH ì œì¶œìš©)';
            } finally {
                document.getElementById('reportBtn').disabled = false;
            }
        });

        // Google Docs ìƒì„± ê¸°ëŠ¥
        document.getElementById('googleDocsBtn').addEventListener('click', async () => {
            if (!currentAnalysisData) {
                alert('ë¨¼ì € í† ì§€ ë¶„ì„ì„ ì‹¤í–‰í•´ì£¼ì„¸ìš”.');
                return;
            }

            // ë²„íŠ¼ ë¹„í™œì„±í™” ë° í…ìŠ¤íŠ¸ ë³€ê²½
            const btn = document.getElementById('googleDocsBtn');
            btn.disabled = true;
            btn.textContent = 'ğŸ“ Google Docs ìƒì„± ì¤‘...';

            try {
                const response = await fetch(`${API_URL}/api/generate-google-docs`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(currentAnalysisData)
                });

                if (!response.ok) {
                    const errorData = await response.json();
                    throw new Error(errorData.detail?.message || 'Google Docs ìƒì„±ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
                }

                const data = await response.json();
                
                if (data.status === 'success' && data.google_docs) {
                    // Google Docs ì„¹ì…˜ í‘œì‹œ
                    document.getElementById('googleDocsSection').style.display = 'block';
                    document.getElementById('googleDocsTitle').textContent = 
                        `ë¬¸ì„œ ì œëª©: ${data.google_docs.title}`;
                    document.getElementById('googleDocsLink').href = data.google_docs.document_url;
                    
                    btn.textContent = 'âœ… Google Docs ìƒì„± ì™„ë£Œ';
                    
                    // 3ì´ˆ í›„ ìƒˆ íƒ­ì—ì„œ ìë™ìœ¼ë¡œ ì—´ê¸° ì œì•ˆ
                    setTimeout(() => {
                        if (confirm('Google Docs ë¬¸ì„œë¥¼ ìƒˆ íƒ­ì—ì„œ ì—¬ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                            window.open(data.google_docs.document_url, '_blank');
                        }
                    }, 500);
                } else {
                    throw new Error('Google Docs ì‘ë‹µ í˜•ì‹ì´ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤.');
                }

            } catch (error) {
                console.error('Google Docs ìƒì„± ì˜¤ë¥˜:', error);
                
                // ë” ìì„¸í•œ ì•ˆë‚´ ë©”ì‹œì§€
                const setupGuide = `
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ“ Google Docs ë‚´ë³´ë‚´ê¸° ì„¤ì • í•„ìš”
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

âš ï¸ ì˜¤ë¥˜: ${error.message}

ğŸ”§ ì„¤ì • ë°©ë²•:

1. Google Cloud Console ì ‘ì†
   â†’ https://console.cloud.google.com/

2. í”„ë¡œì íŠ¸ ìƒì„± ë° API í™œì„±í™”
   âœ… Google Docs API
   âœ… Google Drive API

3. ì„œë¹„ìŠ¤ ê³„ì • ìƒì„± ë° JSON í‚¤ ë‹¤ìš´ë¡œë“œ

4. í‚¤ íŒŒì¼ ë°°ì¹˜
   â†’ /home/user/webapp/google_credentials.json

5. ì„œë²„ ì¬ì‹œì‘

ğŸ“– ìì„¸í•œ ê°€ì´ë“œ:
   í”„ë¡œì íŠ¸ ë£¨íŠ¸ì˜ GOOGLE_DOCS_SETUP.md ì°¸ì¡°

ğŸ’¡ ë˜ëŠ” HTML ë³´ê³ ì„œë¥¼ ìƒì„±í•˜ì—¬
   ìˆ˜ë™ìœ¼ë¡œ Google Docsì— ë³µì‚¬í•˜ì„¸ìš”.
                `.trim();
                
                alert(setupGuide);
                btn.textContent = 'ğŸ“ Google Docsë¡œ ë‚´ë³´ë‚´ê¸°';
            } finally {
                btn.disabled = false;
            }
        });

        document.getElementById('viewReportBtn').addEventListener('click', () => {
            if (!currentReport) {
                alert('ë³´ê³ ì„œê°€ ìƒì„±ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.');
                return;
            }

            // ë°”ë¡œ ë³´ê³ ì„œ í‘œì‹œ (ë¹„ë°€ë²ˆí˜¸ ì œê±°)
            displayReport();
        });

        function displayReport() {
            // HTML ë³´ê³ ì„œ ì§ì ‘ í‘œì‹œ (ì´ë¯¸ HTML í˜•ì‹)
            document.getElementById('reportContent').innerHTML = currentReport;
            document.getElementById('reportModal').style.display = 'block';
            
            // ì¸ì‡„ ë²„íŠ¼ ì¶”ê°€ ì´ë²¤íŠ¸
            const printBtn = document.getElementById('printReportBtn');
            if (printBtn) {
                printBtn.onclick = () => {
                    const reportWindow = window.open('', '_blank');
                    reportWindow.document.write(currentReport);
                    reportWindow.document.close();
                    setTimeout(() => {
                        reportWindow.print();
                    }, 500);
                };
            }
        }

        function closeReportModal() {
            document.getElementById('reportModal').style.display = 'none';
        }

        // ë¶„ì„ ì‹¤í–‰ ì‹œ ë°ì´í„° ì €ì¥
        const originalFetch = window.fetch;
        window.fetch = async function(...args) {
            const response = await originalFetch(...args);
            
            if (args[0].includes('/api/analyze-land') && args[1]?.method === 'POST') {
                const clonedResponse = response.clone();
                const data = await clonedResponse.json();
                
                if (data.status === 'success') {
                    // ë¶„ì„ ë°ì´í„° ì €ì¥
                    currentAnalysisData = JSON.parse(args[1].body);
                }
            }
            
            return response;
        };
        
        // ê°€ì¤‘ì¹˜ ìŠ¬ë¼ì´ë” ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ (ì‹ ê·œ)
        function updateWeights() {
            const location = parseFloat(document.getElementById('weightLocation').value);
            const scale = parseFloat(document.getElementById('weightScale').value);
            const business = parseFloat(document.getElementById('weightBusiness').value);
            const regulation = parseFloat(document.getElementById('weightRegulation').value);
            
            // ê°’ í‘œì‹œ
            document.getElementById('weightLocationValue').textContent = location + '%';
            document.getElementById('weightScaleValue').textContent = scale + '%';
            document.getElementById('weightBusinessValue').textContent = business + '%';
            document.getElementById('weightRegulationValue').textContent = regulation + '%';
            
            // í•©ê³„ ê³„ì‚°
            const total = location + scale + business + regulation;
            document.getElementById('weightTotal').textContent = total + '%';
            
            // í•©ê³„ê°€ 100ì´ ì•„ë‹ˆë©´ ê²½ê³  ìƒ‰ìƒ
            if (Math.abs(total - 100) > 0.01) {
                document.getElementById('weightTotal').style.color = '#dc3545';
            } else {
                document.getElementById('weightTotal').style.color = '#667eea';
            }
        }
        
        // ìŠ¬ë¼ì´ë” ì´ë²¤íŠ¸ ë“±ë¡
        document.getElementById('weightLocation').addEventListener('input', updateWeights);
        document.getElementById('weightScale').addEventListener('input', updateWeights);
        document.getElementById('weightBusiness').addEventListener('input', updateWeights);
        document.getElementById('weightRegulation').addEventListener('input', updateWeights);

        // âœ¨ v5.0: ë‹¤ì¤‘ í•„ì§€ ë¶„ì„ ê¸°ëŠ¥
        document.getElementById('analyzeMultiParcelBtn').addEventListener('click', async function() {
            const addressesText = document.getElementById('multiParcelAddresses').value.trim();
            
            if (!addressesText) {
                alert('í•„ì§€ ì£¼ì†Œë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }

            // ì¤„ ë‹¨ìœ„ë¡œ ì£¼ì†Œ ë¶„ë¦¬
            const addresses = addressesText.split('\n')
                .map(addr => addr.trim())
                .filter(addr => addr.length > 0);

            if (addresses.length === 0) {
                alert('ìœ íš¨í•œ ì£¼ì†Œë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }

            if (addresses.length > 10) {
                alert('ìµœëŒ€ 10ê°œ í•„ì§€ê¹Œì§€ ë¶„ì„ ê°€ëŠ¥í•©ë‹ˆë‹¤.');
                return;
            }

            // í† ì§€ ë©´ì  ê°€ì ¸ì˜¤ê¸°
            const landArea = parseFloat(document.getElementById('landArea').value);
            if (!landArea || landArea <= 0) {
                alert('í† ì§€ ë©´ì ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }

            // ìœ í˜• ê°€ì ¸ì˜¤ê¸°
            const unitType = document.getElementById('unitType').value || null;

            // ë²„íŠ¼ ë¹„í™œì„±í™” ë° ë¡œë”© í‘œì‹œ
            const button = document.getElementById('analyzeMultiParcelBtn');
            button.disabled = true;
            button.textContent = 'ğŸ”„ ë¶„ì„ ì¤‘...';

            // ë¡œë”© í‘œì‹œ
            document.getElementById('loading').style.display = 'block';
            document.getElementById('error').style.display = 'none';
            document.getElementById('multiParcelResultsSection').style.display = 'none';

            try {
                console.log('ë‹¤ì¤‘ í•„ì§€ ë¶„ì„ ì‹œì‘:', addresses);
                
                const response = await fetch('/api/analyze-multi-parcel', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        parcels: addresses,
                        land_area: landArea,
                        unit_type: unitType,
                        lh_version: document.getElementById('lhVersion').value || '2024'
                    })
                });

                const data = await response.json();
                console.log('ë‹¤ì¤‘ í•„ì§€ ë¶„ì„ ê²°ê³¼:', data);

                if (data.status === 'success') {
                    displayMultiParcelResults(data);
                } else {
                    throw new Error(data.message || 'ë¶„ì„ ì‹¤íŒ¨');
                }

            } catch (error) {
                console.error('ë‹¤ì¤‘ í•„ì§€ ë¶„ì„ ì˜¤ë¥˜:', error);
                document.getElementById('error').textContent = 
                    `âŒ ë‹¤ì¤‘ í•„ì§€ ë¶„ì„ ì˜¤ë¥˜: ${error.message}`;
                document.getElementById('error').style.display = 'block';
            } finally {
                button.disabled = false;
                button.textContent = 'ğŸš€ ë‹¤ì¤‘ í•„ì§€ ë¶„ì„ ì‹œì‘';
                document.getElementById('loading').style.display = 'none';
            }
        });

        // ë‹¤ì¤‘ í•„ì§€ ê²°ê³¼ ë Œë”ë§ í•¨ìˆ˜
        function displayMultiParcelResults(data) {
            // í†µê³„ í‘œì‹œ
            document.getElementById('mpTotalParcels').textContent = data.total_parcels;
            document.getElementById('mpSuccessful').textContent = data.successful;
            document.getElementById('mpFailed').textContent = data.failed;

            // ì¶”ì²œ í•„ì§€ í‘œì‹œ
            if (data.recommended_parcels && data.recommended_parcels.length > 0) {
                document.getElementById('mpRecommended').style.display = 'block';
                const recommendedList = document.getElementById('mpRecommendedList');
                recommendedList.innerHTML = data.recommended_parcels
                    .map((addr, idx) => `<div>ğŸ† ${idx + 1}ìœ„: ${addr}</div>`)
                    .join('');
            }

            // í…Œì´ë¸” ìƒì„±
            const tbody = document.getElementById('multiParcelResultsBody');
            tbody.innerHTML = '';

            // ì„±ê³µí•œ í•„ì§€ë¥¼ ì ìˆ˜ ìˆœìœ¼ë¡œ ì •ë ¬
            const sortedResults = [...data.results]
                .filter(r => r.success && r.demand_score != null)
                .sort((a, b) => b.demand_score - a.demand_score);

            // ì‹¤íŒ¨í•œ í•„ì§€
            const failedResults = data.results.filter(r => !r.success);

            // ì„±ê³µí•œ í•„ì§€ ë Œë”ë§
            sortedResults.forEach((result, index) => {
                const row = document.createElement('tr');
                const isTop3 = index < 3;
                
                if (isTop3) {
                    row.style.background = 'linear-gradient(135deg, #fff9e6 0%, #ffe6f0 100%)';
                }

                const scoreColor = result.demand_score >= 80 ? '#4caf50' : 
                                   result.demand_score >= 60 ? '#ff9800' : '#f44336';

                row.innerHTML = `
                    <td style="padding: 10px; border: 1px solid #dee2e6; text-align: center; font-weight: bold;">
                        ${isTop3 ? 'ğŸ†' : (index + 1)}
                    </td>
                    <td style="padding: 10px; border: 1px solid #dee2e6;">
                        ${result.address}
                    </td>
                    <td style="padding: 10px; border: 1px solid #dee2e6; text-align: center;">
                        <span style="color: #4caf50; font-weight: bold;">âœ… ì„±ê³µ</span>
                    </td>
                    <td style="padding: 10px; border: 1px solid #dee2e6; text-align: center; font-weight: bold; color: ${scoreColor};">
                        ${result.demand_score.toFixed(1)}ì 
                    </td>
                    <td style="padding: 10px; border: 1px solid #dee2e6; text-align: center;">
                        ${result.building_capacity || '-'}ì„¸ëŒ€
                    </td>
                    <td style="padding: 10px; border: 1px solid #dee2e6; text-align: center;">
                        ${result.summary?.is_eligible ? 'âœ… ì í•©' : 'âš ï¸ ê²€í† í•„ìš”'}
                    </td>
                `;
                tbody.appendChild(row);
            });

            // ì‹¤íŒ¨í•œ í•„ì§€ ë Œë”ë§
            failedResults.forEach(result => {
                const row = document.createElement('tr');
                row.style.background = '#ffebee';

                row.innerHTML = `
                    <td style="padding: 10px; border: 1px solid #dee2e6; text-align: center;">-</td>
                    <td style="padding: 10px; border: 1px solid #dee2e6;">
                        ${result.address}
                    </td>
                    <td style="padding: 10px; border: 1px solid #dee2e6; text-align: center;">
                        <span style="color: #f44336; font-weight: bold;">âŒ ì‹¤íŒ¨</span>
                    </td>
                    <td colspan="3" style="padding: 10px; border: 1px solid #dee2e6; color: #666; font-size: 12px;">
                        ${result.error_message || 'ë¶„ì„ ì‹¤íŒ¨'}
                    </td>
                `;
                tbody.appendChild(row);
            });

            // í´ëŸ¬ìŠ¤í„° ë¶„ì„ ê²°ê³¼ í‘œì‹œ
            if (data.cluster_analysis && data.cluster_analysis.clusters) {
                document.getElementById('mpClusterAnalysis').style.display = 'block';
                const clusterContent = document.getElementById('mpClusterContent');
                
                const clusters = data.cluster_analysis.clusters;
                if (clusters.length > 0) {
                    clusterContent.innerHTML = `
                        <div style="margin-bottom: 15px;">
                            <strong>ì´ ${clusters.length}ê°œ ì¡°í•© ë°œê²¬</strong>
                        </div>
                        ${clusters.slice(0, 3).map((cluster, idx) => `
                            <div style="background: #f5f7fa; padding: 15px; border-radius: 8px; margin-bottom: 10px; border-left: 4px solid ${idx === 0 ? '#667eea' : '#ddd'};">
                                <div style="font-weight: bold; margin-bottom: 8px;">
                                    ${idx === 0 ? 'ğŸ† ' : ''}ì¡°í•© ${idx + 1}: ${cluster.cluster_id}
                                </div>
                                <div style="font-size: 13px; color: #666; line-height: 1.6;">
                                    <div>ğŸ“ ì´ ë©´ì : ${cluster.total_area.toFixed(1)}ã¡</div>
                                    <div>ğŸ  ì´ ì„¸ëŒ€ìˆ˜: ${cluster.total_capacity}ì„¸ëŒ€</div>
                                    <div>â­ í´ëŸ¬ìŠ¤í„° ì ìˆ˜: ${cluster.cluster_score.toFixed(1)}ì </div>
                                    <div>ğŸ”— ì‹œë„ˆì§€ ì ìˆ˜: ${cluster.synergy_score.toFixed(1)}ì </div>
                                    <div style="margin-top: 8px; color: #333; font-weight: 600;">
                                        ${cluster.recommendation}
                                    </div>
                                    ${cluster.strengths && cluster.strengths.length > 0 ? `
                                        <div style="margin-top: 8px;">
                                            <strong style="color: #4caf50;">ê°•ì :</strong>
                                            <ul style="margin: 5px 0 0 20px; padding: 0;">
                                                ${cluster.strengths.map(s => `<li>${s}</li>`).join('')}
                                            </ul>
                                        </div>
                                    ` : ''}
                                </div>
                            </div>
                        `).join('')}
                        ${data.cluster_analysis.optimization_suggestions && data.cluster_analysis.optimization_suggestions.length > 0 ? `
                            <div style="background: #fff3cd; padding: 12px; border-radius: 6px; border-left: 3px solid #ffc107; margin-top: 15px;">
                                <strong>ğŸ’¡ ìµœì í™” ì œì•ˆ:</strong>
                                <ul style="margin: 8px 0 0 20px; padding: 0; font-size: 13px;">
                                    ${data.cluster_analysis.optimization_suggestions.map(s => `<li>${s}</li>`).join('')}
                                </ul>
                            </div>
                        ` : ''}
                    `;
                } else {
                    clusterContent.innerHTML = '<p style="color: #666;">ì¡°í•© ê°€ëŠ¥í•œ í´ëŸ¬ìŠ¤í„°ê°€ ì—†ìŠµë‹ˆë‹¤.</p>';
                }
            }

            // ê²°ê³¼ ì„¹ì…˜ í‘œì‹œ
            document.getElementById('multiParcelResultsSection').style.display = 'block';
            
            // ê²°ê³¼ ì„¹ì…˜ìœ¼ë¡œ ìŠ¤í¬ë¡¤
            document.getElementById('multiParcelResultsSection').scrollIntoView({ 
                behavior: 'smooth', 
                block: 'start' 
            });
        }

        // âœ¨ v5.0: Geo Optimization ì§€ë„ ì‹œê°í™” í•¨ìˆ˜
        let geoMap = null;

        function displayGeoOptimization(geoData, currentCoords) {
            console.log('ğŸ—ºï¸ Geo Optimization ë°ì´í„°:', geoData);
            
            // ì„¹ì…˜ í‘œì‹œ
            document.getElementById('geoOptimizationSection').style.display = 'block';
            
            // í˜„ì¬ ìœ„ì¹˜ ì •ë³´ í‘œì‹œ
            document.getElementById('geoCurrentAddress').textContent = 
                geoData.analyzed_location.address;
            document.getElementById('geoOptimizationScore').textContent = 
                geoData.optimization_score.toFixed(1) + 'ì ';
            
            // ê°•ì  í‘œì‹œ
            const strengthsList = document.getElementById('geoStrengths');
            strengthsList.innerHTML = '';
            geoData.current_site_strengths.forEach(strength => {
                const li = document.createElement('li');
                li.textContent = strength;
                strengthsList.appendChild(li);
            });
            
            // ì•½ì  í‘œì‹œ
            const weaknessesList = document.getElementById('geoWeaknesses');
            weaknessesList.innerHTML = '';
            geoData.current_site_weaknesses.forEach(weakness => {
                const li = document.createElement('li');
                li.textContent = weakness;
                weaknessesList.appendChild(li);
            });
            
            // ìµœì í™” ì œì•ˆ í‘œì‹œ
            if (geoData.optimization_suggestions && geoData.optimization_suggestions.length > 0) {
                document.getElementById('geoSuggestions').style.display = 'block';
                const suggestionsList = document.getElementById('geoSuggestionsList');
                suggestionsList.innerHTML = '';
                geoData.optimization_suggestions.forEach(suggestion => {
                    const li = document.createElement('li');
                    li.textContent = suggestion;
                    suggestionsList.appendChild(li);
                });
            }
            
            // ì§€ë„ ì´ˆê¸°í™”
            if (geoMap) {
                geoMap.remove();
            }
            
            const mapDiv = document.getElementById('geoMap');
            geoMap = L.map(mapDiv).setView(
                [currentCoords.latitude, currentCoords.longitude], 
                14
            );
            
            // OpenStreetMap íƒ€ì¼ ì¶”ê°€
            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                attribution: 'Â© OpenStreetMap contributors',
                maxZoom: 18
            }).addTo(geoMap);
            
            // í˜„ì¬ ìœ„ì¹˜ ë§ˆì»¤ (íŒŒë€ìƒ‰)
            L.marker([currentCoords.latitude, currentCoords.longitude], {
                icon: L.divIcon({
                    className: 'custom-marker',
                    html: '<div style="background: #2196f3; width: 30px; height: 30px; border-radius: 50%; border: 3px solid white; box-shadow: 0 2px 8px rgba(0,0,0,0.3);"></div>',
                    iconSize: [30, 30]
                })
            })
            .bindPopup(`
                <b>ğŸ“ ë¶„ì„ ìœ„ì¹˜ (í˜„ì¬)</b><br>
                ì ìˆ˜: ${geoData.optimization_score.toFixed(1)}ì 
            `)
            .addTo(geoMap);
            
            // ì¶”ì²œ ì‚¬ì´íŠ¸ ë§ˆì»¤
            const allMarkers = [[currentCoords.latitude, currentCoords.longitude]];
            
            geoData.recommended_sites.forEach((site, index) => {
                // ì ìˆ˜ì— ë”°ë¥¸ ìƒ‰ìƒ
                let color = '#4caf50'; // green
                if (site.overall_score < 60) {
                    color = '#f44336'; // red
                } else if (site.overall_score < 80) {
                    color = '#ff9800'; // orange
                }
                
                // ë§ˆì»¤ ì¶”ê°€
                L.marker([site.latitude, site.longitude], {
                    icon: L.divIcon({
                        className: 'custom-marker',
                        html: `<div style="background: ${color}; width: 28px; height: 28px; border-radius: 50%; border: 3px solid white; box-shadow: 0 2px 8px rgba(0,0,0,0.3); display: flex; align-items: center; justify-content: center; color: white; font-weight: bold; font-size: 12px;">${index + 1}</div>`,
                        iconSize: [28, 28]
                    })
                })
                .bindPopup(`
                    <b>ğŸ¯ ì¶”ì²œ ì‚¬ì´íŠ¸ #${index + 1}</b><br>
                    <strong>ì ìˆ˜:</strong> ${site.overall_score.toFixed(1)}ì <br>
                    <strong>ì£¼ì†Œ:</strong> ${site.address}<br>
                    <br>
                    <strong>ì„¸ë¶€ ì ìˆ˜:</strong><br>
                    â€¢ ì ‘ê·¼ì„±: ${site.accessibility_score.toFixed(1)}ì <br>
                    â€¢ ìˆ˜ìš”: ${site.demand_score.toFixed(1)}ì <br>
                    â€¢ ì¸í”„ë¼: ${site.infrastructure_score.toFixed(1)}ì <br>
                    â€¢ í™˜ê²½: ${site.environment_score.toFixed(1)}ì <br>
                    <br>
                    <strong>ê°•ì :</strong><br>
                    ${site.strengths.map(s => 'â€¢ ' + s).join('<br>')}<br>
                    <br>
                    <strong>ì¶”ì²œ ì´ìœ :</strong><br>
                    ${site.recommendation_reason}
                `)
                .addTo(geoMap);
                
                allMarkers.push([site.latitude, site.longitude]);
            });
            
            // ì§€ë„ ë²”ìœ„ ì¡°ì • (ëª¨ë“  ë§ˆì»¤ê°€ ë³´ì´ë„ë¡)
            const bounds = L.latLngBounds(allMarkers);
            geoMap.fitBounds(bounds, { padding: [50, 50] });
            
            // ì¶”ì²œ ì‚¬ì´íŠ¸ ìƒì„¸ ì •ë³´ ì¹´ë“œ
            const sitesDetails = document.getElementById('geoSitesDetails');
            sitesDetails.innerHTML = geoData.recommended_sites.map((site, index) => {
                const scoreColor = site.overall_score >= 80 ? '#4caf50' : 
                                   site.overall_score >= 60 ? '#ff9800' : '#f44336';
                
                return `
                    <div style="background: white; padding: 15px; border-radius: 8px; margin-bottom: 10px; border-left: 4px solid ${scoreColor};">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                            <h5 style="margin: 0; color: #333; font-size: 15px;">
                                ${index === 0 ? 'ğŸ† ' : ''}ì¶”ì²œ ì‚¬ì´íŠ¸ #${index + 1}
                            </h5>
                            <div style="font-size: 24px; font-weight: bold; color: ${scoreColor};">
                                ${site.overall_score.toFixed(1)}ì 
                            </div>
                        </div>
                        <div style="font-size: 13px; color: #666; margin-bottom: 10px;">
                            ğŸ“ ${site.address}
                        </div>
                        <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 8px; margin-bottom: 12px;">
                            <div style="background: #f5f5f5; padding: 8px; border-radius: 6px; text-align: center;">
                                <div style="font-size: 11px; color: #999;">ì ‘ê·¼ì„±</div>
                                <div style="font-size: 16px; font-weight: bold; color: #333;">${site.accessibility_score.toFixed(1)}</div>
                            </div>
                            <div style="background: #f5f5f5; padding: 8px; border-radius: 6px; text-align: center;">
                                <div style="font-size: 11px; color: #999;">ìˆ˜ìš”</div>
                                <div style="font-size: 16px; font-weight: bold; color: #333;">${site.demand_score.toFixed(1)}</div>
                            </div>
                            <div style="background: #f5f5f5; padding: 8px; border-radius: 6px; text-align: center;">
                                <div style="font-size: 11px; color: #999;">ì¸í”„ë¼</div>
                                <div style="font-size: 16px; font-weight: bold; color: #333;">${site.infrastructure_score.toFixed(1)}</div>
                            </div>
                            <div style="background: #f5f5f5; padding: 8px; border-radius: 6px; text-align: center;">
                                <div style="font-size: 11px; color: #999;">í™˜ê²½</div>
                                <div style="font-size: 16px; font-weight: bold; color: #333;">${site.environment_score.toFixed(1)}</div>
                            </div>
                        </div>
                        <div style="background: #e8f5e9; padding: 10px; border-radius: 6px; margin-bottom: 8px;">
                            <strong style="font-size: 12px; color: #2e7d32;">âœ… ê°•ì :</strong>
                            <ul style="margin: 5px 0 0 18px; padding: 0; font-size: 12px; line-height: 1.6;">
                                ${site.strengths.map(s => `<li>${s}</li>`).join('')}
                            </ul>
                        </div>
                        <div style="background: #fff3e0; padding: 10px; border-radius: 6px; margin-bottom: 8px;">
                            <strong style="font-size: 12px; color: #e65100;">âš ï¸ ì•½ì :</strong>
                            <ul style="margin: 5px 0 0 18px; padding: 0; font-size: 12px; line-height: 1.6;">
                                ${site.weaknesses.map(s => `<li>${s}</li>`).join('')}
                            </ul>
                        </div>
                        <div style="font-size: 12px; color: #666; font-style: italic;">
                            ğŸ’¡ ${site.recommendation_reason}
                        </div>
                    </div>
                `;
            }).join('');
        }
    </script>
</body>
</html>
