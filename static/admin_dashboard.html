<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ZeroSite v11.0 HYBRID v2 - Admin Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Noto Sans KR', sans-serif; }
        .gradient-bg { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); }
        .card-hover { transition: all 0.3s ease; }
        .card-hover:hover { transform: translateY(-5px); box-shadow: 0 20px 40px rgba(0,0,0,0.1); }
        .pulse { animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite; }
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: .5; }
        }
        .slide-in { animation: slideIn 0.5s ease-out; }
        @keyframes slideIn {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .version-badge {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            animation: glow 2s ease-in-out infinite alternate;
        }
        @keyframes glow {
            from { box-shadow: 0 0 10px rgba(245, 87, 108, 0.5); }
            to { box-shadow: 0 0 20px rgba(245, 87, 108, 0.8); }
        }
        .progress-ring {
            transition: stroke-dashoffset 0.5s ease;
            transform: rotate(-90deg);
            transform-origin: 50% 50%;
        }
    </style>
</head>
<body class="bg-gray-50">
    <!-- Header -->
    <header class="gradient-bg text-white shadow-2xl">
        <div class="max-w-7xl mx-auto px-6 py-8">
            <div class="flex items-center justify-between">
                <div>
                    <h1 class="text-4xl font-bold mb-2">
                        ğŸ¢ ZeroSite Admin Dashboard
                    </h1>
                    <p class="text-white/80 text-lg">
                        AI-Powered Land Analysis & Report Generation System
                    </p>
                </div>
                <div class="text-right">
                    <div class="version-badge inline-block px-6 py-3 rounded-full text-white font-bold text-lg">
                        v11.0 HYBRID v2
                    </div>
                    <div class="text-white/70 text-sm mt-2">
                        Production Ready | 100% Complete
                    </div>
                </div>
            </div>
        </div>
    </header>

    <div class="max-w-7xl mx-auto px-6 py-8">
        <!-- System Stats -->
        <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
            <div class="bg-white rounded-xl shadow-lg p-6 card-hover">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-gray-500 text-sm font-medium">System Status</p>
                        <p class="text-3xl font-bold text-green-600 mt-2">LIVE</p>
                    </div>
                    <div class="bg-green-100 rounded-full p-4">
                        <svg class="w-8 h-8 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                        </svg>
                    </div>
                </div>
            </div>

            <div class="bg-white rounded-xl shadow-lg p-6 card-hover">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-gray-500 text-sm font-medium">AI Engines</p>
                        <p class="text-3xl font-bold text-blue-600 mt-2">5/5</p>
                    </div>
                    <div class="bg-blue-100 rounded-full p-4">
                        <svg class="w-8 h-8 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 3v2m6-2v2M9 19v2m6-2v2M5 9H3m2 6H3m18-6h-2m2 6h-2M7 19h10a2 2 0 002-2V7a2 2 0 00-2-2H7a2 2 0 00-2 2v10a2 2 0 002 2zM9 9h6v6H9V9z"></path>
                        </svg>
                    </div>
                </div>
            </div>

            <div class="bg-white rounded-xl shadow-lg p-6 card-hover">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-gray-500 text-sm font-medium">Avg. Generation</p>
                        <p class="text-3xl font-bold text-purple-600 mt-2">~11s</p>
                    </div>
                    <div class="bg-purple-100 rounded-full p-4">
                        <svg class="w-8 h-8 text-purple-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
                        </svg>
                    </div>
                </div>
            </div>

            <div class="bg-white rounded-xl shadow-lg p-6 card-hover">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-gray-500 text-sm font-medium">Report Size</p>
                        <p class="text-3xl font-bold text-orange-600 mt-2">~79KB</p>
                    </div>
                    <div class="bg-orange-100 rounded-full p-4">
                        <svg class="w-8 h-8 text-orange-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                        </svg>
                    </div>
                </div>
            </div>
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
            <!-- Report Generation Form -->
            <div class="lg:col-span-2">
                <div class="bg-white rounded-xl shadow-lg p-8">
                    <h2 class="text-2xl font-bold mb-6 flex items-center">
                        <span class="bg-blue-600 text-white rounded-full w-10 h-10 flex items-center justify-center mr-3">1</span>
                        ë¦¬í¬íŠ¸ ìƒì„±
                    </h2>

                    <form id="reportForm" class="space-y-6">
                        <!-- Address -->
                        <div>
                            <label class="block text-sm font-semibold text-gray-700 mb-2">
                                ğŸ“ ì£¼ì†Œ <span class="text-red-500">*</span>
                            </label>
                            <input type="text" id="address" required
                                placeholder="ì˜ˆ: ì„œìš¸íŠ¹ë³„ì‹œ ê°•ë‚¨êµ¬ í…Œí—¤ë€ë¡œ 123"
                                class="w-full px-4 py-3 border-2 border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition">
                            <p class="text-xs text-gray-500 mt-1">ë„ë¡œëª… ì£¼ì†Œ ë˜ëŠ” ì§€ë²ˆ ì£¼ì†Œë¥¼ ì…ë ¥í•˜ì„¸ìš”</p>
                        </div>

                        <!-- Land Area -->
                        <div>
                            <label class="block text-sm font-semibold text-gray-700 mb-2">
                                ğŸ“ ëŒ€ì§€ë©´ì  (mÂ²) <span class="text-red-500">*</span>
                            </label>
                            <input type="number" id="land_area" required min="100"
                                placeholder="ì˜ˆ: 1000"
                                class="w-full px-4 py-3 border-2 border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition">
                        </div>

                        <!-- Land Price -->
                        <div>
                            <label class="block text-sm font-semibold text-gray-700 mb-2">
                                ğŸ’° í† ì§€ ê°ì •ê°€ (ì›) <span class="text-red-500">*</span>
                            </label>
                            <input type="number" id="land_appraisal_price" required min="1000000"
                                placeholder="ì˜ˆ: 9000000000"
                                class="w-full px-4 py-3 border-2 border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition">
                            <p class="text-xs text-gray-500 mt-1">ì „ì²´ í† ì§€ ê°ì •ê°€ (ì›/mÂ² ì•„ë‹˜)</p>
                        </div>

                        <!-- Zone Type -->
                        <div>
                            <label class="block text-sm font-semibold text-gray-700 mb-2">
                                ğŸ˜ï¸ ìš©ë„ì§€ì—­ <span class="text-red-500">*</span>
                            </label>
                            <select id="zone_type" required
                                class="w-full px-4 py-3 border-2 border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition">
                                <option value="">ì„ íƒí•˜ì„¸ìš”</option>
                                <option value="ì œ1ì¢…ì¼ë°˜ì£¼ê±°ì§€ì—­">ì œ1ì¢…ì¼ë°˜ì£¼ê±°ì§€ì—­</option>
                                <option value="ì œ2ì¢…ì¼ë°˜ì£¼ê±°ì§€ì—­">ì œ2ì¢…ì¼ë°˜ì£¼ê±°ì§€ì—­</option>
                                <option value="ì œ3ì¢…ì¼ë°˜ì£¼ê±°ì§€ì—­">ì œ3ì¢…ì¼ë°˜ì£¼ê±°ì§€ì—­</option>
                                <option value="ì¤€ì£¼ê±°ì§€ì—­">ì¤€ì£¼ê±°ì§€ì—­</option>
                            </select>
                        </div>

                        <!-- Language Selection -->
                        <div>
                            <label class="block text-sm font-semibold text-gray-700 mb-2">
                                ğŸŒ ì–¸ì–´ ì„ íƒ
                            </label>
                            <div class="flex space-x-4">
                                <label class="flex items-center">
                                    <input type="radio" name="language" value="ko" checked class="mr-2">
                                    <span>í•œêµ­ì–´</span>
                                </label>
                                <label class="flex items-center">
                                    <input type="radio" name="language" value="en" class="mr-2">
                                    <span>English</span>
                                </label>
                            </div>
                        </div>

                        <!-- Generate Button -->
                        <button type="submit" id="generateBtn"
                            class="w-full bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white font-bold py-4 px-6 rounded-lg transition duration-200 shadow-lg transform hover:scale-105">
                            ğŸš€ ë¦¬í¬íŠ¸ ìƒì„± (HYBRID v2)
                        </button>
                    </form>
                </div>
            </div>

            <!-- Live Results -->
            <div class="lg:col-span-1">
                <div class="bg-white rounded-xl shadow-lg p-8 sticky top-8">
                    <h2 class="text-2xl font-bold mb-6 flex items-center">
                        <span class="bg-green-600 text-white rounded-full w-10 h-10 flex items-center justify-center mr-3">2</span>
                        ì‹¤ì‹œê°„ ê²°ê³¼
                    </h2>

                    <!-- Loading State -->
                    <div id="loadingState" class="hidden">
                        <div class="flex flex-col items-center justify-center py-12">
                            <div class="relative">
                                <svg class="w-24 h-24">
                                    <circle cx="48" cy="48" r="40" stroke="#e5e7eb" stroke-width="8" fill="none"/>
                                    <circle cx="48" cy="48" r="40" stroke="#3b82f6" stroke-width="8" fill="none"
                                        class="progress-ring" stroke-dasharray="251.2" stroke-dashoffset="0" id="progressCircle"/>
                                </svg>
                                <div class="absolute inset-0 flex items-center justify-center">
                                    <span class="text-2xl font-bold text-blue-600" id="progressText">0%</span>
                                </div>
                            </div>
                            <p class="text-gray-600 font-medium mt-4 pulse" id="statusText">ë¶„ì„ ì¤€ë¹„ ì¤‘...</p>
                        </div>
                    </div>

                    <!-- Results State -->
                    <div id="resultsState" class="space-y-4">
                        <div class="text-center text-gray-400 py-12">
                            <svg class="w-20 h-20 mx-auto mb-4 opacity-30" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                            </svg>
                            <p>ë¦¬í¬íŠ¸ë¥¼ ìƒì„±í•˜ë©´<br>ì—¬ê¸°ì— ê²°ê³¼ê°€ í‘œì‹œë©ë‹ˆë‹¤</p>
                        </div>
                    </div>

                    <!-- Success State (hidden initially) -->
                    <div id="successState" class="hidden slide-in space-y-4">
                        <div class="bg-green-50 border-2 border-green-200 rounded-lg p-4">
                            <div class="flex items-center justify-between mb-3">
                                <span class="text-sm font-semibold text-gray-700">LH ì ìˆ˜</span>
                                <span class="text-2xl font-bold text-green-600" id="resultLhScore">-</span>
                            </div>
                            <div class="flex items-center justify-between mb-3">
                                <span class="text-sm font-semibold text-gray-700">ë“±ê¸‰</span>
                                <span class="text-xl font-bold text-blue-600" id="resultGrade">-</span>
                            </div>
                            <div class="flex items-center justify-between mb-3">
                                <span class="text-sm font-semibold text-gray-700">ì˜ì‚¬ê²°ì •</span>
                                <span class="text-xl font-bold text-purple-600" id="resultDecision">-</span>
                            </div>
                            <div class="flex items-center justify-between">
                                <span class="text-sm font-semibold text-gray-700">ì„¸ëŒ€ìˆ˜</span>
                                <span class="text-xl font-bold text-orange-600" id="resultUnitCount">-</span>
                            </div>
                        </div>

                        <div class="bg-blue-50 border-2 border-blue-200 rounded-lg p-4">
                            <p class="text-sm text-gray-600 mb-2">ë¦¬í¬íŠ¸ í¬ê¸°</p>
                            <p class="text-lg font-bold text-blue-600" id="resultSize">-</p>
                            <p class="text-xs text-gray-500 mt-1" id="resultPages">-</p>
                        </div>

                        <div class="space-y-2">
                            <button onclick="viewReport()" 
                                class="w-full bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-700 hover:to-pink-700 text-white font-bold py-3 px-4 rounded-lg transition duration-200 shadow-lg">
                                ğŸ‘ï¸ HTML ë³´ê¸°
                            </button>
                            <button onclick="downloadPDF()"
                                class="w-full bg-gradient-to-r from-green-600 to-teal-600 hover:from-green-700 hover:to-teal-700 text-white font-bold py-3 px-4 rounded-lg transition duration-200 shadow-lg">
                                ğŸ“¥ PDF ë‹¤ìš´ë¡œë“œ
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Features Section -->
        <div class="mt-12 bg-gradient-to-r from-indigo-50 to-purple-50 rounded-xl shadow-lg p-8">
            <h3 class="text-2xl font-bold mb-6 text-center">ğŸ¯ HYBRID v2 Features</h3>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-6">
                <div class="bg-white rounded-lg p-4 text-center">
                    <div class="text-3xl mb-2">ğŸ¤–</div>
                    <h4 class="font-bold text-sm mb-1">AI Engines</h4>
                    <p class="text-xs text-gray-600">5 AI ë¶„ì„ ì—”ì§„</p>
                </div>
                <div class="bg-white rounded-lg p-4 text-center">
                    <div class="text-3xl mb-2">ğŸ“Š</div>
                    <h4 class="font-bold text-sm mb-1">LH Scoring</h4>
                    <p class="text-xs text-gray-600">100ì  í‰ê°€ ì‹œìŠ¤í…œ</p>
                </div>
                <div class="bg-white rounded-lg p-4 text-center">
                    <div class="text-3xl mb-2">ğŸ¯</div>
                    <h4 class="font-bold text-sm mb-1">Decision Engine</h4>
                    <p class="text-xs text-gray-600">GO/REVIEW/NO-GO</p>
                </div>
                <div class="bg-white rounded-lg p-4 text-center">
                    <div class="text-3xl mb-2">ğŸ˜ï¸</div>
                    <h4 class="font-bold text-sm mb-1">Unit Analysis</h4>
                    <p class="text-xs text-gray-600">5 types Ã— 6 criteria</p>
                </div>
                <div class="bg-white rounded-lg p-4 text-center">
                    <div class="text-3xl mb-2">âœï¸</div>
                    <h4 class="font-bold text-sm mb-1">v7.5 Narratives</h4>
                    <p class="text-xs text-gray-600">ì „ë¬¸ê°€ê¸‰ ì„œìˆ </p>
                </div>
            </div>
        </div>
    </div>

    <script>
        const API_URL = '/api/v9/real/generate-report';
        let lastReportData = null;

        document.getElementById('reportForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            
            // Get form data
            const formData = {
                address: document.getElementById('address').value,
                land_area: parseFloat(document.getElementById('land_area').value),
                land_appraisal_price: parseFloat(document.getElementById('land_appraisal_price').value),
                zone_type: document.getElementById('zone_type').value,
                output_format: 'html',
                language: document.querySelector('input[name="language"]:checked').value
            };

            // Show loading
            document.getElementById('resultsState').classList.add('hidden');
            document.getElementById('successState').classList.add('hidden');
            document.getElementById('loadingState').classList.remove('hidden');
            document.getElementById('generateBtn').disabled = true;
            document.getElementById('generateBtn').innerHTML = 'â³ ìƒì„± ì¤‘...';

            // Simulate progress
            let progress = 0;
            const progressInterval = setInterval(() => {
                progress = Math.min(progress + Math.random() * 15, 95);
                updateProgress(progress);
            }, 500);

            try {
                const response = await fetch(API_URL, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(formData)
                });

                clearInterval(progressInterval);
                updateProgress(100);

                if (!response.ok) {
                    throw new Error(`API Error: ${response.status}`);
                }

                const data = await response.json();
                
                if (data.ok && data.report) {
                    lastReportData = data;
                    displayResults(data);
                } else {
                    throw new Error(data.error?.message || 'Report generation failed');
                }

            } catch (error) {
                clearInterval(progressInterval);
                console.error('Error:', error);
                alert('âŒ ì˜¤ë¥˜ ë°œìƒ: ' + error.message);
                document.getElementById('loadingState').classList.add('hidden');
                document.getElementById('resultsState').classList.remove('hidden');
            } finally {
                document.getElementById('generateBtn').disabled = false;
                document.getElementById('generateBtn').innerHTML = 'ğŸš€ ë¦¬í¬íŠ¸ ìƒì„± (HYBRID v2)';
            }
        });

        function updateProgress(percent) {
            const circle = document.getElementById('progressCircle');
            const text = document.getElementById('progressText');
            const status = document.getElementById('statusText');
            
            const circumference = 251.2;
            const offset = circumference - (percent / 100) * circumference;
            circle.style.strokeDashoffset = offset;
            text.textContent = Math.round(percent) + '%';

            if (percent < 30) {
                status.textContent = 'ğŸ” ì£¼ì†Œ ë¶„ì„ ì¤‘...';
            } else if (percent < 60) {
                status.textContent = 'ğŸ¤– AI ì—”ì§„ ì‹¤í–‰ ì¤‘...';
            } else if (percent < 90) {
                status.textContent = 'ğŸ“Š ë¦¬í¬íŠ¸ ìƒì„± ì¤‘...';
            } else {
                status.textContent = 'âœ¨ ë§ˆë¬´ë¦¬ ì¤‘...';
            }
        }

        function displayResults(data) {
            const summary = data.analysis_summary || {};
            const report = data.report || {};

            // Update result values
            document.getElementById('resultLhScore').textContent = summary.lh_score || '-';
            document.getElementById('resultGrade').textContent = summary.lh_grade || '-';
            document.getElementById('resultDecision').textContent = summary.decision || '-';
            document.getElementById('resultUnitCount').textContent = (summary.unit_count || '-') + ' ì„¸ëŒ€';
            
            const sizeKB = report.content ? (report.content.length / 1024).toFixed(1) : '0';
            const pages = report.content ? Math.ceil(report.content.length / 3000) : 0;
            document.getElementById('resultSize').textContent = sizeKB + ' KB';
            document.getElementById('resultPages').textContent = `ì•½ ${pages} í˜ì´ì§€`;

            // Show success state
            document.getElementById('loadingState').classList.add('hidden');
            document.getElementById('successState').classList.remove('hidden');

            // Show notification
            showNotification('âœ… ë¦¬í¬íŠ¸ ìƒì„± ì™„ë£Œ!', 'success');
        }

        function viewReport() {
            if (lastReportData && lastReportData.report && lastReportData.report.content) {
                const reportWindow = window.open('', '_blank');
                reportWindow.document.write(lastReportData.report.content);
                reportWindow.document.close();
            } else {
                alert('ë¦¬í¬íŠ¸ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.');
            }
        }

        async function downloadPDF() {
            if (!lastReportData) {
                alert('ë¨¼ì € ë¦¬í¬íŠ¸ë¥¼ ìƒì„±í•´ì£¼ì„¸ìš”.');
                return;
            }

            const formData = {
                address: document.getElementById('address').value,
                land_area: parseFloat(document.getElementById('land_area').value),
                land_appraisal_price: parseFloat(document.getElementById('land_appraisal_price').value),
                zone_type: document.getElementById('zone_type').value,
                output_format: 'pdf',
                language: document.querySelector('input[name="language"]:checked').value
            };

            showNotification('ğŸ“¥ PDF ìƒì„± ì¤‘...', 'info');

            try {
                const response = await fetch(API_URL, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(formData)
                });

                if (response.ok) {
                    const blob = await response.blob();
                    const url = window.URL.createObjectURL(blob);
                    const a = document.createElement('a');
                    a.href = url;
                    a.download = `ZeroSite_HYBRID_v2_${Date.now()}.pdf`;
                    document.body.appendChild(a);
                    a.click();
                    window.URL.revokeObjectURL(url);
                    document.body.removeChild(a);
                    
                    showNotification('âœ… PDF ë‹¤ìš´ë¡œë“œ ì™„ë£Œ!', 'success');
                } else {
                    throw new Error('PDF generation failed');
                }
            } catch (error) {
                console.error('PDF Error:', error);
                alert('âŒ PDF ìƒì„± ì‹¤íŒ¨: ' + error.message);
            }
        }

        function showNotification(message, type) {
            // Simple notification - can be enhanced with a library
            const bgColor = type === 'success' ? 'bg-green-500' : type === 'error' ? 'bg-red-500' : 'bg-blue-500';
            const notification = document.createElement('div');
            notification.className = `fixed top-4 right-4 ${bgColor} text-white px-6 py-3 rounded-lg shadow-lg z-50 slide-in`;
            notification.textContent = message;
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.remove();
            }, 3000);
        }
    </script>
</body>
</html>
