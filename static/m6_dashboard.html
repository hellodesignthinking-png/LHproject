<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ZeroSite M6 - LH Ï¢ÖÌï© ÌåêÎã®</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Malgun Gothic', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        /* Hero Card */
        .hero-card {
            background: white;
            border-radius: 20px;
            padding: 40px;
            margin-bottom: 20px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
            text-align: center;
        }
        
        .hero-title {
            font-size: 18px;
            color: #666;
            margin-bottom: 10px;
        }
        
        .decision {
            font-size: 48px;
            font-weight: bold;
            margin: 20px 0;
        }
        
        .decision.go {
            color: #28a745;
        }
        
        .decision.conditional {
            color: #ffc107;
        }
        
        .decision.no-go {
            color: #dc3545;
        }
        
        .decision-icon {
            font-size: 64px;
            margin-bottom: 10px;
        }
        
        .probability {
            font-size: 20px;
            color: #333;
            margin-bottom: 10px;
        }
        
        .confidence {
            font-size: 16px;
            color: #666;
        }
        
        .action-buttons {
            margin-top: 30px;
            display: flex;
            gap: 15px;
            justify-content: center;
        }
        
        .btn {
            padding: 15px 30px;
            border: none;
            border-radius: 10px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .btn-primary {
            background: #667eea;
            color: white;
        }
        
        .btn-primary:hover {
            background: #5568d3;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }
        
        .btn-secondary {
            background: #6c757d;
            color: white;
        }
        
        .btn-secondary:hover {
            background: #5a6268;
        }
        
        /* Module Evaluation Card */
        .eval-card {
            background: white;
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 20px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
        }
        
        .card-title {
            font-size: 24px;
            font-weight: bold;
            color: #333;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .modules-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
        }
        
        .module-item {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            border-left: 5px solid #ddd;
        }
        
        .module-item.pass {
            border-left-color: #28a745;
            background: #d4edda;
        }
        
        .module-item.warning {
            border-left-color: #ffc107;
            background: #fff3cd;
        }
        
        .module-item.fail {
            border-left-color: #dc3545;
            background: #f8d7da;
        }
        
        .module-name {
            font-weight: bold;
            font-size: 18px;
            margin-bottom: 10px;
        }
        
        .module-status {
            display: inline-block;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: bold;
            margin-bottom: 10px;
        }
        
        .status-pass {
            background: #28a745;
            color: white;
        }
        
        .status-warning {
            background: #ffc107;
            color: #333;
        }
        
        .status-fail {
            background: #dc3545;
            color: white;
        }
        
        .module-points {
            font-size: 14px;
            color: #666;
            line-height: 1.6;
        }
        
        .module-points li {
            margin-bottom: 5px;
        }
        
        /* Supplement Conditions Card */
        .conditions-list {
            list-style: none;
        }
        
        .condition-item {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 15px;
            border-left: 5px solid #ddd;
        }
        
        .condition-item.high {
            border-left-color: #dc3545;
        }
        
        .condition-item.medium {
            border-left-color: #ffc107;
        }
        
        .condition-item.low {
            border-left-color: #28a745;
        }
        
        .condition-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }
        
        .condition-priority {
            display: inline-block;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: bold;
        }
        
        .priority-high {
            background: #dc3545;
            color: white;
        }
        
        .priority-medium {
            background: #ffc107;
            color: #333;
        }
        
        .priority-low {
            background: #28a745;
            color: white;
        }
        
        .condition-content {
            font-size: 16px;
            color: #333;
            line-height: 1.6;
        }
        
        /* Community & Complaint Card */
        .community-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }
        
        .community-section {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
        }
        
        .section-title {
            font-weight: bold;
            font-size: 16px;
            margin-bottom: 10px;
            color: #333;
        }
        
        .section-content {
            font-size: 14px;
            color: #666;
            line-height: 1.6;
        }
        
        .section-content li {
            margin-bottom: 8px;
        }
        
        /* Responsive */
        @media (max-width: 768px) {
            .hero-card {
                padding: 30px 20px;
            }
            
            .decision {
                font-size: 36px;
            }
            
            .modules-grid {
                grid-template-columns: 1fr;
            }
            
            .action-buttons {
                flex-direction: column;
            }
            
            .btn {
                width: 100%;
            }
        }
        
        /* Loading State */
        .loading {
            text-align: center;
            padding: 40px;
            color: white;
            font-size: 18px;
        }
        
        .spinner {
            border: 5px solid #f3f3f3;
            border-top: 5px solid #667eea;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
            margin: 20px auto;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Loading State -->
        <div id="loading" class="loading">
            <div class="spinner"></div>
            <p>M6 Ï¢ÖÌï© ÌåêÎã® Í≤∞Í≥ºÎ•º Î∂àÎü¨Ïò§Îäî Ï§ë...</p>
        </div>
        
        <!-- Main Content (Hidden initially) -->
        <div id="main-content" style="display: none;">
            <!-- Hero Card: ÏµúÏ¢Ö ÌåêÎã® -->
            <div class="hero-card">
                <div class="hero-title">üéØ LH Ï¢ÖÌï© ÌåêÎã® Í≤∞Í≥º</div>
                <div class="decision-icon" id="decision-icon">üü¢</div>
                <div class="decision go" id="decision-text">GO (Ï°∞Í±¥Î∂Ä)</div>
                <div class="probability" id="probability-text">LH Îß§ÏûÖ Í∞ÄÎä•ÏÑ±: ÎÜíÏùå</div>
                <div class="confidence" id="confidence-text">Ïã†Î¢∞ÎèÑ: 85%</div>
                
                <div class="action-buttons">
                    <button class="btn btn-primary" onclick="downloadPDF()">
                        üìÑ PDF Îã§Ïö¥Î°úÎìú
                    </button>
                    <button class="btn btn-secondary" onclick="viewDetailedReport()">
                        üìä ÏÉÅÏÑ∏ Î≥¥Í≥†ÏÑú Î≥¥Í∏∞
                    </button>
                </div>
            </div>
            
            <!-- Module Evaluation Card: Î™®ÎìàÎ≥Ñ ÌèâÍ∞Ä -->
            <div class="eval-card">
                <div class="card-title">
                    üìä Î™®ÎìàÎ≥Ñ ÌèâÍ∞Ä
                </div>
                <div class="modules-grid" id="modules-grid">
                    <!-- Dynamic content will be inserted here -->
                </div>
            </div>
            
            <!-- Supplement Conditions Card: Î≥¥ÏôÑ Ï°∞Í±¥ -->
            <div class="eval-card">
                <div class="card-title">
                    ‚ö†Ô∏è Î≥¥ÏôÑ Ï°∞Í±¥
                </div>
                <ul class="conditions-list" id="conditions-list">
                    <!-- Dynamic content will be inserted here -->
                </ul>
            </div>
            
            <!-- Community & Complaint Defense Card -->
            <div class="eval-card">
                <div class="card-title">
                    üèòÔ∏è Ïª§ÎÆ§ÎãàÌã∞ & ÎØºÏõê Î∞©Ïñ¥
                </div>
                <div class="community-grid">
                    <div class="community-section">
                        <div class="section-title">ÏòàÏÉÅ ÎØºÏõê Ïú†Ìòï</div>
                        <ul class="section-content" id="complaint-types">
                            <!-- Dynamic content -->
                        </ul>
                    </div>
                    <div class="community-section">
                        <div class="section-title">ÎåÄÏùë Ï†ÑÎûµ</div>
                        <ul class="section-content" id="mitigation-strategies">
                            <!-- Dynamic content -->
                        </ul>
                    </div>
                    <div class="community-section">
                        <div class="section-title">Í¥ÄÎ¶¨ Ï£ºÏ≤¥</div>
                        <div class="section-content" id="management-entity">
                            <!-- Dynamic content -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        // API Base URL (ÌôòÍ≤ΩÏóê Îî∞Îùº Î≥ÄÍ≤Ω)
        const API_BASE_URL = window.location.origin;
        
        // Context ID (URL ÌååÎùºÎØ∏ÌÑ∞ÏóêÏÑú Í∞ÄÏ†∏Ïò§Í∏∞)
        const urlParams = new URLSearchParams(window.location.search);
        const contextId = urlParams.get('context_id') || 'test-context-123';
        const projectId = urlParams.get('project_id') || 'test-project-123';
        
        // Load M6 Data
        async function loadM6Data() {
            try {
                // M6 Í≤∞Í≥º Í∞ÄÏ†∏Ïò§Í∏∞
                const response = await fetch(`${API_BASE_URL}/api/projects/${projectId}/modules/M6/result?context_id=${contextId}`);
                
                if (!response.ok) {
                    throw new Error('M6 Îç∞Ïù¥ÌÑ∞Î•º Î∂àÎü¨Ïò¨ Ïàò ÏóÜÏäµÎãàÎã§.');
                }
                
                const data = await response.json();
                
                // Render data
                renderHeroCard(data);
                renderModules(data.module_evaluations);
                renderConditions(data.supplement_conditions);
                
                // Load M7 data for community section
                await loadM7Data();
                
                // Show main content
                document.getElementById('loading').style.display = 'none';
                document.getElementById('main-content').style.display = 'block';
                
            } catch (error) {
                console.error('Error loading M6 data:', error);
                // Load mock data for demo
                loadMockData();
            }
        }
        
        // Load M7 Data
        async function loadM7Data() {
            try {
                const response = await fetch(`${API_BASE_URL}/api/projects/${projectId}/modules/M7/result?context_id=${contextId}`);
                
                if (!response.ok) {
                    throw new Error('M7 Îç∞Ïù¥ÌÑ∞Î•º Î∂àÎü¨Ïò¨ Ïàò ÏóÜÏäµÎãàÎã§.');
                }
                
                const data = await response.json();
                renderCommunity(data);
                
            } catch (error) {
                console.error('Error loading M7 data:', error);
                renderCommunityMock();
            }
        }
        
        // Render Hero Card
        function renderHeroCard(data) {
            const decision = data.final_decision;
            const probability = data.lh_submission_probability;
            const confidence = Math.round(data.confidence_score * 100);
            
            // Update icon
            const iconMap = {
                'GO': 'üü¢',
                'CONDITIONAL': 'üü°',
                'NO-GO': 'üî¥'
            };
            document.getElementById('decision-icon').textContent = iconMap[decision.split(' ')[0]] || 'üü°';
            
            // Update decision text
            const decisionEl = document.getElementById('decision-text');
            decisionEl.textContent = decision;
            decisionEl.className = 'decision ' + (decision.includes('GO') && !decision.includes('NO') ? 'go' : decision.includes('CONDITIONAL') ? 'conditional' : 'no-go');
            
            // Update probability
            document.getElementById('probability-text').textContent = `LH Îß§ÏûÖ Í∞ÄÎä•ÏÑ±: ${probability}`;
            
            // Update confidence
            document.getElementById('confidence-text').textContent = `Ïã†Î¢∞ÎèÑ: ${confidence}%`;
        }
        
        // Render Modules
        function renderModules(modules) {
            const grid = document.getElementById('modules-grid');
            grid.innerHTML = '';
            
            modules.forEach(module => {
                const statusClass = module.status.toLowerCase();
                const statusText = {
                    'PASS': 'ÌÜµÍ≥º',
                    'WARNING': 'Í≤ΩÍ≥†',
                    'FAIL': 'Ïã§Ìå®'
                }[module.status] || module.status;
                
                const item = document.createElement('div');
                item.className = `module-item ${statusClass}`;
                item.innerHTML = `
                    <div class="module-name">${module.module_name}</div>
                    <span class="module-status status-${statusClass}">${statusText}</span>
                    <ul class="module-points">
                        ${module.key_points.map(point => `<li>‚Ä¢ ${point}</li>`).join('')}
                    </ul>
                `;
                grid.appendChild(item);
            });
        }
        
        // Render Conditions
        function renderConditions(conditions) {
            const list = document.getElementById('conditions-list');
            list.innerHTML = '';
            
            if (conditions.length === 0) {
                list.innerHTML = '<li style="list-style: none; padding: 20px; text-align: center; color: #666;">Î≥¥ÏôÑ Ï°∞Í±¥Ïù¥ ÏóÜÏäµÎãàÎã§.</li>';
                return;
            }
            
            conditions.forEach(condition => {
                const priorityClass = condition.priority.toLowerCase();
                const priorityText = {
                    'HIGH': 'ÎÜíÏùå',
                    'MEDIUM': 'Î≥¥ÌÜµ',
                    'LOW': 'ÎÇÆÏùå'
                }[condition.priority] || condition.priority;
                
                const item = document.createElement('li');
                item.className = `condition-item ${priorityClass}`;
                item.innerHTML = `
                    <div class="condition-header">
                        <strong>${condition.category}</strong>
                        <span class="condition-priority priority-${priorityClass}">${priorityText}</span>
                    </div>
                    <div class="condition-content">${condition.condition}</div>
                `;
                list.appendChild(item);
            });
        }
        
        // Render Community
        function renderCommunity(data) {
            // Complaint Types
            const typesEl = document.getElementById('complaint-types');
            typesEl.innerHTML = data.complaint_mitigation
                .map(item => `<li>‚Ä¢ ${item.complaint_type}</li>`)
                .join('');
            
            // Mitigation Strategies
            const strategiesEl = document.getElementById('mitigation-strategies');
            strategiesEl.innerHTML = data.complaint_mitigation
                .map(item => `<li>‚Ä¢ ${item.mitigation_strategy}</li>`)
                .join('');
            
            // Management Entity
            document.getElementById('management-entity').textContent = data.operation_model;
        }
        
        // Render Community Mock Data
        function renderCommunityMock() {
            document.getElementById('complaint-types').innerHTML = `
                <li>‚Ä¢ ÏÜåÏùå (Í≥µÏö© Í≥µÍ∞Ñ Ïù¥Ïö©)</li>
                <li>‚Ä¢ Ï£ºÏ∞® Î∂ÄÏ°±</li>
                <li>‚Ä¢ Ïô∏Î∂ÄÏù∏ Ïú†ÏûÖ</li>
            `;
            
            document.getElementById('mitigation-strategies').innerHTML = `
                <li>‚Ä¢ ÏïºÍ∞Ñ(22Ïãú~07Ïãú) Í≥µÏö© Í≥µÍ∞Ñ Ïù¥Ïö© Ï†úÌïú</li>
                <li>‚Ä¢ Î≤ïÏ†ï Í∏∞Ï§Ä +10% Ï£ºÏ∞® ÌôïÎ≥¥</li>
                <li>‚Ä¢ ÏûÖÏ£ºÏûê Ï†ÑÏö© Í≥µÍ∞Ñ, Ï∂úÏûÖ ÌÜµÏ†ú</li>
            `;
            
            document.getElementById('management-entity').textContent = 'LH ÏúÑÌÉÅ Ïö¥ÏòÅ';
        }
        
        // Load Mock Data (for demo)
        function loadMockData() {
            const mockData = {
                final_decision: 'GO (Ï°∞Í±¥Î∂Ä)',
                lh_submission_probability: 'ÎÜíÏùå',
                confidence_score: 0.85,
                module_evaluations: [
                    {
                        module_name: 'M1 ÏÇ¨Ïã§ ÌôïÏ†ï',
                        status: 'PASS',
                        key_points: ['FROZEN ÏôÑÎ£å', 'ÌïÑÏàò Ìï≠Î™© Í≤ÄÏ¶ù ÌÜµÍ≥º']
                    },
                    {
                        module_name: 'M2 ÌÜ†ÏßÄ Îß§ÏûÖ Ï†ÅÏ†ïÏÑ±',
                        status: 'PASS',
                        key_points: ['Ï†ÅÏ†ï Îß§ÏûÖÍ∞Ä 420ÏñµÏõê', 'Ïã†Î¢∞ÎèÑ 82%']
                    },
                    {
                        module_name: 'M3 Í≥µÍ∏âÏú†Ìòï Ï†ÅÌï©ÏÑ±',
                        status: 'PASS',
                        key_points: ['Ï≤≠ÎÖÑ Îß§ÏûÖÏûÑÎåÄ', 'LH ÌÜµÍ≥º Ï†êÏàò 85Ï†ê']
                    },
                    {
                        module_name: 'M4 Í±¥Ï∂ï Í∑úÎ™®',
                        status: 'PASS',
                        key_points: ['ÏÑ∏ÎåÄÏàò 240ÏÑ∏ÎåÄ', 'Î≥¥ÏàòÏ†Å ÏÑ§Í≥Ñ Ï†ÅÏö©']
                    },
                    {
                        module_name: 'M5 ÏÇ¨ÏóÖÏÑ±¬∑Î¶¨Ïä§ÌÅ¨',
                        status: 'PASS',
                        key_points: ['ÏïàÏ†Ñ ÎßàÏßÑ 12.76%', 'Î¶¨Ïä§ÌÅ¨ Í¥ÄÎ¶¨ Í∞ÄÎä•']
                    },
                    {
                        module_name: 'M7 Ïª§ÎÆ§ÎãàÌã∞ Í≥ÑÌöç',
                        status: 'PASS',
                        key_points: ['Ï≤≠ÎÖÑ ÏÉùÌôúÏïàÏ†ïÌòï', 'ÎØºÏõê Î∞©Ïñ¥ Ï†ÑÎûµ ÏàòÎ¶Ω']
                    }
                ],
                supplement_conditions: [
                    {
                        category: 'M5 ÏÇ¨ÏóÖÏÑ±',
                        condition: 'Îß§ÏûÖÍ∞Ä ÏÉÅÎã® 3% Ïù¥ÎÇ¥ Í∂åÍ≥†',
                        priority: 'HIGH'
                    },
                    {
                        category: 'M4 Í±¥Ï∂ï Í∑úÎ™®',
                        condition: 'Ï£ºÏ∞®ÎåÄÏàò +5% ÌôïÎ≥¥',
                        priority: 'MEDIUM'
                    },
                    {
                        category: 'M7 Ïö¥ÏòÅ',
                        condition: 'Ïö¥ÏòÅÍ∑úÏπô ÏÇ¨Ï†Ñ Î™ÖÎ¨∏Ìôî',
                        priority: 'LOW'
                    }
                ]
            };
            
            renderHeroCard(mockData);
            renderModules(mockData.module_evaluations);
            renderConditions(mockData.supplement_conditions);
            renderCommunityMock();
            
            document.getElementById('loading').style.display = 'none';
            document.getElementById('main-content').style.display = 'block';
        }
        
        // Download PDF
        function downloadPDF() {
            window.location.href = `${API_BASE_URL}/api/reports/integrated/${contextId}/pdf`;
        }
        
        // View Detailed Report
        function viewDetailedReport() {
            window.open(`${API_BASE_URL}/api/reports/integrated/${contextId}/html`, '_blank');
        }
        
        // Initialize
        window.addEventListener('DOMContentLoaded', () => {
            loadM6Data();
        });
    </script>
</body>
</html>
