# ğŸš€ ZeroSite v1.6.0 Release Notes

**Release Date**: 2026-01-01  
**Version**: v1.6.0 - Access Control & Monitoring  
**Status**: âœ… Production Ready

---

## ğŸ“Š Overview

v1.6.0ì€ **ì ‘ê·¼ ì œì–´ ë° ëª¨ë‹ˆí„°ë§**ì— ì§‘ì¤‘í•œ ë©”ì´ì € ì—…ë°ì´íŠ¸ì…ë‹ˆë‹¤. ëª¨ë“  ë³´ê³ ì„œ ì ‘ê·¼ì„ ì¶”ì í•˜ê³ , ë‹¤ìš´ë¡œë“œ ì œí•œì„ ì ìš©í•˜ë©°, IP í™”ì´íŠ¸ë¦¬ìŠ¤íŠ¸ë¥¼ ê´€ë¦¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### ğŸ¯ í•µì‹¬ ê¸°ëŠ¥

1. **ì ‘ê·¼ ë¡œê·¸ ì‹œìŠ¤í…œ**: ëª¨ë“  ë³´ê³ ì„œ ì ‘ê·¼ ìë™ ë¡œê¹…
2. **ë‹¤ìš´ë¡œë“œ ì œí•œ**: ë³´ê³ ì„œë‹¹ 10íšŒ ë‹¤ìš´ë¡œë“œ ì œí•œ
3. **IP í™”ì´íŠ¸ë¦¬ìŠ¤íŠ¸**: ADMIN ì „ìš© IP ì ‘ê·¼ ì œì–´
4. **Report C êµ¬í˜„**: LH ê¸°ìˆ ê²€í†  ë³´ê³ ì„œ ì™„ì„±
5. **RUN_ID ë°ì´í„° ì—°ë™**: ì‹¤ì œ ë°ì´í„° ì¡°íšŒ ë° ê²€ìƒ‰

---

## ğŸ†• New Features

### 1. ì ‘ê·¼ ë¡œê·¸ ì‹œìŠ¤í…œ (Phase 1)

#### ğŸ“¦ Models & Storage
- `AccessLog`: ëª¨ë“  ë³´ê³ ì„œ ì ‘ê·¼ ì¶”ì 
- `DownloadLimit`: ë‹¤ìš´ë¡œë“œ íšŸìˆ˜ ê´€ë¦¬
- `IPWhitelist`: IP ì£¼ì†Œ í™”ì´íŠ¸ë¦¬ìŠ¤íŠ¸
- `AccessLogStorage`: íŒŒì¼ ê¸°ë°˜ ì €ì¥ì†Œ (JSONL + JSON)

**ì €ì¥ ê²½ë¡œ**:
- ì ‘ê·¼ ë¡œê·¸: `/tmp/zerosite_access_logs/access_logs.jsonl`
- ë‹¤ìš´ë¡œë“œ ì œí•œ: `/tmp/zerosite_access_logs/download_limits.json`
- IP í™”ì´íŠ¸ë¦¬ìŠ¤íŠ¸: `/tmp/zerosite_access_logs/ip_whitelist.json`

#### ğŸ›¡ï¸ Middleware
- `AccessLoggingMiddleware`: ìë™ ë¡œê¹…
- ìº¡ì²˜ ì •ë³´: ì‚¬ìš©ì, IP, ì•¡ì…˜, ì‘ë‹µì‹œê°„, ì„±ê³µ/ì‹¤íŒ¨
- ì ìš© ê²½ë¡œ: `/api/v4/reports/*`, `/dashboard`, `/share/create`

#### ğŸ”Œ API Endpoints
```
GET /api/v4/access-logs/logs              # ë¡œê·¸ ì¡°íšŒ (í•„í„°ë§, í˜ì´ì§€ë„¤ì´ì…˜)
GET /api/v4/access-logs/statistics        # í†µê³„ ì¡°íšŒ
GET /api/v4/access-logs/download-limit    # ë‹¤ìš´ë¡œë“œ ì œí•œ í™•ì¸
GET /api/v4/access-logs/whitelist         # IP í™”ì´íŠ¸ë¦¬ìŠ¤íŠ¸ ì¡°íšŒ
POST /api/v4/access-logs/whitelist/add    # IP ì¶”ê°€
DELETE /api/v4/access-logs/whitelist/{id} # IP ì œê±°
GET /api/v4/access-logs/recent-activity   # ìµœê·¼ í™œë™
```

**ê¶Œí•œ**: ADMINë§Œ ì „ì²´ ë¡œê·¸ ì ‘ê·¼, ì¼ë°˜ ì‚¬ìš©ìëŠ” ë³¸ì¸ ë¡œê·¸ë§Œ

---

### 2. ì ‘ê·¼ ë¡œê·¸ ëŒ€ì‹œë³´ë“œ (Phase 2)

#### ğŸ–¥ï¸ Web Interface
- **URL**: `/access-logs?user=admin@zerosite.com`
- **Features**:
  - ì‹¤ì‹œê°„ í†µê³„ ì¹´ë“œ (ì´ ì ‘ê·¼, ì‚¬ìš©ì, IP, ì‹¤íŒ¨)
  - ì•¡ì…˜ë³„ ì°¨íŠ¸ (HTML/PDF/ê³µìœ /ëŒ€ì‹œë³´ë“œ)
  - ë³´ê³ ì„œë³„ ì°¨íŠ¸
  - í•„í„°ë§ (RUN_ID, ì‚¬ìš©ì, ì•¡ì…˜, ì‹œê°„)
  - í˜ì´ì§€ë„¤ì´ì…˜
  - ìë™ ìƒˆë¡œê³ ì¹¨ (30ì´ˆ)

#### ğŸ“ˆ Statistics
- ì´ ì ‘ê·¼ íšŸìˆ˜
- ê³ ìœ  ì‚¬ìš©ì ìˆ˜
- ê³ ìœ  IP ìˆ˜
- ì‹¤íŒ¨í•œ ìš”ì²­ ìˆ˜
- ì•¡ì…˜ë³„/ë³´ê³ ì„œë³„ ë¶„í¬

---

### 3. ë‹¤ìš´ë¡œë“œ ì œí•œ ì‹œìŠ¤í…œ (Phase 1)

#### â±ï¸ Download Limits
- **ê¸°ë³¸ ì œí•œ**: ë³´ê³ ì„œë‹¹ 10íšŒ ë‹¤ìš´ë¡œë“œ
- **ì¶”ì  ë‹¨ìœ„**: ì‚¬ìš©ì ì´ë©”ì¼ OR ê³µìœ  í† í°
- **ì‘ë‹µ**: HTTP 429 (Too Many Requests)

#### ğŸ”§ Implementation
```python
from app.security.download_limit import check_download_limit

check_download_limit(
    run_id="TEST_6REPORT",
    report_type="master",
    user_email="admin@zerosite.com"
)
```

**ì—ëŸ¬ ë©”ì‹œì§€ (ì œí•œ ì´ˆê³¼ ì‹œ)**:
```json
{
  "error": "Download limit exceeded",
  "message": "You have reached the maximum download limit (10) for this report.",
  "run_id": "TEST_6REPORT",
  "report_type": "master",
  "download_count": 10,
  "max_downloads": 10
}
```

---

### 4. IP í™”ì´íŠ¸ë¦¬ìŠ¤íŠ¸ ì‹œìŠ¤í…œ (Phase 1)

#### ğŸ›¡ï¸ IP Whitelist
- **ê´€ë¦¬**: ADMIN ì „ìš©
- **ì§€ì›**: IP ì£¼ì†Œ ë˜ëŠ” CIDR (í–¥í›„)
- **ìƒíƒœ**: í™œì„±í™”/ë¹„í™œì„±í™”

#### ğŸ“ Management
```bash
# IP ì¶”ê°€
POST /api/v4/access-logs/whitelist/add
  ?ip_address=192.168.1.100
  &description=ë³¸ì‚¬ ì‚¬ë¬´ì‹¤

# IP ì œê±°
DELETE /api/v4/access-logs/whitelist/{whitelist_id}

# ì¡°íšŒ
GET /api/v4/access-logs/whitelist
```

---

### 5. Report C (LH Technical) êµ¬í˜„ (Phase 3)

#### ğŸ“„ New Endpoints
```
GET /api/v4/reports/six-types/lh-technical/html    # HTML ë³´ê³ ì„œ
GET /api/v4/reports/six-types/lh-technical/pdf     # PDF ë‹¤ìš´ë¡œë“œ
```

#### ğŸ” Permissions
- **ì ‘ê·¼**: ADMIN, INTERNAL, LHë§Œ
- **ê³µìœ **: ë¶ˆê°€ (B, D, Fë§Œ ê³µìœ  ê°€ëŠ¥)

#### ğŸ“Š Report Content
- **LH ê¸°ì¤€ ì í•©ì„±**: FAR, BCR, ë†’ì´, ì£¼ì°¨, ì¡°ê²½
- **ê¸°ìˆ ì  íƒ€ë‹¹ì„±**: êµ¬ì¡°, ì ‘ê·¼ì„±, ìœ í‹¸ë¦¬í‹°, í™˜ê²½
- **LH ì ìˆ˜**: ì…ì§€(85), ì ‘ê·¼ì„±(90), ì¸í”„ë¼(88)
- **ê¶Œì¥ ì£¼íƒ ìœ í˜•**: ì²­ë…„í˜•, ì‹ í˜¼ë¶€ë¶€í˜• ë“±

---

### 6. RUN_ID ë°ì´í„° ì—°ë™ (Phase 4)

#### ğŸ—„ï¸ Data Sources
1. **Database**: ContextSnapshot í…Œì´ë¸”
2. **Test Data**: DEV ëª¨ë“œ ìƒ˜í”Œ (5ê°œ)
3. **Future**: Redis ìºì‹œ, ì™¸ë¶€ API

#### ğŸ”Œ API Endpoints
```
GET /api/v4/run-ids/list           # RUN_ID ëª©ë¡ (í˜ì´ì§€ë„¤ì´ì…˜)
GET /api/v4/run-ids/search         # ê²€ìƒ‰ (RUN_ID, ì£¼ì†Œ, PNU)
GET /api/v4/run-ids/statistics     # í†µê³„
GET /api/v4/run-ids/{run_id}       # íŠ¹ì • RUN_ID ì •ë³´
```

#### ğŸ“¦ RunIdInfo Model
```python
{
  "run_id": "TEST_6REPORT",
  "address": "ì„œìš¸ì‹œ ê°•ë‚¨êµ¬ í…Œí—¤ë€ë¡œ 123",
  "pnu": "1168010100",
  "land_area": 500.0,
  "zone": "ì œ2ì¢…ì¼ë°˜ì£¼ê±°ì§€ì—­",
  "created_at": "2026-01-01T12:00:00",
  "status": "ACTIVE",
  "has_data": true
}
```

#### ğŸ§ª Test Data (DEV Mode)
- `TEST_6REPORT`: ì„œìš¸ì‹œ ê°•ë‚¨êµ¬ (500mÂ²)
- `RUN_20260101_SAMPLE_A`: ì„œìš¸ì‹œ ì„œì´ˆêµ¬ (800mÂ²)
- `RUN_20260101_SAMPLE_B`: ê²½ê¸°ë„ ì„±ë‚¨ì‹œ (1200mÂ²)
- `RUN_20260101_SAMPLE_C`: ì¸ì²œì‹œ ì—°ìˆ˜êµ¬ (600mÂ²)
- `RUN_20260101_SAMPLE_D`: ëŒ€ì „ì‹œ ìœ ì„±êµ¬ (450mÂ²)

---

## ğŸ“Š ì™„ì„±ëœ ë³´ê³ ì„œ ì‹œìŠ¤í…œ

### 6ì¢… ë³´ê³ ì„œ ì „ì²´ êµ¬í˜„ ì™„ë£Œ

| ë³´ê³ ì„œ | ì½”ë“œ | ê¶Œí•œ | ìƒíƒœ | ê³µìœ  |
|--------|------|------|------|------|
| ì¢…í•© ìµœì¢…ë³´ê³ ì„œ | A | ADMIN, INTERNAL | âœ… | âŒ |
| í† ì§€ì£¼ ì œì¶œìš© | B | ADMIN, INTERNAL, LANDOWNER | âœ… | âœ… |
| LH ê¸°ìˆ ê²€í†  | C | ADMIN, INTERNAL, LH | âœ… | âŒ |
| ì‚¬ì—…ì„± íˆ¬ìê²€í†  | D | ADMIN, INTERNAL, INVESTOR | âœ… | âœ… |
| ì‚¬ì „ ê²€í†  ë¦¬í¬íŠ¸ | E | ADMIN, LH | âœ… | âŒ |
| ì„¤ëª…ìš© í”„ë ˆì  í…Œì´ì…˜ | F | ALL | âœ… | âœ… |

---

## ğŸ”„ Breaking Changes

**None** - ëª¨ë“  ë³€ê²½ì‚¬í•­ì€ í•˜ìœ„ í˜¸í™˜ì„± ìœ ì§€

---

## ğŸ“ Migration Guide

### From v1.5.1 to v1.6.0

**ìë™ ë§ˆì´ê·¸ë ˆì´ì…˜**: ë³„ë„ ì‘ì—… ë¶ˆí•„ìš”

**ì‹ ê·œ ë””ë ‰í† ë¦¬ ìë™ ìƒì„±**:
```bash
/tmp/zerosite_access_logs/
  â”œâ”€â”€ access_logs.jsonl         # ì ‘ê·¼ ë¡œê·¸
  â”œâ”€â”€ download_limits.json      # ë‹¤ìš´ë¡œë“œ ì œí•œ
  â””â”€â”€ ip_whitelist.json         # IP í™”ì´íŠ¸ë¦¬ìŠ¤íŠ¸
```

**í™˜ê²½ ë³€ìˆ˜** (ì„ íƒì‚¬í•­):
```bash
ZEROSITE_ENV=dev   # DEV ëª¨ë“œ í™œì„±í™”
```

---

## ğŸ§ª Testing

### Test URLs

#### ì ‘ê·¼ ë¡œê·¸ ëŒ€ì‹œë³´ë“œ
```
https://8000-..../access-logs?user=admin@zerosite.com
```

#### RUN_ID ë°ì´í„° ì¡°íšŒ
```
GET /api/v4/run-ids/list
GET /api/v4/run-ids/search?q=ê°•ë‚¨
GET /api/v4/run-ids/statistics
```

#### Report C (LH Technical)
```
GET /api/v4/reports/six-types/lh-technical/html?context_id=TEST_6REPORT
```

---

## ğŸ“ˆ Performance

- **ì ‘ê·¼ ë¡œê·¸**: íŒŒì¼ ê¸°ë°˜ (JSONL), append-only
- **ë‹¤ìš´ë¡œë“œ ì œí•œ**: ì¸ë©”ëª¨ë¦¬ ìºì‹œ + JSON íŒŒì¼
- **RUN_ID ì¡°íšŒ**: ë°ì´í„°ë² ì´ìŠ¤ ì¿¼ë¦¬ + í…ŒìŠ¤íŠ¸ ë°ì´í„°
- **ìë™ ìƒˆë¡œê³ ì¹¨**: 30ì´ˆ (ëŒ€ì‹œë³´ë“œ)

---

## ğŸ› Known Issues

**None** - ëª¨ë“  ê¸°ëŠ¥ ì •ìƒ ì‘ë™

---

## ğŸ”® Future Plans (v1.7.0)

### ê³„íšëœ ê¸°ëŠ¥
- [ ] ê³ ê¸‰ IP í•„í„°ë§ (CIDR ì§€ì›)
- [ ] ë‹¤ìš´ë¡œë“œ ì œí•œ ì»¤ìŠ¤í„°ë§ˆì´ì§• (ë³´ê³ ì„œë³„)
- [ ] ì ‘ê·¼ ë¡œê·¸ ë‚´ë³´ë‚´ê¸° (CSV, Excel)
- [ ] ì‹¤ì‹œê°„ ì•Œë¦¼ (ì´ìƒ ì ‘ê·¼ ê°ì§€)
- [ ] Redis ìºì‹± ê°•í™”
- [ ] ì™¸ë¶€ API ì—°ë™ (RUN_ID ë°ì´í„°)

---

## ğŸ‘¥ Contributors

- ZeroSite Backend Team
- AI Assistant (Claude)

---

## ğŸ“ Support

ë¬¸ì œ ë°œìƒ ì‹œ:
1. ë¸Œë¼ìš°ì € ê°œë°œì ë„êµ¬ (F12) â†’ Console í™•ì¸
2. ë¡œê·¸ íŒŒì¼ í™•ì¸: `/tmp/zerosite_access_logs/`
3. API ë¬¸ì„œ: `/docs`

---

## ğŸ“„ License

Proprietary - ZeroSite Project

---

**Generated**: 2026-01-01  
**Version**: v1.6.0  
**Status**: âœ… Production Ready
